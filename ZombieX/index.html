<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humanoid Paper Doll System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- CẤU HÌNH CHUNG --- */
        :root {
            --skin-color: #e2b98f; /* Màu da */
            --underwear-color: #475569; /* Màu nội y mặc định */
        }

        .game-panel {
            background: #1e293b; /* Slate-800 */
            border: 4px solid #334155; /* Slate-700 */
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.5);
        }

        /* --- PHẦN NHÂN VẬT (QUAN TRỌNG NHẤT) --- */
        .character-viewport {
            width: 240px;
            height: 400px;
            background: #0f172a; /* Slate-900 nền tối để làm nổi bật nhân vật */
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            border: 3px solid #475569;
        }

        /* Tất cả các lớp đều có cùng kích thước và vị trí */
        .layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-position: center bottom;
            background-repeat: no-repeat;
            background-size: 80%; /* Thu nhỏ nhân vật lại một chút để vừa khung */
            transition: all 0.2s ease-in-out;
        }

        /* Z-INDEX: Quyết định cái nào đè lên cái nào */
        .z-base   { z-index: 10; }
        .z-legs   { z-index: 20; }
        .z-torso  { z-index: 30; }
        .z-head   { z-index: 40; }
        .z-weapon { z-index: 50; }

        /* --- VISUAL ASSETS (Giả lập ảnh PNG bằng CSS) --- */

        /* 1. BASE BODY (Cơ thể cơ bản + Nội y) */
        /* Tôi dùng CSS để vẽ một hình người đơn giản. Trong thực tế, đây là file body_base.png */
        .visual-base-human {
            /* Vẽ đầu, thân, chân tay bằng gradients */
            background-image: 
                radial-gradient(circle at 50% 15%, var(--skin-color) 35px, transparent 36px), /* Đầu */
                linear-gradient(to bottom, var(--skin-color) 0%, var(--skin-color) 100%), /* Cổ */
                linear-gradient(to bottom, var(--skin-color) 40%, var(--underwear-color) 40%, var(--underwear-color) 100%), /* Thân + Quần lót */
                linear-gradient(to bottom, var(--skin-color) 100%, var(--skin-color) 100%), /* Tay trái */
                linear-gradient(to bottom, var(--skin-color) 100%, var(--skin-color) 100%), /* Tay phải */
                linear-gradient(to bottom, var(--skin-color) 100%, var(--skin-color) 100%), /* Chân trái */
                linear-gradient(to bottom, var(--skin-color) 100%, var(--skin-color) 100%); /* Chân phải */
            
            /* Định vị và kích thước các bộ phận */
            background-size: 100% 100%, 20px 30px, 70px 140px, 20px 130px, 20px 130px, 25px 150px, 25px 150px;
            background-position: 0 0, 50% 95px, 50% 120px, 35px 120px, 185px 120px, 65px 250px, 150px 250px;
        }

        /* 2. CLOTHING - TORSO (Áo) */
        .visual-shirt-ragged {
            /* Áo vải rách màu nâu */
            background-image: linear-gradient(to bottom, #78350f 0%, #92400e 80%, transparent 100%);
            background-size: 80px 110px;
            background-position: 50% 120px; /* Khớp vị trí với phần thân của Base Body */
            filter: drop-shadow(0 4px 2px rgba(0,0,0,0.3));
        }
        .visual-armor-steel {
            /* Giáp sắt màu xám xanh */
            background-image: linear-gradient(135deg, #334155 0%, #475569 50%, #64748b 100%);
            background-size: 90px 120px; /* Giáp to hơn người một chút */
            background-position: 50% 115px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));
            border-radius: 10px; /* Bo tròn nhẹ tạo khối */
        }

        /* 3. CLOTHING - HEAD (Mũ) */
        .visual-hat-cowboy {
            background-image: radial-gradient(ellipse at center, #451a03 40%, #78350f 100%);
            background-size: 100px 40px;
            background-position: 50% 25px; /* Đặt lên trên đầu */
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.4));
        }
        .visual-helmet-scifi {
             background-image: conic-gradient(from 180deg at 50% 50%, #1e293b 0deg, #3b82f6 180deg, #1e293b 360deg);
            background-size: 80px 80px;
            background-position: 50% 10px;
            border-radius: 50%;
            box-shadow: 0 0 15px #3b82f6; /* Hiệu ứng phát sáng */
        }

        /* 4. WEAPON (Vũ khí - Cầm ở tay phải) */
        .visual-weapon-sword {
            /* Kiếm phát sáng */
            background-image: linear-gradient(to top, #94a3b8 70%, #22d3ee 100%);
            width: 20px !important; height: 140px !important; /* Ghi đè kích thước chuẩn */
            top: 130px; left: 190px; /* Vị trí tay phải */
            transform: rotate(15deg);
            box-shadow: 0 0 10px #22d3ee;
            border-radius: 4px;
        }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 min-h-screen flex items-center justify-center p-4 font-mono">

    <div class="game-panel p-8 rounded-3xl flex flex-col md:flex-row gap-10 items-center">
        
        <div class="flex flex-col items-center gap-4">
            <h2 class="text-xl font-bold text-blue-400 uppercase tracking-widest">Preview</h2>
            <div class="character-viewport shadow-[inset_0_0_20px_rgba(0,0,0,0.8)]">
                <div class="layer z-base visual-base-human"></div>
                
                <div id="layer-legs" class="layer z-legs"></div>
                <div id="layer-torso" class="layer z-torso"></div>
                <div id="layer-head" class="layer z-head"></div>
                <div id="layer-weapon" class="layer z-weapon"></div>
            </div>
            <p class="text-xs text-slate-500">Humanoid Model v1.2</p>
        </div>

        <div class="flex flex-col gap-6 w-72">
             <h2 class="text-xl font-bold text-green-400 uppercase tracking-widest mb-2">Equipment</h2>

             <div class="bg-slate-800 p-3 rounded-xl border border-slate-700">
                <label class="text-xs font-bold text-blue-300 block mb-2">HEAD SLOT</label>
                <div class="flex gap-2">
                    <button onclick="equipItem('head', 'hat_cowboy')" class="flex-1 bg-amber-900/50 hover:bg-amber-800 p-2 rounded-lg text-xs border border-amber-700 transition">Mũ Cao Bồi</button>
                    <button onclick="equipItem('head', 'helmet_scifi')" class="flex-1 bg-blue-900/50 hover:bg-blue-800 p-2 rounded-lg text-xs border border-blue-700 transition">Mũ Sci-Fi</button>
                </div>
                <button onclick="unequipItem('head')" class="w-full mt-2 bg-slate-700 hover:bg-slate-600 text-[10px] py-1 rounded">Gỡ bỏ</button>
            </div>

            <div class="bg-slate-800 p-3 rounded-xl border border-slate-700">
                <label class="text-xs font-bold text-green-300 block mb-2">TORSO SLOT</label>
                <div class="flex gap-2">
                    <button onclick="equipItem('torso', 'shirt_ragged')" class="flex-1 bg-orange-900/50 hover:bg-orange-800 p-2 rounded-lg text-xs border border-orange-700 transition">Áo Rách</button>
                    <button onclick="equipItem('torso', 'armor_steel')" class="flex-1 bg-slate-600/50 hover:bg-slate-500 p-2 rounded-lg text-xs border border-slate-500 transition">Giáp Thép</button>
                </div>
                <button onclick="unequipItem('torso')" class="w-full mt-2 bg-slate-700 hover:bg-slate-600 text-[10px] py-1 rounded">Gỡ bỏ</button>
            </div>

            <div class="bg-slate-800 p-3 rounded-xl border border-slate-700">
                <label class="text-xs font-bold text-red-300 block mb-2">WEAPON SLOT</label>
                 <button onclick="equipItem('weapon', 'weapon_sword')" class="w-full bg-red-900/50 hover:bg-red-800 p-2 rounded-lg text-xs border border-red-700 transition mb-2">Kiếm Năng Lượng</button>
                 <button onclick="unequipItem('weapon')" class="w-full bg-slate-700 hover:bg-slate-600 text-[10px] py-1 rounded">Cất vũ khí</button>
            </div>

        </div>
    </div>

    <script>
        /**
         * MASTER DATABASE (Rút gọn cho Visual)
         * Ánh xạ từ ID vật phẩm sang tên class CSS tương ứng.
         */
        const VISUAL_DB = {
            head: {
                "hat_cowboy": "visual-hat-cowboy",
                "helmet_scifi": "visual-helmet-scifi"
            },
            torso: {
                "shirt_ragged": "visual-shirt-ragged",
                "armor_steel": "visual-armor-steel"
            },
            weapon: {
                "weapon_sword": "visual-weapon-sword"
            }
            // Legs...
        };

        // Trạng thái hiện tại của nhân vật
        let currentLoadout = {
            head: null,
            torso: null,
            legs: null,
            weapon: null
        };

        /**
         * Hàm mặc đồ: Tìm class CSS tương ứng và gán vào layer
         */
        function equipItem(slot, itemId) {
            const layerEl = document.getElementById(`layer-${slot}`);
            const visualClass = VISUAL_DB[slot][itemId];

            // 1. Xóa các class visual cũ (giữ lại class gốc 'layer' và 'z-index')
            layerEl.className = layerEl.className.split(' ').filter(c => !c.startsWith('visual-')).join(' ');
            
            // 2. Thêm class visual mới
            if (visualClass) {
                layerEl.classList.add(visualClass);
                currentLoadout[slot] = itemId; // Cập nhật state
                console.log(`[EQUIP] Đã mặc ${itemId} vào slot ${slot}`);
            }
        }

        /**
         * Hàm gỡ đồ: Chỉ cần xóa class visual đi là xong
         */
        function unequipItem(slot) {
            const layerEl = document.getElementById(`layer-${slot}`);
            // Lọc bỏ các class bắt đầu bằng 'visual-'
            layerEl.className = layerEl.className.split(' ').filter(c => !c.startsWith('visual-')).join(' ');
            currentLoadout[slot] = null;
            console.log(`[UNEQUIP] Đã gỡ đồ khỏi slot ${slot}`);
        }

    </script>
</body>
</html>