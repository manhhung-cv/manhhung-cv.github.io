<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" href="/Asset/logo/iconApps.png" />
    <link rel="apple-touch-icon" href="/Asset/logo/iconApps.png" sizes="150x150" />

    <meta property="og:image" content="/Asset/img/Banner.png" />
    <meta property="og:title" content="HunqPOS" />
    <meta property="og:description" content="Thi·∫øt k·∫ø v√† l·∫≠p tr√¨nh ƒêinh M·∫°nh H√πng" />

    <title>HunqPOS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


    <!-- Driver.js -->
    <script src="https://cdn.jsdelivr.net/npm/driver.js@latest/dist/driver.js.iife.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@latest/dist/driver.css" />


    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        primary: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8' },
                        slate: { 850: '#172033' }
                    },
                    boxShadow: {
                        'glow': '0 0 20px rgba(59, 130, 246, 0.5)',
                        'card': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        'float': '0 10px 30px -5px rgba(0, 0, 0, 0.1)'
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        ::-webkit-scrollbar {
            width: 5px;
            height: 5px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }

        .glass-dark {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }

        .card-icon-bg {
            position: absolute;
            right: -10px;
            bottom: -10px;
            font-size: 5rem;
            opacity: 0.08;
            transform: rotate(-15deg);
            transition: all 0.3s;
        }

        .product-card:hover .card-icon-bg {
            transform: rotate(0deg) scale(1.1);
            opacity: 0.12;
        }

        #resize-handle {
            transition: background-color 0.2s;
        }

        #resize-handle:hover,
        #resize-handle.resizing {
            background-color: #3b82f6;
            cursor: col-resize;
        }
    </style>
</head>

<body class="bg-[#f3f4f6] text-slate-800 h-screen overflow-hidden flex flex-col">

    <div class="fixed bottom-24 md:bottom-6 left-4 z-40 group">

        <div
            class="hidden group-hover:block absolute left-12 top-1/2 -translate-y-1/2 bg-slate-800 text-white text-[10px] font-bold px-2 py-1 rounded-md whitespace-nowrap shadow-sm ml-2">
            H∆∞·ªõng d·∫´n
            <div class="absolute top-1/2 -translate-y-1/2 -left-1 border-4 border-transparent border-r-slate-800"></div>
        </div>

        <button onclick="startSmartTour()"
            class="flex items-center justify-center w-10 h-10 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg">
            <i class="fa-solid fa-question text-sm"></i>
        </button>
    </div>
    <!-- HEADER (z-40) -->
    <header style="background-color: #121925;"
        class="glass-dark text-slate-300 h-16 flex items-center justify-between px-6 shadow-lg z-40 shrink-0 border-b border-slate-700/50">
        <div class="flex items-center gap-3 mr-8 shrink-0">


            <div class="text-white w-9 h-9 rounded-full flex items-center justify-center shadow-glow"
                style="background: linear-gradient(to bottom right, #d7c08e, #bfa877); box-shadow: 0 0 10px rgb(215 192 142);;">
                <img src="/Asset/logo/logo.png" alt="Logo" srcset="/Asset/logo/logo.png">
            </div>

            <span class="font-bold text-lg text-white tracking-tight">Hunq<span class="font-light"
                    style="color: #d7c08e;">POS</span></span>
        </div>



        <nav class="hidden md:flex flex-1 items-center gap-2 overflow-x-auto no-scrollbar h-full px-2">
            <a href="#" onclick="switchView('pos')" id="menu-pos"
                class="nav-item active px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 hover:bg-white/10 flex items-center gap-2 whitespace-nowrap">
                <i class="fa-solid fa-cash-register"></i> <span class="hidden md:inline">B√°n h√†ng</span>
            </a>
            <a href="#" onclick="switchView('history')" id="menu-history"
                class="nav-item px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 hover:bg-white/10 flex items-center gap-2 whitespace-nowrap">
                <i class="fa-solid fa-clock-rotate-left"></i> <span class="hidden md:inline">L·ªãch s·ª≠</span>
            </a>
            <a href="#" onclick="switchView('inventory')" id="menu-inventory"
                class="nav-item px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 hover:bg-white/10 flex items-center gap-2 whitespace-nowrap">
                <i class="fa-solid fa-boxes-stacked"></i> <span class="hidden md:inline">Kho h√†ng</span>
            </a>
            <a href="#" onclick="switchView('customers')" id="menu-customers"
                class="nav-item px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 hover:bg-white/10 flex items-center gap-2 whitespace-nowrap">
                <i class="fa-solid fa-users"></i> <span class="hidden md:inline">Kh√°ch h√†ng</span>
            </a>
            <a href="#" onclick="switchView('reports')" id="menu-reports"
                class="nav-item px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 hover:bg-white/10 flex items-center gap-2 whitespace-nowrap">
                <i class="fa-solid fa-chart-pie"></i> <span class="hidden md:inline">Th·ªëng k√™</span>
            </a>
            <a href="#" onclick="switchView('promos')" id="menu-promos"
                class="nav-item px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 hover:bg-white/10 flex items-center gap-2 whitespace-nowrap">
                <i class="fa-solid fa-ticket"></i> <span class="hidden md:inline">∆Øu ƒë√£i</span>
            </a>
            <a href="#" onclick="switchView('print-settings')" id="menu-print-settings"
                class="nav-item px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 hover:bg-white/10 flex items-center gap-2 whitespace-nowrap hidden">
                <i class="fa-solid fa-print"></i> <span class="hidden md:inline">C·∫•u h√¨nh in</span>
            </a>

        </nav>

        <div
            class="ml-2 md:ml-6 flex items-center gap-1 bg-slate-800/50 md:bg-slate-700/50 rounded-lg p-1 border border-slate-700 md:border-slate-600 backdrop-blur-sm">

            <div class="relative group">
                <select id="global-branch-select" onchange="switchBranch(this.value)"
                    class="appearance-none bg-transparent text-white text-xs md:text-sm font-semibold outline-none cursor-pointer w-full md:w-auto md:min-w-[160px] pl-2 pr-6 py-1 truncate transition-all hover:text-blue-300">
                    <option value="">ƒêang t·∫£i...</option>
                </select>

                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-1 text-slate-400">
                    <i class="fa-solid fa-chevron-down text-[10px]"></i>
                </div>
            </div>

            <button id="btn-manage-branches" onclick="toggleBranchModal()"
                class="hidden w-7 h-7 rounded-md bg-slate-600 hover:bg-blue-600 text-white flex items-center justify-center transition shadow-sm border border-slate-500 "
                title="Qu·∫£n l√Ω chi nh√°nh">
                <i class="fa-solid fa-gear text-xs animate-spin-slow hover:animate-spin"></i>
            </button>
        </div>



        <div class="flex items-center gap-4 ml-4 shrink-0 hidden md:inline">
            <button onclick="handleLogout()"
                class="flex md:flex ml-3 items-center gap-2 text-xs font-bold text-slate-400 hover:text-red-500 bg-slate-800 hover:bg-slate-700 px-3 py-1.5 rounded-full border border-slate-700 transition">
                <i class="fa-solid fa-power-off"></i>
                <span id="user-role-display" class="hidden md:inline">
                    Logout
                </span>
            </button>
        </div>
    </header>
    <style>
        .nav-item.active {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);
        }
    </style>

    <!-- MAIN CONTENT -->
    <div class="flex-1 flex overflow-hidden relative">

        <!-- 1. VIEW: POS -->
        <main id="view-pos" class="flex-1 flex flex-col h-full bg-[#f8fafc] relative z-0 min-w-0">
            <div
                class="px-6 py-4 flex items-center justify-between shrink-0 sticky top-0 z-20 bg-white/80 backdrop-blur-md border-b border-slate-200/60">
                <div class="flex items-center gap-4 flex-1">
                    <div class="relative w-full max-w-md group">
                        <i
                            class="fa-solid fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-blue-500 transition"></i>
                        <input type="text" id="pos-search-input" placeholder="T√¨m ki·∫øm d·ªãch v·ª•..."
                            class="w-full pl-11 pr-4 py-3 bg-white border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none shadow-sm transition-all">
                    </div>
                </div>
                <button onclick="toggleAddProductModal()"
                    class="ml-4 bg-white hover:bg-blue-50 text-blue-600 border border-blue-100 hover:border-blue-200 px-4 py-2.5 rounded-xl text-sm font-bold shadow-sm transition flex items-center gap-2">
                    <i class="fa-solid fa-plus-circle text-lg"></i> <span class="hidden sm:inline">Th√™m m·ªõi</span>
                </button>
            </div>
            <div class="px-6 pt-2 pb-2 shrink-0 bg-[#f8fafc]">
                <div id="pos-categories" class="flex gap-3 overflow-x-auto no-scrollbar py-2"></div>
            </div>
            <style>
                .cat-btn.active {
                    background: #1e293b;
                    color: white;
                    box-shadow: 0 4px 12px rgba(30, 41, 59, 0.3);
                    transform: translateY(-1px);
                }
            </style>
            <div id="products-grid"
                class="flex-1 p-6 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 overflow-y-auto content-start pb-24">
            </div>
        </main>

        <!-- 2. VIEW: INVENTORY -->
        <main id="view-inventory"
            class="hidden flex-1 flex flex-col h-full bg-[#f8fafc] p-4 md:p-6 overflow-hidden pb-24 md:pb-6">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-3 shrink-0">
                <div>
                    <h2 class="text-2xl font-black text-slate-800">Kho h√†ng</h2>
                    <p class="text-sm text-slate-500">Qu·∫£n l√Ω s·∫£n ph·∫©m & ƒë·ªãnh m·ª©c</p>
                </div>

                <div class="flex flex-wrap gap-2 w-full md:w-auto">
                    <button onclick="openCategoryModal()"
                        class="flex-1 md:flex-none px-4 py-2 bg-white border border-slate-200 rounded-xl font-bold text-slate-700 shadow-sm text-xs flex items-center justify-center gap-2">
                        <i class="fa-solid fa-layer-group text-blue-500"></i> <span class="hidden sm:inline">Danh
                            m·ª•c</span>
                    </button>

                    <div class="flex gap-2">
                        <button onclick="exportProductsToCSV()"
                            class="w-9 h-9 bg-green-50 text-green-600 rounded-xl flex items-center justify-center border border-green-100"
                            title="Xu·∫•t CSV"><i class="fa-solid fa-file-csv"></i></button>
                        <button onclick="document.getElementById('csv-input').click()"
                            class="w-9 h-9 bg-orange-50 text-orange-600 rounded-xl flex items-center justify-center border border-orange-100"
                            title="Nh·∫≠p CSV"><i class="fa-solid fa-file-import"></i></button>
                        <button onclick="deleteAllInventory()"
                            class="w-9 h-9 bg-red-50 text-red-600 rounded-xl flex items-center justify-center border border-red-100"
                            title="X√≥a to√†n b·ªô"><i class="fa-solid fa-fire"></i></button>
                        <input type="file" id="csv-input" accept=".csv" onchange="importProductsFromCSV(event)"
                            class="hidden">
                    </div>

                    <button onclick="openProductModal()"
                        class="flex-1 md:flex-none px-4 py-2 bg-blue-600 text-white rounded-xl font-bold shadow-lg shadow-blue-200 text-xs flex items-center justify-center gap-2">
                        <i class="fa-solid fa-plus"></i> Th√™m d·ªãch v·ª•
                    </button>
                </div>
            </div>

            <div class="bg-white p-3 rounded-xl shadow-sm border border-slate-200 mb-4 shrink-0">
                <div class="relative">
                    <i class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                    <input type="text" id="inv-search" oninput="renderInventoryTable()"
                        placeholder="T√¨m t√™n s·∫£n ph·∫©m, gi√°..."
                        class="w-full pl-9 pr-3 py-2.5 bg-slate-50 border border-slate-200 rounded-lg text-sm outline-none focus:border-blue-500 transition">
                </div>
            </div>

            <div
                class="flex-1 overflow-hidden relative bg-slate-50 md:bg-white md:border md:border-slate-200 md:rounded-2xl">

                <div class="hidden md:block h-full overflow-y-auto custom-scrollbar">
                    <table class="w-full text-left border-collapse">
                        <thead class="bg-slate-50 sticky top-0 z-10 shadow-sm">
                            <tr>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">T√™n s·∫£n ph·∫©m</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">Danh m·ª•c</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">Gi√° b√°n</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">T·ªìn kho</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase text-right">S·ª≠a</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-list-pc" class="divide-y divide-slate-100"></tbody>
                    </table>
                </div>

                <div id="inventory-list-mobile" class="md:hidden h-full overflow-y-auto space-y-3 p-1 pb-20">
                </div>

            </div>
        </main>


        <!-- 3. VIEW: HISTORY -->
        <main id="view-history"
            class="hidden flex-1 flex flex-col h-full bg-[#f8fafc] p-4 md:p-6 overflow-hidden pb-24 md:pb-6">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-3 shrink-0">
                <div>
                    <h2 class="text-2xl font-black text-slate-800">L·ªãch s·ª≠ giao d·ªãch</h2>
                    <p class="text-sm text-slate-500">Qu·∫£n l√Ω h√≥a ƒë∆°n & tra so√°t</p>
                </div>
                <div class="flex gap-2 w-full md:w-auto">
                    <button id="btn-reset-counter" onclick="resetOrderCounter()"
                        class="hidden flex-1 md:flex-none bg-purple-100 hover:bg-purple-200 text-purple-600 border border-purple-200 px-3 py-2 rounded-xl font-bold text-xs shadow-sm items-center justify-center gap-2 transition">
                        <i class="fa-solid fa-rotate-right"></i> <span class="hidden md:inline">Reset</span>
                    </button>
                    <button id="btn-delete-all-history" onclick="deleteAllHistory()"
                        class="hidden flex-1 md:flex-none bg-red-100 hover:bg-red-200 text-red-600 border border-red-200 px-3 py-2 rounded-xl font-bold text-xs shadow-sm items-center justify-center gap-2 transition">
                        <i class="fa-solid fa-trash-can"></i> <span class="hidden md:inline">X√≥a h·∫øt</span>
                    </button>
                    <button onclick="exportHistoryToExcel()"
                        class="flex-1 md:flex-none bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-xl font-bold text-xs shadow-lg flex items-center justify-center gap-2 transition">
                        <i class="fa-solid fa-file-excel"></i> Xu·∫•t Excel
                    </button>
                </div>
            </div>

            <div class="bg-white p-3 rounded-xl shadow-sm border border-slate-200 mb-4 shrink-0">
                <div class="flex flex-col md:flex-row gap-3 mb-3 md:mb-0">
                    <div class="flex-1 relative">
                        <i class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                        <input type="text" id="history-search" oninput="renderHistoryTable()"
                            placeholder="T√¨m m√£ ƒë∆°n, t√™n kh√°ch..."
                            class="w-full pl-9 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm outline-none focus:border-blue-500">
                    </div>
                    <div class="flex gap-2">
                        <input type="date" id="filter-date-start" onchange="renderHistoryTable()"
                            class="flex-1 bg-slate-50 border border-slate-200 rounded-lg px-2 py-2 text-xs outline-none font-medium">
                        <input type="date" id="filter-date-end" onchange="renderHistoryTable()"
                            class="flex-1 bg-slate-50 border border-slate-200 rounded-lg px-2 py-2 text-xs outline-none font-medium">
                    </div>
                </div>

                <div class="grid grid-cols-3 md:flex md:gap-3 gap-2 mt-2 md:mt-3">
                    <select id="filter-branch-history" onchange="renderHistoryTable()"
                        class="bg-slate-50 border border-slate-200 rounded-lg px-2 py-1.5 text-xs outline-none font-bold text-slate-600">
                        <option value="all">T·∫•t c·∫£ CN</option>
                    </select>
                    <select id="filter-cashier" onchange="renderHistoryTable()"
                        class="bg-slate-50 border border-slate-200 rounded-lg px-2 py-1.5 text-xs outline-none font-bold text-slate-600">
                        <option value="all">Thu ng√¢n</option>
                    </select>
                    <select id="filter-status" onchange="renderHistoryTable()"
                        class="bg-slate-50 border border-slate-200 rounded-lg px-2 py-1.5 text-xs outline-none font-bold text-slate-600">
                        <option value="active">Hi·ªáu l·ª±c</option>
                        <option value="deleted">ƒê√£ x√≥a</option>
                    </select>
                </div>
            </div>

            <div
                class="flex-1 overflow-hidden relative bg-slate-50 md:bg-white md:border md:border-slate-200 md:rounded-2xl">

                <div class="hidden md:block h-full overflow-y-auto">
                    <table class="w-full text-left border-collapse">
                        <thead class="bg-slate-50 sticky top-0 z-10 shadow-sm">
                            <tr>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">M√£ ƒë∆°n</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">Th·ªùi gian</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">Kh√°ch h√†ng</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">Chi nh√°nh</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">Thu ng√¢n</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">T·ªïng ti·ªÅn</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase text-right">H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody id="history-list-pc" class="divide-y divide-slate-100"></tbody>
                    </table>
                </div>

                <div id="history-list-mobile" class="md:hidden h-full overflow-y-auto space-y-3 p-1 pb-20">
                </div>

            </div>
        </main>

        <!-- 4. VIEW: CUSTOMERS -->
        <main id="view-customers" class="hidden flex-1 flex flex-col h-full bg-[#f8fafc] p-6 overflow-auto">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-black text-slate-800">Kh√°ch h√†ng th√¢n thi·∫øt</h2>
                    <p class="text-sm text-slate-500">Qu·∫£n l√Ω th√¥ng tin v√† ƒëi·ªÉm t√≠ch l≈©y</p>
                </div>
                <button onclick="toggleCustomerModal()"
                    class="px-5 py-2.5 bg-blue-600 text-white rounded-xl font-bold shadow-lg hover:bg-blue-700 flex items-center gap-2"><i
                        class="fa-solid fa-user-plus"></i> Th√™m kh√°ch</button>
            </div>
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 flex-1 overflow-hidden flex flex-col">
                <div class="overflow-y-auto flex-1">
                    <table class="w-full text-left border-collapse">
                        <thead class="bg-slate-50 sticky top-0 z-10 shadow-sm">
                            <thead class="bg-slate-50 sticky top-0 z-10 shadow-sm">
                                <tr>
                                    <th class="p-4 text-xs font-bold text-slate-500 uppercase">Kh√°ch h√†ng</th>
                                    <th class="p-4 text-xs font-bold text-slate-500 uppercase">Li√™n h·ªá</th>
                                    <th class="p-4 text-xs font-bold text-slate-500 uppercase">H·∫°ng & ƒêi·ªÉm</th>
                                    <th class="p-4 text-xs font-bold text-slate-500 uppercase">T·ªïng chi</th>
                                    <th class="p-4 text-xs font-bold text-slate-500 uppercase">Th·ªùi gian</th>
                                    <th class="p-4 text-xs font-bold text-slate-500 uppercase w-48">Ghi ch√∫</th>
                                    <th class="p-4 text-xs font-bold text-slate-500 uppercase text-right">H√†nh ƒë·ªông</th>
                                </tr>
                            </thead>
                        </thead>
                        <tbody id="customer-list" class="divide-y divide-slate-100"></tbody>
                    </table>
                </div>
            </div>
        </main>

        <!-- 5. VIEW: REPORTS -->
        <main id="view-reports" class="hidden flex-1 flex-col h-full bg-[#f8fafc] p-6 overflow-y-auto">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                <div>
                    <h2 class="text-2xl font-black text-slate-800">B√°o c√°o doanh thu</h2>
                    <p class="text-sm text-slate-500">T·ªïng quan t√¨nh h√¨nh kinh doanh</p>
                </div>

                <div
                    class="bg-white p-2 rounded-xl shadow-sm border border-slate-200 flex flex-wrap items-center gap-2">
                    <div class="flex bg-slate-100 p-1 rounded-lg">
                        <button onclick="setReportDate('today')"
                            class="report-filter-btn active px-3 py-1.5 text-xs font-bold rounded-md transition text-slate-600 hover:bg-white hover:shadow-sm">H√¥m
                            nay</button>
                        <button onclick="setReportDate('yesterday')"
                            class="report-filter-btn px-3 py-1.5 text-xs font-bold rounded-md transition text-slate-600 hover:bg-white hover:shadow-sm">H√¥m
                            qua</button>
                        <button onclick="setReportDate('this_month')"
                            class="report-filter-btn px-3 py-1.5 text-xs font-bold rounded-md transition text-slate-600 hover:bg-white hover:shadow-sm">Th√°ng
                            n√†y</button>
                    </div>

                    <div class="h-6 w-px bg-slate-200 mx-1"></div>

                    <div class="flex items-center gap-2">
                        <input type="date" id="report-date-start"
                            class="bg-slate-50 border border-slate-200 text-xs rounded-lg px-2 py-1.5 outline-none font-medium">
                        <span class="text-slate-400 text-xs">-</span>
                        <input type="date" id="report-date-end"
                            class="bg-slate-50 border border-slate-200 text-xs rounded-lg px-2 py-1.5 outline-none font-medium">
                    </div>
                    <div class="flex items-center gap-2">
                        <label class="text-slate-500 text-xs font-bold">CN:</label>
                        <select id="report-branch-select"
                            class="bg-slate-50 border border-slate-200 text-xs rounded-lg px-2 py-1.5 outline-none font-medium min-w-[100px]"
                            onchange="renderStats()">
                            <option value="all">T·∫•t c·∫£</option>
                        </select>
                    </div>

                    <button onclick="renderStats()"
                        class="bg-blue-600 hover:bg-blue-700 text-white w-8 h-8 rounded-lg flex items-center justify-center transition shadow-sm"
                        title="√Åp d·ª•ng l·ªçc">
                        <i class="fa-solid fa-filter text-xs"></i>
                    </button>
                </div>
            </div>

            <style>
                .report-filter-btn.active {
                    background: white;
                    color: #2563eb;
                    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
                }
            </style>

            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 relative overflow-hidden group">
                    <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition duration-500">
                        <i class="fa-solid fa-sack-dollar text-6xl text-blue-500"></i>
                    </div>
                    <div class="text-slate-500 text-xs font-bold uppercase mb-1">Doanh thu thu·∫ßn</div>
                    <div class="text-3xl font-black text-slate-800 tracking-tight" id="kpi-revenue">0 ‚Ç´</div>
                    <div class="text-xs text-emerald-500 font-bold mt-1 flex items-center gap-1">
                        <i class="fa-solid fa-circle-check"></i> ƒê√£ tr·ª´ c√°c ƒë∆°n h·ªßy
                    </div>
                </div>

                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 relative overflow-hidden group">
                    <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition duration-500">
                        <i class="fa-solid fa-receipt text-6xl text-purple-500"></i>
                    </div>
                    <div class="text-slate-500 text-xs font-bold uppercase mb-1">T·ªïng ƒë∆°n h√†ng</div>
                    <div class="text-3xl font-black text-slate-800 tracking-tight" id="kpi-orders">0</div>
                    <div class="text-xs text-slate-400 font-bold mt-1">ƒê∆°n th√†nh c√¥ng</div>
                </div>

                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 relative overflow-hidden group">
                    <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition duration-500">
                        <i class="fa-solid fa-chart-line text-6xl text-orange-500"></i>
                    </div>
                    <div class="text-slate-500 text-xs font-bold uppercase mb-1">Gi√° tr·ªã TB / ƒê∆°n</div>
                    <div class="text-3xl font-black text-slate-800 tracking-tight" id="kpi-aov">0 ‚Ç´</div>
                    <div class="text-xs text-orange-500 font-bold mt-1">AOV Metric</div>
                </div>

                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 relative overflow-hidden group">
                    <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition duration-500">
                        <i class="fa-solid fa-ban text-6xl text-red-500"></i>
                    </div>
                    <div class="text-slate-500 text-xs font-bold uppercase mb-1">ƒê∆°n ƒë√£ h·ªßy</div>
                    <div class="text-3xl font-black text-slate-800 tracking-tight" id="kpi-canceled">0</div>
                    <div class="text-xs text-red-500 font-bold mt-1" id="kpi-cancel-rate">0% t·ªïng ƒë∆°n</div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-chart-column text-blue-500"></i> Bi·ªÉu ƒë·ªì doanh thu
                    </h3>
                    <div class="h-[300px] w-full">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col">
                    <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-wallet text-orange-500"></i> K√™nh thanh to√°n
                    </h3>
                    <div class="h-[200px] w-full flex items-center justify-center relative">
                        <canvas id="paymentChart"></canvas>
                    </div>
                    <div id="payment-legend" class="mt-4 space-y-2 flex-1 overflow-y-auto custom-scrollbar">
                    </div>
                </div>
            </div>

            <div
                class="bg-white rounded-2xl shadow-sm border border-slate-100 flex-1 overflow-hidden flex flex-col min-h-[300px]">
                <div class="p-5 border-b border-slate-100 flex justify-between items-center">
                    <h3 class="font-bold text-slate-700 flex items-center gap-2">
                        <i class="fa-solid fa-ranking-star text-yellow-500"></i> Top s·∫£n ph·∫©m b√°n ch·∫°y
                    </h3>
                </div>
                <div class="overflow-y-auto flex-1 p-0">
                    <table class="w-full text-left">
                        <thead class="bg-slate-50 sticky top-0 z-10">
                            <tr>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase w-16">Top</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">T√™n s·∫£n ph·∫©m</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase text-right">S·ªë l∆∞·ª£ng</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase text-right">Doanh thu</th>
                            </tr>
                        </thead>
                        <tbody id="top-products-list" class="divide-y divide-slate-50"></tbody>
                    </table>
                </div>
            </div>
        </main>

        <!-- 6. VIEW: PROMOS -->
        <main id="view-promos" class="hidden flex-1 flex flex-col h-full bg-[#f8fafc] p-6 overflow-hidden">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-black text-slate-800">∆Øu ƒë√£i & Th·∫ª qu√† t·∫∑ng</h2>
                    <p class="text-sm text-slate-500">Qu·∫£n l√Ω m√£ gi·∫£m gi√° v√† th·∫ª tr·∫£ tr∆∞·ªõc</p>
                </div>
                <button onclick="togglePromoModal()"
                    class="px-5 py-2.5 bg-orange-500 text-white rounded-xl font-bold shadow-lg hover:bg-orange-600 flex items-center gap-2"><i
                        class="fa-solid fa-plus"></i> T·∫°o th·∫ª m·ªõi</button>
            </div>
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 flex-1 overflow-hidden flex flex-col">
                <div class="overflow-y-auto flex-1">
                    <table class="w-full text-left border-collapse">
                        <thead class="bg-slate-50 sticky top-0 z-10 shadow-sm">
                            <tr>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">M√£ th·∫ª</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">Lo·∫°i & Gi√° tr·ªã</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">Tr·∫°ng th√°i</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase">L·ªãch s·ª≠ s·ª≠ d·ª•ng</th>
                                <th class="p-4 text-xs font-bold text-slate-500 uppercase text-right">H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody id="promo-list" class="divide-y divide-slate-100"></tbody>
                    </table>
                </div>
            </div>
        </main>

        <!-- 7.VIEW: PRINT -->
        <main id="view-print-settings" class="hidden flex-1 flex-col h-full bg-[#f8fafc] p-6 overflow-y-auto">
            <div class="flex justify-between items-center mb-6 shrink-0">
                <div>
                    <h2 class="text-2xl font-black text-slate-800">C·∫•u h√¨nh m·∫´u in</h2>
                    <p class="text-sm text-slate-500">T√πy ch·ªânh h√≥a ƒë∆°n & xem tr∆∞·ªõc tr·ª±c ti·∫øp theo chi nh√°nh</p>
                </div>
                <button onclick="savePrintSettings()"
                    class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-xl font-bold shadow-lg transition flex items-center gap-2">
                    <i class="fa-solid fa-floppy-disk"></i> L∆∞u c·∫•u h√¨nh
                </button>
            </div>

            <div
                class="bg-yellow-50 border border-yellow-200 p-4 rounded-xl mb-4 flex justify-between items-center shrink-0">
                <div id="print-server-setup" class="block">
                    <div class="flex gap-2 items-center">
                        <span class="font-bold text-yellow-800"><i class="fa-solid fa-print"></i> Ch·∫ø ƒë·ªô M√°y ch·ªß in
                            (PC)</span>
                        <input type="text" id="server-name-input" class="p-1 border border-slate-200 rounded-lg text-sm"
                            placeholder="T√™n m√°y in...">
                        <button onclick="registerPrintServer()"
                            class="bg-slate-800 hover:bg-black text-white px-3 py-1 rounded-lg text-xs font-bold transition whitespace-nowrap">
                            <i class="fa-solid fa-power-off mr-1"></i> B·∫≠t
                        </button>
                    </div>
                </div>

                <div id="print-server-active"
                    class="hidden bg-green-50 border border-green-200 rounded-xl p-4 flex flex-col gap-3">
                    <div class="flex justify-between items-center">
                        <div>
                            <div class="flex items-center gap-2">
                                <span class="relative flex h-3 w-3">
                                    <span
                                        class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                                    <span class="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span>
                                </span>
                                <span class="font-bold text-green-700 text-sm" id="server-name-display">ƒêang ho·∫°t
                                    ƒë·ªông</span>
                            </div>
                            <div class="text-[10px] text-green-600 mt-1">ID: <span id="server-id-display"
                                    class="font-mono font-bold select-all">...</span></div>
                        </div>
                        <button onclick="stopPrintServer()"
                            class="bg-white border border-green-200 text-red-500 hover:bg-red-50 px-3 py-1.5 rounded-lg text-xs font-bold transition">
                            <i class="fa-solid fa-power-off mr-1"></i> T·∫Øt
                        </button>
                    </div>

                    <div class="border-t border-green-200 pt-2 mt-1">
                        <h6 class="text-[10px] font-bold text-green-800 uppercase mb-2">üì° Thi·∫øt b·ªã ƒë√£ k·∫øt n·ªëi</h6>
                        <ul id="connected-devices-list"
                            class="space-y-2 max-h-[200px] overflow-y-auto pr-1 custom-scrollbar">
                        </ul>
                    </div>
                </div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 h-full min-h-0">

                <div class="flex flex-col gap-4 h-full overflow-y-auto pr-2 custom-scrollbar">

                    <div class="bg-white p-4 rounded-2xl shadow-sm border border-slate-200 shrink-0 mt-4">
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-3">C√†i ƒë·∫∑t h√†nh vi in</label>

                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div
                                    class="w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center">
                                    <i class="fa-solid fa-window-restore"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-bold text-slate-700">M·ªü c·ª≠a s·ªï ri√™ng (Popup Mode)</div>
                                    <div class="text-[10px] text-slate-500">B·∫≠t tab m·ªõi khi in thay v√¨ in ƒë√® l√™n trang
                                        hi·ªán t·∫°i</div>
                                </div>
                            </div>

                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="cfg-auto-print-popup"
                                    onchange="toggleAutoPrintPopup(this.checked)" class="sr-only peer">
                                <div
                                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600">
                                </div>
                            </label>
                        </div>
                    </div>

                    <div id="config-basic-panel"
                        class="bg-white p-5 rounded-2xl shadow-sm border border-slate-200 space-y-4">

                        <h3 class="font-bold text-slate-700 border-b pb-2 mb-2 flex items-center gap-2">
                            <i class="fa-solid fa-paintbrush text-blue-500"></i> Giao di·ªán
                        </h3>
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="text-[10px] font-bold text-slate-400 uppercase">C·ª° ch·ªØ (Font Size)</label>
                                <select id="cfg-font-size" onchange="updateBasicTemplate()"
                                    class="w-full p-2 border border-slate-200 rounded-lg text-sm bg-slate-50 outline-none">
                                    <option value="10px">Nh·ªè (10px)</option>
                                    <option value="12px" selected>V·ª´a (12px)</option>
                                    <option value="14px">L·ªõn (14px)</option>
                                    <option value="16px">R·∫•t l·ªõn (16px)</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-[10px] font-bold text-slate-400 uppercase">Font ch·ªØ</label>
                                <select id="cfg-font-family" onchange="updateBasicTemplate()"
                                    class="w-full p-2 border border-slate-200 rounded-lg text-sm bg-slate-50 outline-none">
                                    <option value="system-ui, sans-serif" selected>M·∫∑c ƒë·ªãnh (Sans-serif)</option>
                                    <option value="'Courier New', monospace">M√°y in kim (Monospace)</option>
                                    <option value="'Times New Roman', serif">Trang tr·ªçng (Serif)</option>
                                </select>
                            </div>
                        </div>

                        <h3 class="font-bold text-slate-700 border-b pb-2 mb-2 mt-4">Th√¥ng tin c·ª≠a h√†ng</h3>
                        <div class="grid grid-cols-1 gap-3">
                            <div>
                                <label class="text-[10px] font-bold text-slate-400 uppercase">T√™n chi nh√°nh</label>
                                <input type="text" id="cfg-shop-name" oninput="updateBasicTemplate()"
                                    class="w-full p-2 border border-slate-200 rounded-lg text-sm font-bold"
                                    placeholder="T√™n hi·ªÉn th·ªã...">
                            </div>
                            <div>
                                <label class="text-[10px] font-bold text-slate-400 uppercase">Ch·ªçn Logo (Local)</label>
                                <select id="cfg-shop-logo" onchange="updateBasicTemplate()"
                                    class="w-full p-2 border border-slate-200 rounded-lg text-sm">
                                    <option value="">-- Kh√¥ng hi·ªán Logo --</option>
                                    <option value="./Asset/Logo/MaiTay.png">Mai T√¢y Hair Salon</option>
                                    <option value="./Asset/Logo/HienTran.png">Hi·ªÅn Tr·∫ßn Hair Studio</option>
                                    <option value="./Asset/Logo/HunqPOS.png">HunqPOS</option>
                                </select>
                                <div class="flex items-center gap-2">
                                    <label class="text-[10px] font-bold text-slate-400 uppercase whitespace-nowrap">K√≠ch
                                        th∆∞·ªõc:</label>
                                    <input type="range" id="cfg-logo-size" oninput="updateBasicTemplate()" min="10"
                                        max="100" value="50"
                                        class="flex-1 h-1 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600">
                                    <span id="disp-logo-size"
                                        class="text-[10px] font-bold text-blue-600 w-8 text-right">50%</span>
                                </div>
                            </div>
                            <div>
                                <label class="text-[10px] font-bold text-slate-400 uppercase">ƒê·ªãa ch·ªâ</label>
                                <input type="text" id="cfg-shop-addr" oninput="updateBasicTemplate()"
                                    class="w-full p-2 border border-slate-200 rounded-lg text-sm"
                                    placeholder="ƒê·ªãa ch·ªâ...">
                            </div>
                            <div class="grid grid-cols-2 gap-2">
                                <div>
                                    <label class="text-[10px] font-bold text-slate-400 uppercase">Hotline</label>
                                    <input type="text" id="cfg-shop-phone" oninput="updateBasicTemplate()"
                                        class="w-full p-2 border border-slate-200 rounded-lg text-sm"
                                        placeholder="SƒêT...">
                                </div>
                                <div>
                                    <label class="text-[10px] font-bold text-slate-400 uppercase">Facebook</label>
                                    <input type="text" id="cfg-shop-fb" oninput="updateBasicTemplate()"
                                        class="w-full p-2 border border-slate-200 rounded-lg text-sm"
                                        placeholder="T√™n Fanpage...">
                                </div>
                            </div>
                        </div>

                        <h3 class="font-bold text-slate-700 border-b pb-2 mb-2 mt-4">Ng√¢n h√†ng & QR Code (·∫¢nh tƒ©nh)</h3>
                        <div class="grid grid-cols-1 gap-3">
                            <div>
                                <label class="text-[10px] font-bold text-slate-400 uppercase">Ch·ªçn ·∫¢nh QR
                                    Banking</label>
                                <select id="cfg-bank-qr" onchange="updateBasicTemplate()"
                                    class="w-full p-2 border border-slate-200 rounded-lg text-sm font-bold text-purple-600">
                                    <option value="">-- Kh√¥ng hi·ªán QR --</option>
                                    <option value="./Asset/QRBanking/DHXM-BIDV.png">ƒêinh Hoa Xu√¢n Mai (BIDV)</option>
                                    <option value="./Asset/QRBanking/DHXM-VCB.png">ƒêinh Hoa Xu√¢n Mai (VietcomBank)
                                    </option>
                                    <option value="./Asset/QRBanking/TCH-BIDV.png">Tr·∫ßn C√¥ng Hi·ªÅn (BIDV)</option>
                                </select>
                            </div>
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="text-[10px] font-bold text-slate-400 uppercase">T√™n Ng√¢n h√†ng</label>
                                    <input type="text" id="cfg-bank-name" oninput="updateBasicTemplate()"
                                        class="w-full p-2 border border-slate-200 rounded-lg text-sm"
                                        placeholder="VD: BIDV">
                                </div>
                                <div>
                                    <label class="text-[10px] font-bold text-slate-400 uppercase">S·ªë t√†i kho·∫£n</label>
                                    <input type="text" id="cfg-bank-num" oninput="updateBasicTemplate()"
                                        class="w-full p-2 border border-slate-200 rounded-lg text-sm font-bold"
                                        placeholder="S·ªë TK text...">
                                </div>
                            </div>
                            <div>
                                <label class="text-[10px] font-bold text-slate-400 uppercase">Ch·ªß t√†i kho·∫£n</label>
                                <input type="text" id="cfg-bank-owner" oninput="updateBasicTemplate()"
                                    class="w-full p-2 border border-slate-200 rounded-lg text-sm uppercase"
                                    placeholder="T√™n ch·ªß th·∫ª...">
                            </div>
                        </div>

                        <h3 class="font-bold text-slate-700 border-b pb-2 mb-2 mt-4">L·ªùi ch√†o</h3>
                        <textarea id="cfg-footer-text" oninput="updateBasicTemplate()" rows="2"
                            class="w-full p-2 border border-slate-200 rounded-lg text-sm"
                            placeholder="C·∫£m ∆°n qu√Ω kh√°ch..."></textarea>
                    </div>

                    <div id="config-advanced-panel"
                        class="hidden flex-1 bg-white rounded-2xl shadow-sm border border-slate-200 flex flex-col overflow-hidden min-h-[500px]">

                        <div
                            class="bg-slate-50 p-4 border-b border-slate-100 flex justify-between items-center shrink-0">
                            <select id="print-template-select" onchange="loadTemplate(this.value)"
                                class="flex-1 p-2.5 bg-white border border-slate-200 rounded-xl font-medium outline-none focus:border-blue-500 mr-2">
                                <option value="k80">M·∫´u chu·∫©n 80mm (K80)</option>
                                <option value="k58">M·∫´u nh·ªè 58mm (K58)</option>
                                <option value="custom">T·ª± vi·∫øt code (Custom HTML)</option>
                            </select>
                            <button onclick="resetTemplate()"
                                class="px-4 py-2 bg-slate-100 text-slate-600 rounded-xl font-bold hover:bg-slate-200"
                                title="Kh√¥i ph·ª•c m·∫∑c ƒë·ªãnh"><i class="fa-solid fa-rotate-left"></i></button>
                        </div>

                        <div class="bg-white p-3 border-b border-slate-100 shrink-0">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-xs font-bold text-slate-500 uppercase"><i
                                        class="fa-solid fa-code mr-1"></i> M√£ ngu·ªìn</span>
                                <span class="text-[10px] text-slate-400 italic">Click v√†o th·∫ª ƒë·ªÉ copy bi·∫øn</span>
                            </div>

                            <div class="flex flex-wrap gap-2 max-h-[120px] overflow-y-auto pr-1 custom-scrollbar">
                                <span onclick="copyVar(this)" class="var-tag bg-blue-100 text-blue-700"
                                    title="T√™n c·ª≠a h√†ng">{{shopName}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-blue-100 text-blue-700"
                                    title="M√£ ƒë∆°n h√†ng">{{orderId}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-emerald-100 text-emerald-700"
                                    title="Danh s√°ch m√≥n (HTML)">{{items}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-emerald-100 text-emerald-700"
                                    title="T·ªïng ph·∫£i tr·∫£">{{total}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-orange-100 text-orange-700"
                                    title="Ph∆∞∆°ng th·ª©c TT">{{paymentMethod}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-purple-100 text-purple-700"
                                    title="T√™n kh√°ch h√†ng">{{customer}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-purple-100 text-purple-700"
                                    title="SƒêT Kh√°ch">{{customerPhone}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-orange-100 text-orange-700"
                                    title="Ti·ªÅn th·ª´a">{{change}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-blue-100 text-blue-700"
                                    title="Ng√†y (DD/MM/YYYY)">{{date}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-blue-100 text-blue-700"
                                    title="Gi·ªù (HH:MM)">{{time}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-blue-100 text-blue-700"
                                    title="T√™n thu ng√¢n">{{cashier}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-purple-100 text-purple-700"
                                    title="ƒêi·ªÉm hi·ªán c√≥">{{currentPoints}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-purple-100 text-purple-700"
                                    title="ƒêi·ªÉm t√≠ch ƒë∆∞·ª£c ƒë∆°n n√†y">{{pointsEarned}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-emerald-100 text-emerald-700"
                                    title="T·∫°m t√≠nh">{{subtotal}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-emerald-100 text-emerald-700"
                                    title="Ti·ªÅn gi·∫£m gi√°">{{discount}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-emerald-100 text-emerald-700"
                                    title="T·ªïng ti·ªÅn (S·ªë th√¥ cho QR)">{{rawTotal}}</span>
                                <span onclick="copyVar(this)" class="var-tag bg-orange-100 text-orange-700"
                                    title="Ti·ªÅn kh√°ch ƒë∆∞a">{{given}}</span>
                            </div>
                        </div>

                        <textarea id="print-code-editor"
                            class="flex-1 w-full h-full p-4 font-mono text-sm bg-[#1e293b] text-emerald-400 outline-none resize-none leading-relaxed"
                            spellcheck="false" placeholder=""></textarea>
                    </div>
                </div>

                <div
                    class="h-full min-h-0 bg-slate-200 rounded-2xl p-8 overflow-y-auto flex justify-center border shadow-inner">
                    <div id="print-preview-container"
                        class="bg-white shadow-2xl h-fit p-0 overflow-auto transition-all duration-300 origin-top transform scale-100">
                        <iframe id="preview-frame"
                            class="grayscale w-full h-full border-0 bg-white min-h-[500px]"></iframe>
                    </div>
                </div>
            </div>
        </main>

        <!-- SIDEBAR CART (z-30) -->
        <aside id="sidebar-cart"
            class="fixed h-full inset-0 z-50 bg-white flex flex-col h-screen border-l border-slate-100 transition-transform duration-300 transform translate-x-full md:translate-x-0 md:static md:w-[420px] md:flex shadow-2xl overflow-hidden">

            <div
                class="md:hidden bg-slate-100 p-3 flex items-center justify-between border-b border-slate-200 shrink-0">
                <span class="font-bold text-slate-700 flex items-center gap-2">
                    <i class="fa-solid fa-basket-shopping text-blue-600"></i> Gi·ªè h√†ng
                </span>
                <button onclick="toggleMobileCart()"
                    class="w-8 h-8 bg-white rounded-full flex items-center justify-center text-slate-500 shadow-sm active:bg-slate-200">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>

            <div
                class="bg-blue-50 p-2 flex items-center justify-between text-xs text-blue-800 border-b border-blue-100 shrink-0">
                <div class="flex items-center gap-2 cursor-pointer hover:underline" onclick="selectCustomerForOrder()">
                    <div class="w-5 h-5 rounded-full bg-blue-200 flex items-center justify-center text-blue-700">
                        <i class="fa-solid fa-user text-[10px]"></i>
                    </div>
                    <span id="current-customer-name" class="font-bold truncate max-w-[150px]">Kh√°ch l·∫ª</span>
                </div>
                <i class="fa-solid fa-chevron-right text-[10px] opacity-50"></i>
            </div>

            <div
                class="shrink-0 bg-white border-b border-slate-100 p-2 flex items-center gap-2 overflow-x-auto no-scrollbar">
                <div id="order-tabs-container" class="flex gap-2"></div>
                <button id="h-CreateNewOrder" onclick="createNewOrder()"
                    class="w-8 h-8 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 flex items-center justify-center transition ml-1 shrink-0 border border-blue-100">
                    <i class="fa-solid fa-plus"></i>
                </button>
            </div>

            <div
                class="p-4 bg-gradient-to-r from-slate-50 to-white border-b border-slate-100 flex justify-between items-center shrink-0">
                <div onclick="renameCurrentOrder()" class="cursor-pointer group">
                    <h3 id="current-order-name"
                        class="font-black text-xl text-slate-800 tracking-tight group-hover:text-blue-600 transition">
                        ƒê∆°n #1</h3>
                    <div class="text-xs text-slate-400 font-medium flex items-center gap-1">
                        <i class="fa-regular fa-clock"></i> <span id="current-order-time">--:--</span>
                    </div>
                </div>
                <button onclick="deleteCurrentOrder()"
                    class="w-8 h-8 rounded-full hover:bg-red-50 text-slate-300 hover:text-red-500 transition flex items-center justify-center"
                    title="H·ªßy ƒë∆°n n√†y">
                    <i class="fa-solid fa-trash-can"></i>
                </button>
            </div>

            <div id="cart-items" class="flex-1 overflow-y-auto p-4 space-y-3 bg-white min-h-0 custom-scrollbar">
            </div>

            <div
                class="shrink-0 bg-white border-t border-slate-100 p-4 shadow-[0_-5px_20px_rgba(0,0,0,0.03)] z-20 pb-safe mb-20 md:mb-0">

                <div class="flex flex-col gap-2 mb-3 bg-slate-50 p-2.5 rounded-xl border border-slate-100">
                    <div class="flex items-center justify-between cursor-pointer" onclick="toggleDiscountPanel()">
                        <div class="flex items-center gap-2 text-xs font-bold text-slate-600 uppercase tracking-wide">
                            <i class="fa-solid fa-tags text-orange-500"></i> ∆Øu ƒë√£i & Gi·∫£m gi√°
                        </div>
                        <i class="fa-solid fa-chevron-down text-slate-400 text-xs transition-transform duration-200"
                            id="disc-arrow"></i>
                    </div>

                    <div id="discount-panel" class="hidden mt-2 border-t border-slate-200 pt-2 space-y-2">
                        <div class="flex gap-1">
                            <input type="text" id="disc-coupon-input"
                                class="flex-1 bg-white border border-slate-200 rounded-lg px-2 py-1.5 text-xs outline-none uppercase font-bold focus:border-blue-500"
                                placeholder="M√£ Voucher...">
                            <button onclick="applyCoupon()"
                                class="bg-blue-100 text-blue-600 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-blue-200">√Åp
                                d·ª•ng</button>
                        </div>

                        <div class="flex gap-1">
                            <input type="text" id="disc-manual-input" oninput="formatInput(this)"
                                class="flex-1 bg-white border border-slate-200 rounded-lg px-2 py-1.5 text-xs outline-none font-bold text-right"
                                placeholder="Gi·∫£m tay...">
                            <select id="disc-manual-type"
                                class="bg-white border border-slate-200 rounded-lg px-1 text-xs outline-none font-bold">
                                <option value="amount">VNƒê</option>
                                <option value="percent">%</option>
                            </select>
                            <button onclick="applyManualDisc()"
                                class="bg-slate-200 text-slate-600 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-slate-300">OK</button>
                        </div>

                        <div id="point-usage-section" class="opacity-50 pointer-events-none transition-opacity">
                            <div class="flex justify-between text-[10px] font-bold text-slate-500 mb-1">
                                <span>D√πng ƒëi·ªÉm</span> <span id="cust-max-points" class="text-blue-600">0 P</span>
                            </div>
                            <div class="flex gap-1 mb-1">
                                <input type="text" id="disc-point-input" oninput="formatInput(this)"
                                    class="flex-1 bg-white border border-slate-200 rounded-lg px-2 py-1.5 text-xs font-bold text-right text-orange-600"
                                    placeholder="Nh·∫≠p ƒëi·ªÉm...">
                                <button onclick="applyPoints()"
                                    class="bg-orange-100 text-orange-600 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-orange-200">D√πng</button>
                            </div>
                            <div class="flex gap-1">
                                <button onclick="setQuickPoints(20)"
                                    class="flex-1 py-1 bg-orange-50 border border-orange-100 rounded text-[9px] font-bold text-orange-600 hover:bg-orange-100">20%</button>
                                <button onclick="setQuickPoints(50)"
                                    class="flex-1 py-1 bg-orange-50 border border-orange-100 rounded text-[9px] font-bold text-orange-600 hover:bg-orange-100">50%</button>
                                <button onclick="setQuickPoints(80)"
                                    class="flex-1 py-1 bg-orange-50 border border-orange-100 rounded text-[9px] font-bold text-orange-600 hover:bg-orange-100">80%</button>
                            </div>
                        </div>

                        <button onclick="clearAllDiscounts()"
                            class="w-full py-1.5 text-[10px] text-red-500 hover:bg-red-50 rounded-lg font-bold border border-dashed border-red-200">X√≥a
                            ∆∞u ƒë√£i</button>
                    </div>
                </div>

                <div class="mb-3 relative">
                    <textarea id="pos-order-note" oninput="updateOrderNote(this.value)" rows="1"
                        class="w-full bg-white border border-slate-200 rounded-xl p-2.5 pl-8 text-xs outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 resize-none transition"
                        placeholder="Ghi ch√∫ ƒë∆°n h√†ng..."></textarea>
                    <i class="fa-regular fa-pen-to-square absolute left-3 top-3 text-slate-400 text-xs"></i>
                </div>

                <div class="space-y-1 mb-4 pt-2 border-t border-dashed border-slate-200">
                    <div class="flex justify-between text-xs text-slate-500">
                        <span>T·∫°m t√≠nh</span>
                        <span id="cart-subtotal" class="font-medium text-slate-700">0 ‚Ç´</span>
                    </div>
                    <div id="row-discount" class="flex justify-between text-xs text-orange-600 hidden">
                        <span class="flex items-center gap-1"><i class="fa-solid fa-gift"></i> Gi·∫£m gi√° <span
                                id="discount-label"
                                class="bg-orange-50 px-1 rounded text-[9px] border border-orange-100"></span></span>
                        <span id="cart-discount" class="font-bold">-0 ‚Ç´</span>
                    </div>
                    <div class="flex justify-between items-end pt-2">
                        <span class="text-sm font-bold text-slate-700">Kh√°ch ph·∫£i tr·∫£</span>
                        <span id="cart-total" class="text-3xl font-black text-blue-600 leading-none tracking-tight">0
                            ‚Ç´</span>
                    </div>
                </div>

                <button onclick="openCheckoutModal()" id="btn-checkout"
                    class="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white py-4 rounded-2xl font-bold text-lg shadow-lg shadow-blue-500/30 transition-all active:scale-[0.98] flex items-center justify-center gap-3 disabled:opacity-50 disabled:grayscale disabled:cursor-not-allowed">
                    <span>Thanh to√°n</span> <i class="fa-solid fa-arrow-right animate-pulse"></i>
                </button>
            </div>
        </aside>


        <div id="mobile-cart-bar" onclick="toggleMobileCart()"
            class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 p-4 flex justify-between items-center z-40 shadow-[0_-5px_20px_rgba(0,0,0,0.1)] cursor-pointer pb-safe hover:bg-slate-50 transition active:bg-slate-100">
            <div class="flex items-center gap-3">
                <div class="relative">
                    <div
                        class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center text-lg shadow-lg shadow-blue-500/30">
                        <i class="fa-solid fa-basket-shopping"></i>
                    </div>
                    <span id="mobile-cart-count"
                        class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold w-5 h-5 rounded-full flex items-center justify-center border-2 border-white">0</span>
                </div>
                <div>
                    <div class="text-[10px] font-bold text-slate-400 uppercase">T·∫°m t√≠nh</div>
                    <div class="text-lg font-black text-slate-800 leading-none" id="mobile-cart-total">0 ‚Ç´</div>
                </div>
            </div>
            <div class="bg-blue-50 text-blue-600 px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2">
                Xem gi·ªè <i class="fa-solid fa-chevron-up text-xs"></i>
            </div>
        </div>



    </div>

    <!-- MODALS SECTION (z-50) -->

    <!-- 1. ADD PRODUCT MODAL -->
    <div id="add-product-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"
            onclick="toggleAddProductModal()"></div>
        <div
            class="bg-white rounded-3xl shadow-2xl w-full max-w-2xl relative z-10 overflow-hidden animate-fade-in flex flex-col max-h-[90vh]">
            <div class="bg-slate-50 p-6 border-b border-slate-100 flex justify-between items-center">
                <h3 id="modal-prod-title" class="text-lg font-bold text-slate-800">üì¶ Th√¥ng tin s·∫£n ph·∫©m</h3><button
                    onclick="toggleAddProductModal()"
                    class="w-8 h-8 rounded-full bg-white border border-slate-200 text-slate-400 hover:text-slate-800 flex items-center justify-center transition"><i
                        class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="p-6 overflow-y-auto space-y-5">
                <input type="hidden" id="prod-id">
                <div class="grid grid-cols-2 gap-4">
                    <div class="col-span-2 md:col-span-1">
                        <label class="block text-xs font-bold text-slate-500 uppercase tracking-wide mb-2">T√™n s·∫£n
                            ph·∫©m</label>
                        <input type="text" id="prod-name" onkeydown="handleEnter(event, 'btn-save-prod')"
                            class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl font-medium focus:bg-white focus:border-blue-500 outline-none transition"
                            placeholder="V√≠ d·ª•: C·∫Øt t√≥c">
                    </div>
                    <div class="col-span-2 md:col-span-1">
                        <label class="block text-xs font-bold text-slate-500 uppercase tracking-wide mb-2">Danh
                            m·ª•c</label>
                        <select id="prod-cat"
                            class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl font-medium focus:bg-white focus:border-blue-500 outline-none appearance-none"></select>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase tracking-wide mb-2">Gi√°
                            b√°n</label>
                        <div class="relative">
                            <input type="text" inputmode="numeric" oninput="formatInput(this)"
                                onkeydown="handleEnter(event, 'btn-save-prod')" id="prod-price"
                                class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl font-medium focus:bg-white focus:border-blue-500 outline-none text-right pr-12"
                                placeholder="0">
                            <span
                                class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-xs font-bold">VNƒê</span>
                        </div>
                    </div>
                </div>

                <div class="border-t border-slate-100 pt-4">
                    <label class="block text-xs font-bold text-slate-500 uppercase tracking-wide mb-2">Qu·∫£n l√Ω t·ªìn kho
                        (Chi nh√°nh hi·ªán t·∫°i)</label>
                    <div class="flex gap-4 mb-3">
                        <label
                            class="flex items-center gap-2 cursor-pointer bg-slate-50 px-4 py-2 rounded-lg border border-slate-200 hover:border-blue-300 transition">
                            <input type="radio" name="stock-type" value="infinite" checked onclick="toggleStockInput()"
                                class="text-blue-600 focus:ring-blue-500">
                            <span class="text-sm font-semibold text-slate-700">V√¥ h·∫°n</span>
                        </label>
                        <label
                            class="flex items-center gap-2 cursor-pointer bg-slate-50 px-4 py-2 rounded-lg border border-slate-200 hover:border-blue-300 transition">
                            <input type="radio" name="stock-type" value="limited" onclick="toggleStockInput()"
                                class="text-blue-600 focus:ring-blue-500">
                            <span class="text-sm font-semibold text-slate-700">Gi·ªõi h·∫°n</span>
                        </label>
                    </div>
                    <div id="stock-input-container" class="hidden">
                        <input type="text" inputmode="numeric" oninput="formatInput(this)"
                            onkeydown="handleEnter(event, 'btn-save-prod')" id="prod-stock"
                            class="w-full p-3.5 bg-white border border-slate-300 rounded-xl font-medium focus:ring-2 focus:ring-blue-500 outline-none"
                            placeholder="Nh·∫≠p s·ªë l∆∞·ª£ng...">
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase tracking-wide mb-2">M√¥ t·∫£</label>
                    <textarea id="prod-desc" rows="2"
                        class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl font-medium focus:bg-white focus:border-blue-500 outline-none transition text-sm"></textarea>
                </div>
            </div>
            <div class="p-6 pt-0 border-t border-slate-100 bg-slate-50 mt-auto flex justify-between gap-3 pt-4"><button
                    onclick="deleteProduct()" id="btn-delete-prod"
                    class="hidden px-5 py-3 text-red-600 font-bold hover:bg-red-50 border border-red-200 rounded-xl transition flex items-center gap-2"><i
                        class="fa-solid fa-trash-can"></i> X√≥a</button>
                <div class="flex gap-3 ml-auto"><button onclick="toggleAddProductModal()"
                        class="px-6 py-3 text-slate-600 font-bold hover:bg-slate-200 rounded-xl transition">H·ªßy</button><button
                        id="btn-save-prod" onclick="saveProduct()"
                        class="px-8 py-3 bg-slate-800 hover:bg-black text-white rounded-xl font-bold shadow-lg transition active:scale-[0.98]">L∆∞u</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 2. ADD CUSTOMER MODAL -->
    <div id="customer-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"
            onclick="toggleCustomerModal()">
        </div>

        <div
            class="bg-white rounded-3xl shadow-2xl w-full max-w-md relative z-10 overflow-hidden animate-fade-in flex flex-col max-h-[90vh]">

            <div class="bg-slate-50 p-6 border-b border-slate-100 flex justify-between items-center shrink-0">
                <h3 class="text-lg font-bold text-slate-800">üë§ Th√¥ng tin kh√°ch h√†ng</h3>
                <button onclick="toggleCustomerModal()"
                    class="w-8 h-8 rounded-full bg-white border border-slate-200 text-slate-400 hover:text-slate-800 flex items-center justify-center transition">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>

            <div class="p-6 space-y-4 overflow-y-auto">
                <input type="hidden" id="cust-id">

                <div class="grid grid-cols-2 gap-4">
                    <div class="col-span-2">
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">H·ªç t√™n *</label>
                        <input type="text" id="cust-name"
                            class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-blue-500 font-bold text-slate-700">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">S·ªë ƒëi·ªán tho·∫°i *</label>
                        <input type="tel" id="cust-phone"
                            class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">H·∫°ng (Rank)</label>
                        <select id="cust-rank"
                            class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-blue-500 disabled:opacity-50 disabled:bg-slate-100">
                            <option value="member">Th√†nh vi√™n (1%)</option>
                            <option value="regular">Kh√°ch quen (3%)</option>
                            <option value="vip">VIP (5%)</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1">M·∫°ng x√£ h·ªôi (Link)</label>
                    <input type="text" id="cust-social" placeholder="Link Facebook / Zalo / Instagram..."
                        class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-blue-500 text-sm">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Email</label>
                        <input type="email" id="cust-email"
                            class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-blue-500 text-sm">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Ng√†y sinh</label>
                        <input type="date" id="cust-dob"
                            class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-blue-500 text-slate-500 text-sm">
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Ghi ch√∫</label>
                    <textarea id="cust-notes" rows="2"
                        class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-blue-500 text-sm"
                        placeholder="S·ªü th√≠ch, l∆∞u √Ω..."></textarea>
                </div>

                <div class="pt-4 border-t border-slate-100 mt-2">
                    <h4 class="text-xs font-bold text-slate-500 uppercase mb-2 flex justify-between items-center">
                        L·ªãch s·ª≠ ƒëi·ªÉm (30 g·∫ßn nh·∫•t)
                        <button onclick="refreshPointHistory()" class="text-blue-500 hover:underline text-[10px]"><i
                                class="fa-solid fa-rotate"></i> T·∫£i l·∫°i</button>
                    </h4>
                    <div
                        class="bg-slate-50 rounded-xl border border-slate-200 overflow-hidden h-[150px] overflow-y-auto">
                        <table class="w-full text-left text-sm">
                            <thead class="bg-slate-100 text-slate-500 font-bold text-[10px] uppercase sticky top-0">
                                <tr>
                                    <th class="p-2 w-24">Th·ªùi gian</th>
                                    <th class="p-2">H√†nh ƒë·ªông</th>
                                    <th class="p-2 text-right">Bi·∫øn ƒë·ªông</th>
                                </tr>
                            </thead>
                            <tbody id="cust-point-history-list" class="divide-y divide-slate-100"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="p-6 pt-4 border-t border-slate-100 shrink-0 bg-white">
                <button id="btn-save-cust" onclick="saveCustomer()"
                    class="w-full py-3 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 shadow-lg shadow-blue-200 transition active:scale-[0.98]">
                    L∆∞u th√¥ng tin
                </button>
            </div>

        </div>
    </div>

    <div id="customer-select-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"
            onclick="toggleCustomerSelectModal()"></div>
        <div
            class="bg-white rounded-3xl shadow-2xl w-full max-w-lg relative z-10 overflow-hidden animate-fade-in flex flex-col h-[70vh]">
            <div class="bg-slate-50 p-4 border-b border-slate-100 flex justify-between items-center shrink-0">
                <h3 class="text-lg font-bold text-slate-800">üîç Ch·ªçn kh√°ch h√†ng</h3>
                <button onclick="toggleCustomerSelectModal()"
                    class="w-8 h-8 rounded-full bg-white border border-slate-200 text-slate-400 hover:text-slate-800 flex items-center justify-center transition"><i
                        class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="p-4 border-b border-slate-100 bg-white shrink-0">
                <div class="relative">
                    <i class="fa-solid fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                    <input type="text" id="cust-search-input" oninput="renderCustomerSelectItems()"
                        class="w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-blue-500 transition font-medium"
                        placeholder="T√¨m t√™n ho·∫∑c s·ªë ƒëi·ªán tho·∫°i..." autofocus>
                </div>
            </div>
            <div id="customer-select-list" class="flex-1 overflow-y-auto p-2 space-y-1 bg-slate-50">
            </div>
            <div class="p-4 border-t border-slate-100 bg-white shrink-0">
                <button onclick="toggleCustomerSelectModal(); toggleCustomerModal();"
                    class="w-full py-3 bg-blue-50 text-blue-600 rounded-xl font-bold hover:bg-blue-100 transition border border-blue-200 dashed"><i
                        class="fa-solid fa-user-plus mr-2"></i>T·∫°o kh√°ch h√†ng m·ªõi</button>
            </div>
        </div>
    </div>

    <!-- 3. GIFT CARD MODAL -->
    <div id="promo-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity" onclick="togglePromoModal()">
        </div>
        <div class="bg-white rounded-3xl shadow-2xl w-full max-w-md relative z-10 overflow-hidden animate-fade-in">
            <div class="bg-slate-50 p-6 border-b border-slate-100 flex justify-between items-center">
                <h3 class="text-lg font-bold text-slate-800">üéÅ Th·∫ª qu√† t·∫∑ng m·ªõi</h3><button
                    onclick="togglePromoModal()"
                    class="w-8 h-8 rounded-full bg-white border border-slate-200 text-slate-400 hover:text-slate-800 flex items-center justify-center transition"><i
                        class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="p-6 space-y-4">
                <input type="text" id="promo-code" onkeydown="handleEnter(event, 'btn-save-card')"
                    class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-orange-500 font-bold uppercase tracking-widest text-center text-lg"
                    placeholder="M√É TH·∫∫ (VD: SUMMER2025)">

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1">Lo·∫°i ∆∞u ƒë√£i</label>
                        <select id="promo-type"
                            class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-orange-500 font-medium">
                            <option value="fixed">Ti·ªÅn m·∫∑t (VNƒê)</option>
                            <option value="percent">Ph·∫ßn trƒÉm (%)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1">Gi√° tr·ªã</label>
                        <input type="text" inputmode="numeric" oninput="formatInput(this)"
                            onkeydown="handleEnter(event, 'btn-save-card')" id="promo-value"
                            class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:border-orange-500 text-right font-bold"
                            placeholder="0">
                    </div>
                </div>

                <div class="bg-orange-50 p-3 rounded-xl border border-orange-100 text-xs text-orange-800">
                    <i class="fa-solid fa-circle-info mr-1"></i> Th·∫ª ch·ªâ s·ª≠ d·ª•ng ƒë∆∞·ª£c <b>1 l·∫ßn duy nh·∫•t</b>.
                </div>
            </div>
            <div class="p-6 pt-0"><button id="btn-save-card" onclick="saveGiftCard()"
                    class="w-full py-3 bg-orange-500 text-white rounded-xl font-bold hover:bg-orange-600 shadow-lg">T·∫°o
                    th·∫ª</button></div>
        </div>
    </div>

    <!-- 4. CATEGORY MODAL -->
    <div id="category-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"
            onclick="toggleCategoryModal()"></div>

        <div class="bg-white rounded-3xl shadow-2xl w-full max-w-md relative z-10 overflow-hidden animate-fade-in">

            <div class="bg-slate-50 p-6 border-b border-slate-100 flex justify-between items-center">
                <h3 class="text-lg font-bold text-slate-800" id="cat-modal-title">üìÇ Th√™m danh m·ª•c m·ªõi</h3>
                <button onclick="toggleCategoryModal()"
                    class="w-8 h-8 rounded-full bg-white border border-slate-200 text-slate-400 hover:text-slate-800 flex items-center justify-center transition"><i
                        class="fa-solid fa-xmark"></i></button>
            </div>

            <div class="p-6">
                <div class="flex gap-2 mb-4">

                    <input type="hidden" id="cat-id">

                    <input type="text" id="cat-name" onkeydown="handleEnter(event, 'btn-save-cat')"
                        class="flex-1 p-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:border-blue-500 outline-none"
                        placeholder="T√™n danh m·ª•c m·ªõi...">

                    <button id="btn-save-cat" onclick="saveCategory()"
                        class="bg-blue-600 text-white px-4 rounded-xl font-bold hover:bg-blue-700 transition">
                        <span id="btn-cat-label">Th√™m</span>
                    </button>
                </div>

                <div class="max-h-[300px] overflow-y-auto space-y-2" id="category-list"></div>
            </div>
        </div>
    </div>

    <!-- 5. CHECKOUT MODAL -->
    <div id="checkout-modal" class="fixed inset-0 z-[60] hidden flex items-center justify-center px-0 md:px-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-md transition-opacity"
            onclick="closeCheckoutModal()"></div>

        <div
            class="bg-white md:rounded-3xl shadow-2xl w-full max-w-5xl relative z-10 overflow-hidden flex flex-col md:flex-row h-full md:h-auto md:max-h-[90vh] animate-fade-in rounded-none">

            <div class="md:hidden bg-slate-50 p-4 border-b border-slate-200 flex justify-between items-center shrink-0">
                <h3 class="font-bold text-lg text-slate-800">Thanh to√°n</h3>
                <button onclick="closeCheckoutModal()"
                    class="w-8 h-8 bg-white rounded-full flex items-center justify-center text-slate-500 shadow-sm"><i
                        class="fa-solid fa-xmark"></i></button>
            </div>

            <div
                class="w-full md:w-1/3 bg-slate-50 border-b md:border-b-0 md:border-r border-slate-200 p-4 md:p-6 shrink-0">
                <h3 class="hidden md:block text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">H√¨nh th·ª©c
                    thanh to√°n</h3>

                <div class="grid grid-cols-3 md:grid-cols-1 gap-2 md:gap-3">
                    <button onclick="setPaymentMethod('cash')" id="pm-cash"
                        class="pm-btn active flex flex-col md:flex-row items-center md:items-start p-3 md:p-4 rounded-xl border text-center md:text-left gap-2 md:gap-4 transition-all hover:shadow-md group h-full">
                        <div
                            class="w-8 h-8 md:w-10 md:h-10 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-sm md:text-lg group-[.active]:bg-blue-600 group-[.active]:text-white transition-colors">
                            <i class="fa-solid fa-money-bill-wave"></i>
                        </div>
                        <div>
                            <div class="font-bold text-xs md:text-sm text-slate-800 group-[.active]:text-blue-700">Ti·ªÅn
                                m·∫∑t</div>
                            <div class="hidden md:block text-xs text-slate-500">Ti·ªÅn l·∫ª tr·∫£ l·∫°i</div>
                        </div>
                    </button>

                    <button onclick="setPaymentMethod('transfer')" id="pm-transfer"
                        class="pm-btn flex flex-col md:flex-row items-center md:items-start p-3 md:p-4 rounded-xl border text-center md:text-left gap-2 md:gap-4 transition-all hover:shadow-md group h-full">
                        <div
                            class="w-8 h-8 md:w-10 md:h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-sm md:text-lg group-[.active]:bg-blue-600 group-[.active]:text-white transition-colors">
                            <i class="fa-solid fa-qrcode"></i>
                        </div>
                        <div>
                            <div class="font-bold text-xs md:text-sm text-slate-800 group-[.active]:text-blue-700">
                                Chuy·ªÉn kho·∫£n</div>
                            <div class="hidden md:block text-xs text-slate-500">VietQR t·ª± ƒë·ªông</div>
                        </div>
                    </button>

                    <button onclick="setPaymentMethod('gift')" id="pm-gift"
                        class="pm-btn flex flex-col md:flex-row items-center md:items-start p-3 md:p-4 rounded-xl border text-center md:text-left gap-2 md:gap-4 transition-all hover:shadow-md group h-full">
                        <div
                            class="w-8 h-8 md:w-10 md:h-10 rounded-full bg-orange-100 text-orange-600 flex items-center justify-center text-sm md:text-lg group-[.active]:bg-blue-600 group-[.active]:text-white transition-colors">
                            <i class="fa-solid fa-gift"></i>
                        </div>
                        <div>
                            <div class="font-bold text-xs md:text-sm text-slate-800 group-[.active]:text-blue-700">Th·∫ª
                                qu√† t·∫∑ng</div>
                            <div class="hidden md:block text-xs text-slate-500">Voucher</div>
                        </div>
                    </button>
                </div>

                <style>
                    .pm-btn.active {
                        border-color: #3b82f6;
                        background: #eff6ff;
                    }

                    .pm-btn:not(.active) {
                        border-color: transparent;
                        background: white;
                        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
                    }
                </style>
            </div>

            <div class="flex-1 p-6 md:p-8 flex flex-col relative bg-white overflow-y-auto">
                <button onclick="closeCheckoutModal()"
                    class="hidden md:flex absolute top-6 right-6 w-10 h-10 rounded-full bg-slate-50 hover:bg-slate-100 items-center justify-center text-slate-400 transition"><i
                        class="fa-solid fa-xmark text-lg"></i></button>

                <div class="text-center mb-6 mt-4 md:mt-0">
                    <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-1">T·ªïng ti·ªÅn thanh to√°n</p>
                    <h2 id="modal-total-amount" class="text-4xl md:text-5xl font-black text-slate-800 tracking-tighter">
                        0</h2>
                </div>

                <div id="pay-cash-ui" class="flex-1 flex flex-col justify-start animate-fade-in">
                    <div class="mb-4 relative">
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-2 ml-1">Kh√°ch ƒë∆∞a</label>
                        <input type="text" inputmode="numeric" oninput="formatInput(this); calculateChange();"
                            id="cash-given"
                            class="w-full text-3xl font-bold p-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:border-blue-500 focus:bg-white outline-none transition text-center text-blue-600"
                            placeholder="0">
                    </div>

                    <div class="mb-6">
                        <div class="flex gap-2 mb-2">
                            <button
                                onclick="setQuickCash(0); document.getElementById('cash-given').value = ''; calculateChange();"
                                class="w-12 flex-shrink-0 py-3 bg-red-100 text-red-500 border border-red-200 rounded-xl text-sm font-bold shadow-sm hover:bg-red-200 transition flex items-center justify-center"><i
                                    class="fa-solid fa-xmark"></i></button>
                            <div class="flex-1 grid grid-cols-4 gap-2">
                                <button onclick="setQuickCash(1000)"
                                    class="py-2 bg-white border border-slate-200 rounded-lg text-[10px] font-bold text-slate-600">1k</button>
                                <button onclick="setQuickCash(2000)"
                                    class="py-2 bg-white border border-slate-200 rounded-lg text-[10px] font-bold text-slate-600">2k</button>
                                <button onclick="setQuickCash(5000)"
                                    class="py-2 bg-white border border-slate-200 rounded-lg text-[10px] font-bold text-slate-600">5k</button>
                                <button onclick="setQuickCash(10000)"
                                    class="py-2 bg-yellow-50 border border-yellow-200 rounded-lg text-[10px] font-bold text-yellow-700">10k</button>
                            </div>
                        </div>
                        <div class="grid grid-cols-4 gap-2">
                            <button onclick="setQuickCash(20000)"
                                class="py-3 bg-blue-50 border border-blue-200 rounded-xl text-xs font-bold text-blue-700">20k</button>
                            <button onclick="setQuickCash(50000)"
                                class="py-3 bg-pink-50 border border-pink-200 rounded-xl text-xs font-bold text-pink-700">50k</button>
                            <button onclick="setQuickCash(100000)"
                                class="py-3 bg-green-50 border border-green-200 rounded-xl text-xs font-bold text-green-700">100k</button>
                            <button onclick="setQuickCash(200000)"
                                class="py-3 bg-orange-50 border border-orange-200 rounded-xl text-xs font-bold text-orange-700">200k</button>
                        </div>
                        <div class="grid grid-cols-2 gap-2 mt-2">
                            <button onclick="setQuickCash(500000)"
                                class="py-3 bg-cyan-50 border border-cyan-200 rounded-xl text-xs font-bold text-cyan-700">500k</button>
                            <button onclick="setQuickCash(1000000)"
                                class="py-3 bg-slate-100 border border-slate-200 rounded-xl text-xs font-bold text-slate-700">1
                                Tri·ªáu</button>
                        </div>
                    </div>

                    <div
                        class="bg-emerald-50 border border-emerald-100 p-4 rounded-2xl flex justify-between items-center mb-4">
                        <span class="font-bold text-emerald-800 text-sm">Ti·ªÅn th·ª´a tr·∫£ l·∫°i</span>
                        <span id="cash-change" class="text-2xl font-black text-emerald-600">0 ‚Ç´</span>
                    </div>
                </div>

                <div id="pay-transfer-ui"
                    class="hidden flex-1 flex flex-col items-center justify-center animate-fade-in text-center py-4">
                    <div class="p-4 bg-white border-2 border-dashed border-slate-300 rounded-2xl mb-4">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=DemoPOS"
                            class="w-32 h-32 md:w-40 md:h-40 opacity-80 mix-blend-multiply">
                    </div>
                    <p class="font-bold text-slate-700">Qu√©t m√£ ƒë·ªÉ chuy·ªÉn kho·∫£n</p>
                    <p class="text-xs text-slate-400">H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông x√°c nh·∫≠n...</p>
                </div>

                <div id="pay-gift-ui" class="hidden flex-1 flex flex-col justify-start animate-fade-in">
                    <div class="bg-orange-50 border border-orange-100 rounded-2xl p-4 mb-4 text-center">
                        <i class="fa-solid fa-gift text-3xl text-orange-400 mb-2"></i>
                        <h4 class="font-bold text-orange-800 text-sm mb-1">Thanh to√°n b·∫±ng Th·∫ª qu√† t·∫∑ng</h4>
                    </div>
                    <div class="relative">
                        <input type="text" id="gift-code-input"
                            class="w-full text-lg font-bold p-4 bg-white border-2 border-slate-200 rounded-2xl focus:border-orange-500 outline-none transition uppercase tracking-widest text-center"
                            placeholder="NH·∫¨P M√É TH·∫∫">
                        <button onclick="checkGiftCard()"
                            class="absolute right-2 top-2 bottom-2 px-4 bg-orange-500 text-white rounded-xl font-bold hover:bg-orange-600 transition text-xs">Ki·ªÉm
                            tra</button>
                    </div>
                    <div id="gift-status" class="mt-4 text-center text-sm font-medium text-slate-400">Ch∆∞a nh·∫≠p m√£</div>
                </div>

                <div class="flex flex-col md:flex-row gap-3 mt-auto pt-4 border-t border-slate-100">
                    <button onclick="processPayment(false, true)"
                        class="w-full md:flex-1 py-3 md:py-4 bg-purple-50 text-purple-600 font-bold rounded-xl border border-purple-100 hover:bg-purple-100 transition flex items-center justify-center gap-2">
                        <i class="fa-solid fa-cloud-arrow-up"></i> G·ª≠i in PC
                    </button>
                    <div class="flex gap-3 w-full md:flex-[2]">
                        <button onclick="processPayment(false)"
                            class="flex-1 py-3 md:py-4 bg-white border-2 border-slate-200 text-slate-600 font-bold rounded-xl hover:bg-slate-50 transition text-sm">
                            Ch·ªâ L∆∞u
                        </button>
                        <button onclick="processPayment(true)"
                            class="flex-[2] py-3 md:py-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg shadow-blue-200 transition active:scale-[0.98] flex items-center justify-center gap-2 text-sm">
                            <i class="fa-solid fa-print"></i> L∆∞u & In
                        </button>
                    </div>
                </div>

                <div class="h-6 md:hidden"></div>
            </div>
        </div>
    </div>


    <!-- 5. CN MODAL -->
    <div id="branch-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity" onclick="toggleBranchModal()">
        </div>
        <div class="bg-white rounded-3xl shadow-2xl w-full max-w-md relative z-10 overflow-hidden animate-fade-in">
            <div class="bg-slate-50 p-6 border-b border-slate-100 flex justify-between items-center">
                <h3 class="text-lg font-bold text-slate-800">üè¢ Qu·∫£n l√Ω Chi nh√°nh</h3>
                <button onclick="toggleBranchModal()"
                    class="w-8 h-8 rounded-full bg-white border border-slate-200 text-slate-400 hover:text-slate-800 flex items-center justify-center transition"><i
                        class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="p-6">
                <div class="flex gap-2 mb-4">
                    <input type="text" id="new-branch-name"
                        class="flex-1 p-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:border-blue-500 outline-none"
                        placeholder="T√™n chi nh√°nh m·ªõi...">
                    <button onclick="addNewBranch()"
                        class="bg-blue-600 text-white px-4 rounded-xl font-bold hover:bg-blue-700 transition">Th√™m</button>
                </div>
                <div class="max-h-[300px] overflow-y-auto space-y-2" id="branch-list-container">
                </div>
                <div class="mt-6 pt-4 border-t border-slate-100">
                    <h4 class="text-xs font-bold text-slate-400 uppercase mb-3">C√¥ng c·ª• kho h√†ng</h4>
                    <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                        <p class="text-xs text-blue-800 mb-3 font-medium">Sao ch√©p s·ªë l∆∞·ª£ng t·ªìn kho t·ª´ chi nh√°nh n√†y
                            sang chi nh√°nh kh√°c (D·ªØ li·ªáu ƒë√≠ch s·∫Ω b·ªã ghi ƒë√®).</p>
                        <div class="flex flex-col gap-2">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-slate-500 w-12">T·ª´:</span>
                                <select id="copy-from-branch"
                                    class="flex-1 text-sm p-2 rounded border border-slate-200 outline-none"></select>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-slate-500 w-12">ƒê·∫øn:</span>
                                <select id="copy-to-branch"
                                    class="flex-1 text-sm p-2 rounded border border-slate-200 outline-none"></select>
                            </div>
                            <button onclick="executeCopyStock()"
                                class="mt-2 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg text-sm font-bold shadow-sm transition">Th·ª±c
                                hi·ªán Sao ch√©p</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div id="customer-search-modal" class="fixed inset-0 z-[60] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"
            onclick="closeCustomerSearch()"></div>
        <div
            class="bg-white rounded-3xl shadow-2xl w-full max-w-md relative z-10 overflow-hidden animate-fade-in flex flex-col max-h-[80vh]">
            <div class="bg-slate-50 p-4 border-b border-slate-100 flex justify-between items-center">
                <h3 class="text-lg font-bold text-slate-800">üîç Ch·ªçn kh√°ch h√†ng</h3>
                <button onclick="closeCustomerSearch()"
                    class="w-8 h-8 rounded-full bg-white border border-slate-200 text-slate-400 hover:text-slate-800 flex items-center justify-center"><i
                        class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="p-4 bg-white">
                <div class="relative">
                    <i class="fa-solid fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                    <input type="text" id="cust-search-input" oninput="renderCustomerSuggestions()"
                        class="w-full pl-10 p-3 bg-slate-50 border border-slate-200 rounded-xl font-medium focus:border-blue-500 outline-none"
                        placeholder="Nh·∫≠p t√™n ho·∫∑c SƒêT...">
                </div>
            </div>
            <div id="cust-search-results" class="flex-1 overflow-y-auto p-2 space-y-1 bg-slate-50">
            </div>
            <div class="p-4 border-t border-slate-100 bg-white">
                <button onclick="closeCustomerSearch(); toggleCustomerModal()"
                    class="w-full py-3 bg-blue-100 text-blue-700 rounded-xl font-bold hover:bg-blue-200 transition"><i
                        class="fa-solid fa-plus mr-2"></i>T·∫°o kh√°ch m·ªõi</button>
            </div>
        </div>
    </div>

    <!-- Login -->
    <div id="login-modal" class="fixed inset-0 z-[200] flex items-center justify-center px-4 bg-slate-900">
        <div class="bg-white rounded-3xl shadow-2xl w-full max-w-sm p-8 text-center animate-fade-in">
            <div class="w-16 h-16 rounded-full flex items-center justify-center text-3xl mx-auto mb-6"
                style=" box-shadow: 0 0 10px rgb(215 192 142);;">
                <img src="/Asset/logo/logo.png" alt="Logo" srcset="/Asset/logo/logo.png">

            </div>

            <h2 class="text-2xl font-black text-slate-800 mb-2">HunqPOS</h2>
            <p class="text-slate-500 mb-6 text-sm">Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ b·∫Øt ƒë·∫ßu ca l√†m vi·ªác</p>

            <div class="space-y-4 mb-6">
                <input type="email" id="login-email"
                    class="w-full p-4 bg-slate-50 border border-slate-200 rounded-xl font-medium focus:border-blue-500 outline-none transition"
                    placeholder="Email nh√¢n vi√™n">
                <input type="password" id="login-pass" onkeydown="handleEnter(event, 'btn-login')"
                    class="w-full p-4 bg-slate-50 border border-slate-200 rounded-xl font-medium focus:border-blue-500 outline-none transition"
                    placeholder="M·∫≠t kh·∫©u">
            </div>

            <button id="btn-login" onclick="handleLogin()"
                class="w-full py-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg shadow-blue-500/30 transition active:scale-[0.98] flex items-center justify-center gap-2">
                <span>Truy c·∫≠p</span> <i class="fa-solid fa-arrow-right"></i>
            </button>
            <p class="text-slate-400 my-6 text-sm"> Designed & Developed by <a class="text-blue-500 !font-bold "
                    href="http://facebok.com/HunqD" target="_blank" rel="noopener noreferrer"> ƒêinh M·∫°nh H√πng üëë</a></p>

            <p id="login-error" class="text-red-500 text-sm font-bold mt-4 hidden"></p>
        </div>
    </div>

    <!-- DIALOG (z-100) -->
    <div id="global-dialog" class="fixed inset-0 z-[100] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"></div>
        <div
            class="bg-white rounded-2xl shadow-2xl w-full max-w-sm relative z-10 p-6 animate-fade-in flex flex-col items-center text-center">
            <div id="dialog-icon" class="mb-4 text-4xl text-blue-500"><i class="fa-solid fa-circle-info"></i></div>
            <h3 id="dialog-title" class="text-xl font-bold text-slate-800 mb-2">Th√¥ng b√°o</h3>
            <p id="dialog-msg" class="text-slate-500 mb-6 w-full break-words">N·ªôi dung th√¥ng b√°o</p>
            <div id="dialog-input-container" class="w-full mb-6 hidden"><input type="text" id="dialog-input"
                    class="w-full p-3 border border-slate-200 rounded-xl focus:border-blue-500 outline-none text-center font-bold text-slate-700"
                    placeholder="Nh·∫≠p gi√° tr·ªã..."></div>
            <div class="flex gap-3 w-full"><button id="dialog-cancel-btn"
                    class="flex-1 py-2.5 rounded-xl border border-slate-200 text-slate-600 font-bold hover:bg-slate-50 transition hidden">H·ªßy</button><button
                    id="dialog-confirm-btn"
                    class="flex-1 py-2.5 rounded-xl bg-blue-600 text-white font-bold hover:bg-blue-700 shadow-lg shadow-blue-200 transition">ƒê·ªìng
                    √Ω</button></div>
        </div>
    </div>

    <!-- TOAST (z-100) -->
    <div id="toast"
        class="fixed bottom-6 right-6 bg-slate-800 text-white px-6 py-4 rounded-2xl shadow-2xl transform translate-y-32 opacity-0 transition-all duration-500 flex items-center gap-4 z-[100] border border-slate-700/50">
        <div
            class="w-10 h-10 rounded-full bg-emerald-500/20 text-emerald-400 flex items-center justify-center flex-shrink-0 text-xl">
            <i class="fa-solid fa-check"></i>
        </div>
        <div>
            <h4 class="font-bold text-sm">Th√¥ng b√°o</h4>
            <p id="toast-msg" class="text-sm text-slate-400">N·ªôi dung th√¥ng b√°o</p>
        </div>
    </div>

    <iframe id="print-frame" class="hidden w-0 h-0 border-0"></iframe>

    <nav id="mobile-bottom-nav"
        class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 flex justify-around items-center h-16 z-50 pb-safe shadow-[0_-5px_20px_rgba(0,0,0,0.05)]">

        <button onclick="switchView('pos')" id="mob-nav-pos"
            class="mobile-nav-item active flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-blue-600 transition">
            <i class="fa-solid fa-cash-register text-xl mb-1"></i>
            <span class="text-[10px] font-bold">B√°n h√†ng</span>
        </button>

        <button onclick="switchView('history')" id="mob-nav-history"
            class="mobile-nav-item flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-blue-600 transition">
            <i class="fa-solid fa-clock-rotate-left text-xl mb-1"></i>
            <span class="text-[10px] font-bold">L·ªãch s·ª≠</span>
        </button>

        <div class="relative -top-5">
            <button onclick="toggleMobileCart()"
                class="w-14 h-14 bg-blue-600 rounded-full flex items-center justify-center text-white shadow-lg shadow-blue-500/40 border-4 border-[#f3f4f6]">
                <i class="fa-solid fa-basket-shopping text-xl"></i>
                <span id="mob-nav-cart-count"
                    class="absolute top-0 right-0 bg-red-500 text-white text-[10px] font-bold w-5 h-5 rounded-full flex items-center justify-center border-2 border-white">0</span>
            </button>
        </div>

        <button onclick="switchView('customers')" id="mob-nav-customers"
            class="mobile-nav-item flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-blue-600 transition">
            <i class="fa-solid fa-users text-xl mb-1"></i>
            <span class="text-[10px] font-bold">Kh√°ch h√†ng</span>
        </button>

        <button onclick="toggleMobileMenuModal()"
            class="mobile-nav-item flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-blue-600 transition">
            <i class="fa-solid fa-bars text-xl mb-1"></i>
            <span class="text-[10px] font-bold">Menu</span>
        </button>
    </nav>

    <style>
        .mobile-nav-item.active {
            color: #2563eb;
        }

        /* ƒê·∫©y n·ªôi dung l√™n ƒë·ªÉ kh√¥ng b·ªã thanh ƒëi·ªÅu h∆∞·ªõng che m·∫•t */
        #view-pos,
        #view-history,
        #view-customers,
        #view-inventory,
        #view-reports,
        #view-print-settings {
            padding-bottom: 80px !important;
        }

        /* ·∫®n thanh Cart Bar c≈© ƒëi v√¨ gi·ªù ƒë√£ c√≥ n√∫t Gi·ªè h√†ng to ·ªü gi·ªØa */
        #mobile-cart-bar {
            display: none !important;
        }
    </style>

    <div id="mobile-menu-modal" class="fixed inset-0 z-[60] hidden flex flex-col justify-end">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"
            onclick="toggleMobileMenuModal()"></div>
        <div class="bg-white rounded-t-3xl p-6 relative z-10 animate-fade-in pb-safe">
            <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto mb-6"></div>
            <div class="grid grid-cols-4 gap-4 text-center">

                <button onclick="switchView('inventory'); toggleMobileMenuModal()"
                    class="flex flex-col items-center gap-2 group">
                    <div
                        class="w-12 h-12 bg-blue-50 text-blue-600 rounded-2xl flex items-center justify-center text-xl group-hover:bg-blue-600 group-hover:text-white transition">
                        <i class="fa-solid fa-boxes-stacked"></i>
                    </div>
                    <span class="text-xs font-bold text-slate-600">Kho h√†ng</span>
                </button>

                <button onclick="switchView('reports'); toggleMobileMenuModal()"
                    class="flex flex-col items-center gap-2 group">
                    <div
                        class="w-12 h-12 bg-purple-50 text-purple-600 rounded-2xl flex items-center justify-center text-xl group-hover:bg-purple-600 group-hover:text-white transition">
                        <i class="fa-solid fa-chart-pie"></i>
                    </div>
                    <span class="text-xs font-bold text-slate-600">B√°o c√°o</span>
                </button>

                <button onclick="switchView('promos'); toggleMobileMenuModal()"
                    class="flex flex-col items-center gap-2 group">
                    <div
                        class="w-12 h-12 bg-orange-50 text-orange-600 rounded-2xl flex items-center justify-center text-xl group-hover:bg-orange-600 group-hover:text-white transition">
                        <i class="fa-solid fa-ticket"></i>
                    </div>
                    <span class="text-xs font-bold text-slate-600">∆Øu ƒë√£i</span>
                </button>

                <button onclick="switchView('print-settings'); toggleMobileMenuModal()"
                    class="flex flex-col items-center gap-2 group">
                    <div
                        class="w-12 h-12 bg-slate-50 text-slate-600 rounded-2xl flex items-center justify-center text-xl group-hover:bg-slate-800 group-hover:text-white transition">
                        <i class="fa-solid fa-print"></i>
                    </div>
                    <span class="text-xs font-bold text-slate-600">M√°y in</span>
                </button>

                <button onclick="toggleBranchModal(); toggleMobileMenuModal()"
                    class="flex flex-col items-center gap-2 group">
                    <div
                        class="w-12 h-12 bg-emerald-50 text-emerald-600 rounded-2xl flex items-center justify-center text-xl group-hover:bg-emerald-600 group-hover:text-white transition">
                        <i class="fa-solid fa-store"></i>
                    </div>
                    <span class="text-xs font-bold text-slate-600">Chi nh√°nh</span>
                </button>

                <button onclick="handleLogout()" class="flex flex-col items-center gap-2 group">
                    <div
                        class="w-12 h-12 bg-red-50 text-red-600 rounded-2xl flex items-center justify-center text-xl group-hover:bg-red-600 group-hover:text-white transition">
                        <i class="fa-solid fa-power-off"></i>
                    </div>
                    <span class="text-xs font-bold text-slate-600">ƒêƒÉng xu·∫•t</span>
                </button>

            </div>
        </div>
    </div>

    <!-- SCRIPT -->
    <script src="./Asset/driver.js"></script>

    <script type="module" src="./Asset/app.js"></script>
</body>

</html>