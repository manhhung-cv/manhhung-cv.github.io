<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#ffffff">
    <title>FamiBank</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.tailwindcss.com"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* --- THEME VARIABLES SYSTEM --- */
        :root {
            /* Light Mode (Default) */
            --bg-body: #F3F4F6;
            --bg-surface: #FFFFFF;
            --bg-surface-secondary: #F9FAFB;
            --bg-input: #FFFFFF;

            --text-primary: #111827;
            --text-secondary: #6B7280;
            --text-placeholder: #9CA3AF;

            --color-primary: #000000;
            /* Minimal black */
            --color-primary-fg: #FFFFFF;
            --color-accent: #2563EB;
            /* Blue */

            --border-color: #E5E7EB;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);

            --status-success: #10B981;
            --status-danger: #EF4444;
        }

        /* Dark Mode Override */
        body.dark-mode {
            --bg-body: #000000;
            --bg-surface: #121212;
            --bg-surface-secondary: #1E1E1E;
            --bg-input: #121212;

            --text-primary: #F9FAFB;
            --text-secondary: #9CA3AF;
            --text-placeholder: #4B5563;

            --color-primary: #FFFFFF;
            --color-primary-fg: #000000;
            --color-accent: #3B82F6;

            --border-color: #27272A;
            --shadow-sm: none;
            --shadow-md: none;
        }

        /* Global Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
        }

        /* Utility Mappings */
        .bg-surface {
            background-color: var(--bg-surface);
        }

        .bg-surface-secondary {
            background-color: var(--bg-surface-secondary);
        }

        .text-p {
            color: var(--text-primary);
        }

        .text-s {
            color: var(--text-secondary);
        }

        .border-theme {
            border-color: var(--border-color);
        }

        /* Buttons & Inputs */
        .btn-primary {
            background-color: var(--color-primary);
            color: var(--color-primary-fg);
            transition: opacity 0.2s;
        }

        .btn-primary:active {
            opacity: 0.8;
        }

        .btn-secondary {
            background-color: var(--bg-surface-secondary);
            color: var(--text-primary);
        }

        .input-field {
            background-color: var(--bg-input);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            transition: border-color 0.2s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--color-accent);
            ring: 1px solid var(--color-accent);
        }

        /* Glass Navigation */
        .glass-nav {
            background: var(--bg-surface);
            border-top: 1px solid var(--border-color);
            padding-bottom: env(safe-area-inset-bottom);
        }

        body.dark-mode .glass-nav {
            background: rgba(18, 18, 18, 0.95);
            backdrop-filter: blur(12px);
        }

        .nav-btn {
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .nav-btn.active {
            color: var(--text-primary);
        }

        .nav-btn.active i {
            transform: scale(1.1);
        }

        /* Scrollbar Hiding */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Views & Tabs */
        .view-section {
            display: none;
            width: 100%;
            height: 100%;
        }

        .view-section.active {
            display: flex;
        }

        .app-tab {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .app-tab.active {
            display: block;
        }

        /* Recipient List (Horizontal Scroll) */
        .recipient-list {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding: 5px 0 15px 0;
            scroll-behavior: smooth;
        }

        .recipient-item {
            flex: 0 0 auto;
            width: 70px;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            opacity: 0.6;
            transition: all 0.2s;
        }

        .recipient-item.selected {
            opacity: 1;
            transform: scale(1.05);
        }

        .recipient-item.selected .avatar-circle {
            border: 2px solid var(--color-accent);
            box-shadow: 0 0 0 2px var(--bg-surface);
        }

        .avatar-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--bg-surface-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            border: 2px solid transparent;
        }

        /* Admin Cards */
        .admin-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: var(--shadow-sm);
        }

        /* PIN Dots */
        .pin-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 1px solid var(--text-secondary);
            transition: all 0.2s;
        }

        .pin-dot.active {
            background-color: var(--text-primary);
            border-color: var(--text-primary);
        }

        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--bg-surface-secondary);
            border-top-color: var(--color-primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .animate-scale-in {
            animation: scaleIn 0.2s ease-out;
        }
    </style>
</head>

<body>
    <div id="app-container"
        class="max-w-md mx-auto min-h-screen relative flex flex-col shadow-2xl overflow-hidden bg-surface">

        <div id="loading-overlay"
            class="fixed inset-0 z-[60] flex items-center justify-center bg-black/50 backdrop-blur-sm hidden">
            <div class="spinner"></div>
        </div>

        <div id="toast-notification"
            class="fixed top-6 left-1/2 -translate-x-1/2 z-[60] px-6 py-3 rounded-full shadow-lg opacity-0 transition-opacity duration-300 pointer-events-none bg-surface border-2 border-theme flex items-center gap-2">
            <i class="fas fa-info-circle text-s"></i>
            <p id="toast-message" class="text-sm font-bold text-p"></p>
        </div>

        <div id="login-view" class="view-section flex-col h-screen p-8 justify-center bg-surface">
            <div class="absolute top-6 right-6 flex gap-2">
                <button data-lang="vi"
                    class="lang-btn text-xs font-bold p-2 rounded hover:bg-surface-secondary transition">VI</button>
                <button data-lang="en"
                    class="lang-btn text-xs font-bold p-2 rounded hover:bg-surface-secondary transition text-s">EN</button>
            </div>

            <div class="mb-10 text-center">
                <div
                    class="w-16 h-16 bg-surface-secondary rounded-2xl mx-auto flex items-center justify-center mb-4 shadow-sm">
                    <i class="fas fa-wallet text-3xl text-p"></i>
                </div>
                <h1 class="text-3xl font-bold tracking-tight text-p">FamiBank</h1>
                <p class="text-s mt-2" data-translate-key="loginSlogan">T√†i ch√≠nh cho gia ƒë√¨nh</p>
            </div>

            <div class="space-y-4 w-full">
                <input id="login-email" type="email" class="input-field w-full p-4 rounded-xl text-sm"
                    data-translate-key-placeholder="emailPlaceholder" placeholder="Email">
                <input id="login-password" type="password" class="input-field w-full p-4 rounded-xl text-sm"
                    data-translate-key-placeholder="passwordPlaceholder" placeholder="Password">
                <button id="login-btn" class="btn-primary w-full p-4 rounded-xl font-bold text-sm shadow-md"
                    data-translate-key="signIn">ƒêƒÉng Nh·∫≠p</button>
            </div>

            <div class="mt-8 text-center">
                <p class="text-sm text-s">
                    <span data-translate-key="noAccount">Ch∆∞a c√≥ t√†i kho·∫£n?</span>
                    <button id="show-register-btn" class="font-bold text-p hover:underline ml-1"
                        data-translate-key="registerNow">ƒêƒÉng k√Ω</button>
                </p>
            </div>
        </div>

        <div id="register-view" class="view-section flex-col min-h-screen p-8 justify-center bg-surface relative">
            <button id="back-to-login-btn"
                class="absolute top-6 left-6 w-10 h-10 flex items-center justify-center rounded-full bg-surface-secondary text-p">
                <i class="fas fa-arrow-left"></i>
            </button>

            <div class="mb-8 mt-4">
                <h1 class="text-2xl font-bold text-p" data-translate-key="getStarted">T·∫°o t√†i kho·∫£n</h1>
                <p class="text-s mt-1" data-translate-key="createAccountPrompt">Nh·∫≠p th√¥ng tin c·ªßa b·∫°n</p>
            </div>

            <div class="space-y-3 w-full">
                <input id="reg-name" type="text" class="input-field w-full p-4 rounded-xl text-sm"
                    data-translate-key-placeholder="fullNamePlaceholder" placeholder="H·ªç t√™n">
                <input id="reg-username" type="text" class="input-field w-full p-4 rounded-xl text-sm"
                    data-translate-key-placeholder="usernamePlaceholder" placeholder="Username">
                <input id="reg-account-number" type="number" class="input-field w-full p-4 rounded-xl text-sm"
                    data-translate-key-placeholder="accountNumberPlaceholder" placeholder="S·ªë t√†i kho·∫£n">
                <input id="reg-email" type="email" class="input-field w-full p-4 rounded-xl text-sm"
                    data-translate-key-placeholder="emailPlaceholder" placeholder="Email">
                <input id="reg-password" type="password" class="input-field w-full p-4 rounded-xl text-sm"
                    data-translate-key-placeholder="passwordPlaceholder" placeholder="M·∫≠t kh·∫©u">
                <input id="reg-pin" type="password" inputmode="numeric" maxlength="6"
                    class="input-field w-full p-4 rounded-xl text-sm" data-translate-key-placeholder="pinPlaceholder"
                    placeholder="PIN 6 s·ªë">

                <button id="register-btn" class="btn-primary w-full p-4 rounded-xl font-bold text-sm mt-4 shadow-md"
                    data-translate-key="createAccount">ƒêƒÉng K√Ω</button>
            </div>
        </div>

        <div id="app-view" class="view-section flex-col h-screen overflow-hidden">

            <main class="flex-grow overflow-y-auto pb-24 p-5 no-scrollbar">

                <div id="home-tab" class="app-tab active">
                    <div class="flex justify-between items-center mb-6">
                        <div class="flex items-center gap-3">
                            <div id="user-avatar"
                                class="w-10 h-10 rounded-full bg-surface-secondary flex items-center justify-center font-bold text-sm text-p border border-theme shadow-sm">
                            </div>
                            <div>
                                <p class="text-xs text-s" data-translate-key="welcome">Xin ch√†o,</p>
                                <h2 id="user-display-name" class="text-sm font-bold text-p">...</h2>
                            </div>
                        </div>
                        <button
                            class="w-10 h-10 flex items-center justify-center rounded-full bg-surface-secondary text-p">
                            <i class="fas fa-bell"></i>
                        </button>
                    </div>

                    <div
                        class="p-5 rounded-2xl bg-gradient-to-br from-[#1a1a1a] to-black border border-[#333] mb-6 relative overflow-hidden shadow-lg select-none">

                        <div
                            class="absolute top-0 right-0 w-24 h-24 bg-white/5 rounded-full blur-2xl -mr-10 -mt-10 pointer-events-none">
                        </div>
                        <div
                            class="absolute bottom-0 left-0 w-20 h-20 bg-blue-500/10 rounded-full blur-2xl -ml-10 -mb-10 pointer-events-none">
                        </div>

                        <div class="relative z-10 flex flex-col items-center justify-center text-center">
                            <div class="flex items-center gap-2 mb-1 opacity-60">
                                <p class="text-[11px] font-medium uppercase tracking-widest"
                                    data-translate-key="totalBalance">T·ªïng s·ªë d∆∞</p>
                                <button id="balance-visibility-btn"
                                    class="w-5 h-5 flex items-center justify-center hover:text-white transition">
                                    <i class="fas fa-eye text-xs"></i>
                                </button>
                            </div>

                            <h1 id="user-balance" class="text-3xl font-bold text-white tracking-tight mb-4">0 ‚Ç´</h1>

                            <div id="copy-account-box"
                                class="group flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/10 border border-white/5 hover:bg-white/20 hover:border-white/20 transition-all cursor-pointer active:scale-95">
                                <i
                                    class="fas fa-user text-[10px] text-gray-500 group-hover:text-white transition-colors ml-1"></i>
                                <span id="user-account-number"
                                    class="text-sm font-mono font-bold text-gray-200 group-hover:text-white tracking-wider">...</span>

                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-3 gap-4 mb-8">
                        <button data-action="transfer"
                            class="action-btn flex flex-col items-center gap-2 p-4 rounded-2xl bg-surface-secondary hover:bg-gray-200 dark:hover:bg-gray-800 transition shadow-sm border border-theme active:scale-95">
                            <div
                                class="w-12 h-12 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mb-1 shadow-sm">
                                <i class="fas fa-paper-plane text-lg"></i>
                            </div>
                            <span class="text-xs font-bold text-p" data-translate-key="transfer">Chuy·ªÉn</span>
                        </button>
                        <button data-action="deposit"
                            class="action-btn flex flex-col items-center gap-2 p-4 rounded-2xl bg-surface-secondary hover:bg-gray-200 dark:hover:bg-gray-800 transition shadow-sm border border-theme active:scale-95">
                            <div
                                class="w-12 h-12 rounded-full bg-green-100 text-green-600 flex items-center justify-center mb-1 shadow-sm">
                                <i class="fas fa-arrow-down text-lg"></i>
                            </div>
                            <span class="text-xs font-bold text-p" data-translate-key="deposit">N·∫°p</span>
                        </button>
                        <button data-action="withdraw"
                            class="action-btn flex flex-col items-center gap-2 p-4 rounded-2xl bg-surface-secondary hover:bg-gray-200 dark:hover:bg-gray-800 transition shadow-sm border border-theme active:scale-95">
                            <div
                                class="w-12 h-12 rounded-full bg-orange-100 text-orange-600 flex items-center justify-center mb-1 shadow-sm">
                                <i class="fas fa-arrow-up text-lg"></i>
                            </div>
                            <span class="text-xs font-bold text-p" data-translate-key="withdraw">R√∫t</span>
                        </button>
                    </div>

                    <div>
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-bold text-p text-sm" data-translate-key="recentTransactions">Giao d·ªãch g·∫ßn
                                ƒë√¢y</h3>
                            <button onclick="document.querySelector('[data-tab=\'history-tab\']').click()"
                                class="text-xs text-accent font-bold hover:underline">Xem t·∫•t c·∫£</button>
                        </div>
                        <div id="recent-transaction-history" class="space-y-3 pb-4">
                            <div class="text-center py-6">
                                <div class="spinner w-6 h-6 mx-auto border-2 border-t-accent"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="missions-tab" class="app-tab">
                    <h1 class="text-xl font-bold text-p mb-4">Nhi·ªám v·ª• ki·∫øm ti·ªÅn</h1>
                    <div id="missions-list" class="space-y-4"></div>
                </div>

                <div id="gifts-tab" class="app-tab">
                    <h1 class="text-xl font-bold text-p mb-4">C·ª≠a h√†ng qu√† t·∫∑ng</h1>
                    <div id="gifts-list" class="grid grid-cols-2 gap-4"></div>
                </div>

                <div id="history-tab" class="app-tab">
                    <h1 class="text-xl font-bold text-p mb-4" data-translate-key="history">L·ªãch s·ª≠ ho·∫°t ƒë·ªông</h1>

                    <div
                        class="flex bg-surface-secondary p-1 rounded-xl mb-6 overflow-x-auto no-scrollbar border border-theme">
                        <button data-history-type="transactions"
                            class="history-sub-tab-btn flex-1 py-2 px-3 text-xs font-bold rounded-lg transition-colors active bg-surface shadow-sm text-p">Giao
                            d·ªãch</button>
                        <button data-history-type="gifts"
                            class="history-sub-tab-btn flex-1 py-2 px-3 text-xs font-bold rounded-lg text-s hover:text-p">Qu√†</button>
                        <button data-history-type="missions"
                            class="history-sub-tab-btn flex-1 py-2 px-3 text-xs font-bold rounded-lg text-s hover:text-p">Nhi·ªám
                            v·ª•</button>
                        <button data-history-type="gift-approvals"
                            class="history-sub-tab-btn flex-1 py-2 px-3 text-xs font-bold rounded-lg text-s hover:text-p">Duy·ªát
                            qu√†</button>
                    </div>

                    <div id="history-content-transactions" class="history-content space-y-3"></div>
                    <div id="history-content-gifts" class="history-content hidden space-y-3"></div>
                    <div id="history-content-missions" class="history-content hidden space-y-3"></div>
                    <div id="history-content-gift-approvals" class="history-content hidden space-y-3"></div>
                </div>

                <div id="settings-tab" class="app-tab">
                    <h1 class="text-xl font-bold text-p mb-6" data-translate-key="settings">C√†i ƒë·∫∑t</h1>

                    <div class="space-y-6">
                        <div class="bg-surface-secondary p-4 rounded-xl border border-theme">
                            <p class="text-xs font-bold text-s mb-3 uppercase" data-translate-key="theme">Giao di·ªán</p>
                            <div class="grid grid-cols-3 gap-2">
                                <button
                                    class="theme-btn w-full py-2 rounded-lg border border-theme bg-surface text-xs font-medium flex flex-col items-center gap-1 transition active"
                                    data-theme="system">
                                    <i class="fas fa-mobile-alt"></i> Auto
                                </button>
                                <button
                                    class="theme-btn w-full py-2 rounded-lg border border-theme bg-surface text-xs font-medium flex flex-col items-center gap-1 transition"
                                    data-theme="light">
                                    <i class="fas fa-sun"></i> S√°ng
                                </button>
                                <button
                                    class="theme-btn w-full py-2 rounded-lg border border-theme bg-surface text-xs font-medium flex flex-col items-center gap-1 transition"
                                    data-theme="dark">
                                    <i class="fas fa-moon"></i> T·ªëi
                                </button>
                            </div>
                        </div>
                        <div class="bg-surface-secondary p-4 rounded-xl border border-theme">
                            <p class="text-xs font-bold text-s mb-4 uppercase" data-translate-key="profile">Th√¥ng tin c√°
                                nh√¢n</p>

                            <div class="flex flex-col items-center mb-6">

                                <div class="relative group">
                                    <div id="settings-avatar-preview"
                                        class="w-24 h-24 rounded-full flex items-center justify-center text-5xl shadow-md border-4 border-white dark:border-gray-800 transition-colors duration-300"
                                        style="background-color: #e5e7eb;">
                                        üë§
                                    </div>
                                    <div
                                        class="absolute bottom-2 right-0 bg-white dark:bg-gray-800 text-p w-8 h-8 rounded-full flex items-center justify-center shadow-sm border border-theme">
                                        <i class="fas fa-camera text-xs"></i>
                                    </div>
                                </div>

                                <p class="text-xs text-s mt-4 mb-2 font-medium">1. Ch·ªçn Emoji</p>

                                <div class="flex flex-wrap justify-center gap-2 mb-2 max-w-[280px]">
                                    <button
                                        class="emoji-opt w-10 h-10 text-2xl rounded-lg hover:bg-black/5 dark:hover:bg-white/10 transition"
                                        onclick="selectEmoji('üë®‚Äçüíª')">üë®‚Äçüíª</button>
                                    <button
                                        class="emoji-opt w-10 h-10 text-2xl rounded-lg hover:bg-black/5 dark:hover:bg-white/10 transition"
                                        onclick="selectEmoji('üë©‚Äçüíº')">üë©‚Äçüíº</button>
                                    <button
                                        class="emoji-opt w-10 h-10 text-2xl rounded-lg hover:bg-black/5 dark:hover:bg-white/10 transition"
                                        onclick="selectEmoji('üêØ')">üêØ</button>
                                    <button
                                        class="emoji-opt w-10 h-10 text-2xl rounded-lg hover:bg-black/5 dark:hover:bg-white/10 transition"
                                        onclick="selectEmoji('üê±')">üê±</button>
                                    <button
                                        class="emoji-opt w-10 h-10 text-2xl rounded-lg hover:bg-black/5 dark:hover:bg-white/10 transition"
                                        onclick="selectEmoji('üöÄ')">üöÄ</button>
                                    <button
                                        class="emoji-opt w-10 h-10 text-2xl rounded-lg hover:bg-black/5 dark:hover:bg-white/10 transition"
                                        onclick="selectEmoji('üí∞')">üí∞</button>
                                </div>
                                <input id="custom-emoji-input" type="text" maxlength="2"
                                    class="input-field w-32 p-1 text-center rounded-lg text-lg mb-4"
                                    placeholder="Emoji kh√°c...">

                                <p class="text-xs text-s mb-2 font-medium">2. Ch·ªçn m√†u n·ªÅn</p>

                                <div class="flex justify-center gap-3 mb-6">
                                    <button
                                        class="w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition shadow-sm"
                                        style="background-color: #F87171;" onclick="selectColor('#F87171')"></button>
                                    <button
                                        class="w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition shadow-sm"
                                        style="background-color: #FBBF24;" onclick="selectColor('#FBBF24')"></button>
                                    <button
                                        class="w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition shadow-sm"
                                        style="background-color: #34D399;" onclick="selectColor('#34D399')"></button>
                                    <button
                                        class="w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition shadow-sm"
                                        style="background-color: #60A5FA;" onclick="selectColor('#60A5FA')"></button>
                                    <button
                                        class="w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition shadow-sm"
                                        style="background-color: #111111;" onclick="selectColor('#111111')"></button>
                                    <button
                                        class="w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition shadow-sm"
                                        style="background-color: #F472B6;" onclick="selectColor('#F472B6')"></button>
                                    <button
                                        class="w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition shadow-sm"
                                        style="background-color: #9CA3AF;" onclick="selectColor('#9CA3AF')"></button>
                                </div>

                                <div class="w-full">
                                    <label class="text-xs text-s mb-1 ml-1">T√™n hi·ªÉn th·ªã</label>
                                    <div class="flex gap-2">
                                        <input id="update-name-input" type="text"
                                            class="input-field flex-grow p-3 rounded-lg text-sm font-medium"
                                            placeholder="Nh·∫≠p t√™n...">
                                        <button id="update-name-btn"
                                            class="btn-primary px-6 rounded-lg text-sm font-bold shadow-lg shadow-blue-500/30">L∆∞u</button>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="bg-surface-secondary p-4 rounded-xl border border-theme">
                            <p class="text-xs font-bold text-s mb-3 uppercase" data-translate-key="security">B·∫£o m·∫≠t</p>
                            <button id="show-change-pin-modal-btn"
                                class="w-full flex justify-between items-center p-3 bg-surface rounded-lg border border-theme transition hover:bg-gray-50 dark:hover:bg-gray-800">
                                <span class="text-sm font-medium" data-translate-key="changePin">ƒê·ªïi m√£ PIN</span>
                                <i class="fas fa-chevron-right text-xs text-s"></i>
                            </button>
                        </div>

                        <button id="logout-btn"
                            class="w-full p-4 rounded-xl bg-red-50 text-red-600 dark:bg-red-900/20 dark:text-red-400 font-bold text-sm flex justify-center items-center gap-2 border border-red-100 dark:border-red-900/30">
                            <i class="fas fa-sign-out-alt"></i> <span data-translate-key="logout">ƒêƒÉng xu·∫•t</span>
                        </button>
                    </div>
                </div>

                <div id="admin-tab" class="app-tab">
                    <h1 class="text-xl font-bold text-p mb-4" data-translate-key="adminPanel">Admin Control</h1>

                    <div class="flex gap-2 overflow-x-auto no-scrollbar pb-2 mb-4">
                        <button data-admin-tab="overview"
                            class="admin-tab-btn px-4 py-2 rounded-full border border-theme text-xs font-bold whitespace-nowrap active bg-surface-secondary text-p">T·ªïng
                            quan</button>
                        <button data-admin-tab="withdrawals"
                            class="admin-tab-btn px-4 py-2 rounded-full border border-theme text-xs font-bold whitespace-nowrap text-s">R√∫t
                            ti·ªÅn</button>
                        <button data-admin-tab="giftRequests"
                            class="admin-tab-btn px-4 py-2 rounded-full border border-theme text-xs font-bold whitespace-nowrap text-s">Duy·ªát
                            qu√†</button>
                        <button data-admin-tab="users"
                            class="admin-tab-btn px-4 py-2 rounded-full border border-theme text-xs font-bold whitespace-nowrap text-s">Users</button>
                        <button data-admin-tab="codes"
                            class="admin-tab-btn px-4 py-2 rounded-full border border-theme text-xs font-bold whitespace-nowrap text-s">M√£
                            n·∫°p</button>
                        <button data-admin-tab="gifts"
                            class="admin-tab-btn px-4 py-2 rounded-full border border-theme text-xs font-bold whitespace-nowrap text-s">Kho
                            Qu√†</button>
                        <button data-admin-tab="missions"
                            class="admin-tab-btn px-4 py-2 rounded-full border border-theme text-xs font-bold whitespace-nowrap text-s">Kho
                            NV</button>
                    </div>

                    <div id="admin-tab-content">
                        <div id="admin-tab-overview" class="admin-tab-pane">
                            <div class="grid grid-cols-2 gap-3">
                                <div class="admin-card text-center">
                                    <p class="text-xs text-s mb-1">R√∫t ti·ªÅn ch·ªù</p>
                                    <p id="admin-pending-withdrawals" class="text-2xl font-bold text-accent">0</p>
                                </div>
                                <div class="admin-card text-center">
                                    <p class="text-xs text-s mb-1">Duy·ªát qu√† ch·ªù</p>
                                    <p id="admin-pending-gifts" class="text-2xl font-bold text-p">0</p>
                                </div>
                                <div class="admin-card text-center">
                                    <p class="text-xs text-s mb-1">Duy·ªát NV ch·ªù</p>
                                    <p id="admin-pending-missions" class="text-2xl font-bold text-p">0</p>
                                </div>
                                <div class="admin-card text-center">
                                    <p class="text-xs text-s mb-1">T·ªïng User</p>
                                    <p id="admin-total-users" class="text-2xl font-bold text-p">0</p>
                                </div>
                            </div>
                        </div>

                        <div id="admin-tab-withdrawals" class="admin-tab-pane hidden space-y-4">
                            <div id="withdrawal-requests"></div>
                        </div>
                        <div id="admin-tab-giftRequests" class="admin-tab-pane hidden space-y-4">
                            <div id="gift-requests-list"></div>
                        </div>
                        <div id="admin-tab-users" class="admin-tab-pane hidden space-y-4">
                            <div id="admin-user-list"></div>
                        </div>

                        <div id="admin-tab-codes" class="admin-tab-pane hidden">
                            <button id="show-create-code-modal-btn"
                                class="btn-primary w-full py-3 rounded-xl text-sm font-bold mb-4">T·∫°o m√£ n·∫°p
                                m·ªõi</button>
                            <div id="deposit-codes-list" class="space-y-3"></div>
                            <div class="mt-6 border-t border-theme pt-4">
                                <h3 class="text-sm font-bold mb-3 text-s">ƒê√£ s·ª≠ d·ª•ng</h3>
                                <div id="used-deposit-codes-list" class="space-y-3"></div>
                            </div>
                        </div>

                        <div id="admin-tab-gifts" class="admin-tab-pane hidden">
                            <button id="show-create-gift-modal-btn"
                                class="btn-primary w-full py-3 rounded-xl text-sm font-bold mb-4">Th√™m qu√† m·ªõi</button>
                            <div id="admin-gifts-list" class="space-y-3"></div>
                        </div>

                        <div id="admin-tab-missions" class="admin-tab-pane hidden">
                            <button id="show-create-mission-modal-btn"
                                class="btn-primary w-full py-3 rounded-xl text-sm font-bold mb-4">Th√™m nhi·ªám v·ª•
                                m·ªõi</button>
                            <div id="admin-missions-list" class="space-y-3"></div>
                        </div>
                    </div>
                </div>

            </main>

            <footer id="bottom-nav" class="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-md glass-nav z-40">
                <div class="flex justify-around items-center p-2">
                    <button data-tab="home-tab" class="nav-btn active flex-1 p-3 flex flex-col items-center gap-1"><i
                            class="fas fa-home text-lg"></i></button>
                    <button data-tab="missions-tab" class="nav-btn flex-1 p-3 flex flex-col items-center gap-1"><i
                            class="fas fa-tasks text-lg"></i></button>
                    <button data-tab="gifts-tab" class="nav-btn flex-1 p-3 flex flex-col items-center gap-1"><i
                            class="fas fa-gift text-lg"></i></button>
                    <button data-tab="history-tab" class="nav-btn flex-1 p-3 flex flex-col items-center gap-1"><i
                            class="fas fa-clock text-lg"></i></button>
                    <button data-tab="settings-tab" class="nav-btn flex-1 p-3 flex flex-col items-center gap-1"><i
                            class="fas fa-cog text-lg"></i></button>
                    <button data-tab="admin-tab" id="admin-nav-btn"
                        class="nav-btn hidden flex-1 p-3 flex flex-col items-center gap-1 text-red-500"><i
                            class="fas fa-shield-alt text-lg"></i></button>
                </div>
            </footer>
        </div>
    </div>

    <div id="transfer-modal"
        class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm hidden p-4">
        <div class="bg-surface w-full max-w-sm rounded-2xl shadow-2xl overflow-hidden animate-scale-in">
            <div class="p-5">
                <h3 class="text-lg font-bold text-p mb-4" data-translate-key="transferFunds">Chuy·ªÉn ti·ªÅn</h3>

                <p class="text-xs text-s mb-2 font-bold uppercase tracking-wider">Ch·ªçn ng∆∞·ªùi nh·∫≠n</p>
                <div id="recipient-list-container" class="recipient-list no-scrollbar mb-4">
                    <div class="text-xs text-s italic">ƒêang t·∫£i...</div>
                </div>
                <input type="hidden" id="selected-recipient-id">

                <div class="space-y-4">
                    <div>
                        <label class="text-xs text-s mb-1 block">S·ªë ti·ªÅn</label>
                        <input id="transfer-amount" type="text" inputmode="numeric"
                            class="currency-input input-field w-full p-3 rounded-lg text-lg font-bold tracking-wide"
                            placeholder="0">
                    </div>
                    <div>
                        <label class="text-xs text-s mb-1 block">N·ªôi dung</label>
                        <input id="transfer-content" type="text" class="input-field w-full p-3 rounded-lg text-sm"
                            placeholder="Nh·∫≠p n·ªôi dung...">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-3 mt-6">
                    <button
                        class="modal-close-btn py-3 rounded-xl bg-surface-secondary text-p font-medium text-sm transition hover:bg-gray-200">H·ªßy</button>
                    <button id="confirm-transfer-btn"
                        class="py-3 rounded-xl btn-primary font-bold text-sm shadow-md">Chuy·ªÉn</button>
                </div>
            </div>
        </div>
    </div>

    <div id="deposit-modal"
        class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm hidden p-4">
        <div class="bg-surface w-full max-w-sm rounded-2xl shadow-2xl p-5 animate-scale-in">
            <h3 class="text-lg font-bold text-p mb-4">N·∫°p ti·ªÅn</h3>
            <input id="deposit-code" type="text" class="input-field w-full p-3 rounded-lg text-sm font-mono uppercase"
                placeholder="Nh·∫≠p m√£ code (VD: NAP100)">
            <div class="grid grid-cols-2 gap-3 mt-6">
                <button
                    class="modal-close-btn py-3 rounded-xl bg-surface-secondary text-p font-medium text-sm">H·ªßy</button>
                <button id="confirm-deposit-btn" class="py-3 rounded-xl btn-primary font-bold text-sm">N·∫°p</button>
            </div>
        </div>
    </div>

    <div id="withdraw-modal"
        class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm hidden p-4">
        <div class="bg-surface w-full max-w-sm rounded-2xl shadow-2xl p-5 animate-scale-in">
            <h3 class="text-lg font-bold text-p mb-4">R√∫t ti·ªÅn</h3>
            <div class="space-y-3">
                <input id="withdraw-amount" type="text" inputmode="numeric"
                    class="currency-input input-field w-full p-3 rounded-lg text-sm" placeholder="S·ªë ti·ªÅn mu·ªën r√∫t">
                <input id="withdraw-reason" type="text" class="input-field w-full p-3 rounded-lg text-sm"
                    placeholder="L√Ω do/Ghi ch√∫">
            </div>
            <div class="grid grid-cols-2 gap-3 mt-6">
                <button
                    class="modal-close-btn py-3 rounded-xl bg-surface-secondary text-p font-medium text-sm">H·ªßy</button>
                <button id="confirm-withdraw-btn" class="py-3 rounded-xl btn-primary font-bold text-sm">G·ª≠i y√™u
                    c·∫ßu</button>
            </div>
        </div>
    </div>

    <div id="pin-modal"
        class="modal-overlay fixed inset-0 z-[70] flex flex-col justify-end bg-black/80 backdrop-blur-md hidden">
        <div class="bg-surface w-full rounded-t-3xl shadow-2xl p-6 pb-10 max-w-md mx-auto animate-slide-up">
            <div class="text-center mb-6">
                <h3 class="text-lg font-bold text-p mb-2">Nh·∫≠p m√£ PIN</h3>
                <div id="pin-dots-container" class="flex justify-center gap-4 my-4">
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                </div>
            </div>
            <div id="pin-keypad" class="grid grid-cols-3 gap-y-4 gap-x-6 max-w-xs mx-auto">
                <button data-key="1"
                    class="pin-key text-2xl font-medium py-3 rounded-full hover:bg-surface-secondary text-p transition">1</button>
                <button data-key="2"
                    class="pin-key text-2xl font-medium py-3 rounded-full hover:bg-surface-secondary text-p transition">2</button>
                <button data-key="3"
                    class="pin-key text-2xl font-medium py-3 rounded-full hover:bg-surface-secondary text-p transition">3</button>
                <button data-key="4"
                    class="pin-key text-2xl font-medium py-3 rounded-full hover:bg-surface-secondary text-p transition">4</button>
                <button data-key="5"
                    class="pin-key text-2xl font-medium py-3 rounded-full hover:bg-surface-secondary text-p transition">5</button>
                <button data-key="6"
                    class="pin-key text-2xl font-medium py-3 rounded-full hover:bg-surface-secondary text-p transition">6</button>
                <button data-key="7"
                    class="pin-key text-2xl font-medium py-3 rounded-full hover:bg-surface-secondary text-p transition">7</button>
                <button data-key="8"
                    class="pin-key text-2xl font-medium py-3 rounded-full hover:bg-surface-secondary text-p transition">8</button>
                <button data-key="9"
                    class="pin-key text-2xl font-medium py-3 rounded-full hover:bg-surface-secondary text-p transition">9</button>
                <button class="modal-close-btn text-sm font-bold text-s uppercase tracking-wider py-3">H·ªßy</button>
                <button data-key="0"
                    class="pin-key text-2xl font-medium py-3 rounded-full hover:bg-surface-secondary text-p transition">0</button>
                <button data-key="backspace"
                    class="pin-key text-xl py-3 rounded-full hover:bg-surface-secondary text-p transition"><i
                        class="fas fa-backspace"></i></button>
            </div>
        </div>
    </div>

    <div id="bill-modal"
        class="modal-overlay fixed inset-0 z-[80] flex items-center justify-center bg-black/80 backdrop-blur-sm hidden p-4">
        <div class="bg-surface w-full max-w-sm rounded-xl overflow-hidden shadow-2xl animate-scale-in">
            <div id="bill-content" class="p-6 bg-surface text-p">
                <div class="text-center border-b-2 border-dashed border-theme pb-4 mb-4">
                    <div
                        class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2 text-green-600 text-2xl">
                        <i class="fas fa-check"></i>
                    </div>
                    <h2 class="text-xl font-bold">FamiBank</h2>
                    <p class="text-xs text-s uppercase tracking-widest mt-1">Giao d·ªãch th√†nh c√¥ng</p>
                    <h1 id="bill-amount" class="text-3xl font-bold mt-4 text-green-600">0 ‚Ç´</h1>
                </div>
                <div class="space-y-3 text-sm">
                    <div class="flex justify-between"><span class="text-s">Ng∆∞·ªùi g·ª≠i</span><span id="bill-sender-name"
                            class="font-bold text-right">...</span></div>
                    <div class="flex justify-between"><span class="text-s">STK G·ª≠i</span><span id="bill-sender-acc"
                            class="font-mono text-right">...</span></div>
                    <div class="border-b border-theme my-2"></div>
                    <div class="flex justify-between"><span class="text-s">Ng∆∞·ªùi nh·∫≠n</span><span
                            id="bill-recipient-name" class="font-bold text-right">...</span></div>
                    <div class="flex justify-between"><span class="text-s">STK Nh·∫≠n</span><span id="bill-recipient-acc"
                            class="font-mono text-right">...</span></div>
                    <div class="border-b border-theme my-2"></div>
                    <div class="flex justify-between"><span class="text-s">N·ªôi dung</span><span id="bill-content-text"
                            class="font-medium text-right w-1/2 truncate">...</span></div>
                    <div class="flex justify-between"><span class="text-s">Th·ªùi gian</span><span id="bill-timestamp"
                            class="text-xs text-right">...</span></div>
                </div>
            </div>
            <div class="p-4 bg-surface-secondary flex gap-3">
                <button
                    class="modal-close-btn flex-1 py-3 bg-surface rounded-lg font-bold text-sm text-s border border-theme">ƒê√≥ng</button>
                <button id="save-bill-btn" class="flex-1 py-3 btn-primary rounded-lg font-bold text-sm"><i
                        class="fas fa-download mr-1"></i> L∆∞u ·∫£nh</button>
            </div>
        </div>
    </div>

    <div id="create-code-modal"
        class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black/60 hidden p-4">
        <div class="bg-surface w-full max-w-sm rounded-2xl p-5">
            <h3 class="font-bold mb-4 text-p">T·∫°o m√£ n·∫°p</h3>
            <input id="admin-deposit-code" type="text" placeholder="M√£ (VD: NAP100)"
                class="input-field w-full p-3 rounded-lg mb-3">
            <input id="admin-deposit-amount" type="text" inputmode="numeric" placeholder="S·ªë ti·ªÅn"
                class="currency-input input-field w-full p-3 rounded-lg mb-3">
            <div class="flex gap-3"><button
                    class="modal-close-btn flex-1 py-2 bg-surface-secondary rounded-lg">H·ªßy</button><button
                    id="create-deposit-code-btn" class="flex-1 py-2 btn-primary rounded-lg">T·∫°o</button></div>
        </div>
    </div>

    <div id="create-gift-modal"
        class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black/60 hidden p-4">
        <div class="bg-surface w-full max-w-sm rounded-2xl p-5">
            <h3 class="font-bold mb-4 text-p">Th√™m qu√†</h3>
            <div class="space-y-3">
                <input id="admin-gift-name" class="input-field w-full p-3 rounded-lg" placeholder="T√™n qu√†">
                <input id="admin-gift-price" type="text" inputmode="numeric"
                    class="currency-input input-field w-full p-3 rounded-lg" placeholder="Gi√°">
                <input id="admin-gift-image" class="input-field w-full p-3 rounded-lg" placeholder="URL ·∫£nh">
                <input id="admin-gift-quantity" type="number" class="input-field w-full p-3 rounded-lg"
                    placeholder="S·ªë l∆∞·ª£ng">
            </div>
            <div class="flex gap-3 mt-4"><button
                    class="modal-close-btn flex-1 py-2 bg-surface-secondary rounded-lg">H·ªßy</button><button
                    id="create-gift-btn" class="flex-1 py-2 btn-primary rounded-lg">Th√™m</button></div>
        </div>
    </div>

    <div id="create-mission-modal"
        class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black/60 hidden p-4">
        <div class="bg-surface w-full max-w-sm rounded-2xl p-5">
            <h3 class="font-bold mb-4 text-p">Th√™m nhi·ªám v·ª•</h3>
            <div class="space-y-3 max-h-[60vh] overflow-y-auto no-scrollbar">
                <input id="admin-mission-name" class="input-field w-full p-3 rounded-lg" placeholder="T√™n NV">
                <input id="admin-mission-reward" type="text" inputmode="numeric"
                    class="currency-input input-field w-full p-3 rounded-lg" placeholder="Th∆∞·ªüng">
                <select id="admin-mission-repeat" class="input-field w-full p-3 rounded-lg bg-surface">
                    <option value="none">Kh√¥ng l·∫∑p</option>
                    <option value="daily">H√†ng ng√†y</option>
                    <option value="weekly">H√†ng tu·∫ßn</option>
                </select>
                <input id="admin-mission-deadline" type="date" class="input-field w-full p-3 rounded-lg">
                <textarea id="admin-mission-description" class="input-field w-full p-3 rounded-lg"
                    placeholder="M√¥ t·∫£"></textarea>
                <input id="admin-mission-limit" type="number" class="input-field w-full p-3 rounded-lg"
                    placeholder="Gi·ªõi h·∫°n ng∆∞·ªùi">
            </div>
            <div class="flex gap-3 mt-4"><button
                    class="modal-close-btn flex-1 py-2 bg-surface-secondary rounded-lg">H·ªßy</button><button
                    id="create-mission-btn" class="flex-1 py-2 btn-primary rounded-lg">T·∫°o</button></div>
        </div>
    </div>

    <div id="review-withdrawal-modal"
        class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black/60 hidden p-4">
        <div class="bg-surface w-full max-w-sm rounded-2xl p-5 shadow-2xl">
            <h3 class="font-bold mb-4 text-p">Duy·ªát r√∫t ti·ªÅn</h3>
            <div class="bg-surface-secondary p-3 rounded-lg mb-4 text-sm space-y-1 border border-theme">
                <p>User: <strong id="review-user-name"></strong></p>
                <p>STK: <strong id="review-user-acc"></strong></p>
                <p>Y√™u c·∫ßu: <strong id="review-requested-amount" class="text-accent"></strong></p>
                <p class="text-s italic">"<span id="review-user-reason"></span>"</p>
            </div>
            <input id="review-approval-amount" type="text" inputmode="numeric"
                class="currency-input input-field w-full p-3 rounded-lg mb-3" placeholder="S·ªë ti·ªÅn duy·ªát">
            <div class="flex gap-3 mt-4">
                <button id="confirm-reject-btn"
                    class="flex-1 py-3 bg-red-100 text-red-600 rounded-lg font-bold text-sm">T·ª´ ch·ªëi</button>
                <button id="confirm-approve-btn"
                    class="flex-1 py-3 btn-primary rounded-lg font-bold text-sm">Duy·ªát</button>
            </div>
            <button class="modal-close-btn w-full mt-3 text-sm text-s py-2">ƒê√≥ng</button>
        </div>
    </div>

    <div id="change-pin-modal"
        class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black/60 hidden p-4">
        <div class="bg-surface w-full max-w-sm rounded-2xl p-5">
            <h3 class="font-bold mb-4 text-p">ƒê·ªïi PIN</h3>
            <div class="space-y-3">
                <input id="current-pin" type="password" maxlength="6" inputmode="numeric"
                    class="input-field w-full p-3 rounded-lg" placeholder="PIN hi·ªán t·∫°i">
                <input id="new-pin" type="password" maxlength="6" inputmode="numeric"
                    class="input-field w-full p-3 rounded-lg" placeholder="PIN m·ªõi">
                <input id="confirm-new-pin" type="password" maxlength="6" inputmode="numeric"
                    class="input-field w-full p-3 rounded-lg" placeholder="X√°c nh·∫≠n PIN m·ªõi">
            </div>
            <div class="flex gap-3 mt-4">
                <button class="modal-close-btn flex-1 py-2 bg-surface-secondary rounded-lg">H·ªßy</button>
                <button id="confirm-pin-change-btn" class="flex-1 py-2 btn-primary rounded-lg">L∆∞u</button>
            </div>
        </div>
    </div>

    <script type="module" src="app.js"></script>
</body>

</html>