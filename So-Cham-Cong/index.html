<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sổ Chấm Công</title>
    <link rel="stylesheet" href="./style.css">
    <script src="https://kit.fontawesome.com/9392097706.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&display=swap" rel="stylesheet">

    <!-- Đảm bảo đặt meta tag sau -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <meta name="apple-mobile-web-app-capable" content="yes">

    <!-- Biểu tượng cho web -->
    <link rel="icon" href="logo.png" />

    <!-- Biểu tượng iPhone -->
    <link rel="apple-touch-icon" href="logo.png" sizes="150x150" />

    <!-- Ảnh -->
    <meta property="og:image" content="/Asset/img/Banner.png" />
    <meta property="og:title" content="Sổ chấm công" />
    <meta property="og:description" content="Thiết kế và lập trình Đinh Mạnh Hùng" />

</head>

<body class="platform-mobile">
    <div id="appShell" class="app-shell">
        <nav class="bottom-nav">
            <button class="nav-button active" data-tab="tabLichLamViec" data-title="Lịch Làm Việc"><span class="icon"><i
                        class="fas fa-calendar-alt"></i></span><span class="label">Lịch</span></button>
            <button class="nav-button" data-tab="tabSoChamCong" data-title="Sổ Chấm Công"><span class="icon"><i
                        class="fas fa-clipboard-list"></i></span><span class="label">Sổ Công</span></button>
            <button class="nav-button" data-tab="tabMayTinh" data-title="Máy tính"><span class="icon"><i
                        class="fas fa-calculator"></i></span><span class="label">Máy tính</span></button>
            <button class="nav-button" data-tab="tabThongTin" data-title="Thông tin"><span class="icon"><i
                        class="fas fa-info-circle"></i></span><span class="label">Thông tin</span></button>
            <button class="nav-button" data-tab="tabCaiDat" data-title="Cài Đặt"><span class="icon"><i
                        class="fas fa-cog"></i></span><span class="label">Cài Đặt</span></button>

        </nav>


        <div class="app-content-wrapper">
            <header class="app-header">
                <h1 id="headerTitle">Lịch Làm Việc</h1>
            </header>
            <main class="app-content">
                <h1 id="appTitle">Lịch Làm Việc</h1>
                <div id="tabLichLamViec" class="tab-content active">

                    <div class="card">
                        <div class="flex">

                            <div class="calendar-controls-header">
                                <button id="prevMonthBtn" class="btn-icon" aria-label="Tháng trước"><i
                                        class="fas fa-chevron-left"></i></button>
                                <h2 id="currentMonthYear">...</h2>
                                <button id="nextMonthBtn" class="btn-icon" aria-label="Tháng sau"><i
                                        class="fas fa-chevron-right"></i></button>
                            </div>
                            <div class="form-group">
                                <button id="toggleFirstDayBtn" class="btn btn-secondary btn-full-width"><span
                                        id="firstDayLabel">T2</span></button>
                            </div>
                            <div id="editScheduleBtnContainer">
                                <button id="editScheduleBtn" class="btn btn-secondary btn-full-width"><i
                                        class="fas fa-edit"></i></button>
                                <button id="saveScheduleBtn" class="btn btn-primary btn-full-width"
                                    style="display:none;"><i class="fas fa-check"></i></button>
                            </div>
                        </div>

                        <div id="monthYearPickerModal" class="modal">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h3>Chọn Tháng & Năm</h3>
                                </div>
                                <div class="modal-body">
                                    <div class="form-group">
                                        <label for="selectMonth">Tháng:</label>
                                        <select id="selectMonth"></select>
                                    </div>
                                    <div class="form-group">
                                        <label for="selectYear">Năm:</label>
                                        <select id="selectYear"></select>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-cancel">Hủy</button>
                                    <button type="button" class="btn btn-confirm-month-year btn-primary">Xác
                                        nhận</button>
                                </div>
                            </div>
                        </div>

                        <div id="quickEditControls" style="display:none;">
                            <div class="card">
                                <h3 class="card-header">Sửa Lịch Nhanh</h3>
                                <div class="form-group">
                                    <label for="quickEditType">Chọn loại ca:</label>
                                    <select id="quickEditType">
                                        <option value="">Xoá lịch</option>
                                        <option value="ca-ngay">Ca sáng</option>
                                        <option value="ca-dem">Ca tối</option>
                                        <option value="nghi">Nghỉ</option>
                                        <option value="ngay-le">Ngày lễ</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="quickEditMode">Chế độ chọn:</label>
                                    <select id="quickEditMode">
                                        <option value="range">Chọn khoảng ngày</option>
                                        <option value="drag">Kéo thả trên lịch</option>
                                    </select>
                                </div>
                                <div id="dateRangeInputs">
                                    <div class="form-group">
                                        <label for="quickStartDate">Từ ngày:</label>
                                        <input type="date" id="quickStartDate">
                                    </div>
                                    <div class="form-group">
                                        <label for="quickEndDate">Đến ngày:</label>
                                        <input type="date" id="quickEndDate">
                                    </div>
                                    <button id="applyQuickEditBtn" class="btn btn-primary btn-full-width">
                                        <i class="fas fa-magic"></i> Áp dụng cho khoảng ngày
                                    </button>
                                </div>
                                <div id="dragModeInstructions" style="display:none;">
                                    <p
                                        style="color: var(--text-secondary); font-size: 14px; text-align: center; padding: 12px;">
                                        <i class="fas fa-hand-pointer"></i> Nhấn và kéo trên lịch để chọn nhiều ngày
                                    </p>
                                </div>
                            </div>
                        </div>

                        <table class="calendar-table">
                            <thead>
                                <tr id="calendarHeaderRow"></tr>
                            </thead>
                            <tbody id="calendarDays"></tbody>
                        </table>
                    </div>
                </div>
                <div id="tabSoChamCong" class="tab-content">
                    <div class="card" id="statsCard">
                        <h3 class="card-header">Thống Kê Tháng Này</h3>
                        <div class="stats-grid">
                            <div class="stat-item"><span class="stat-label">Lịch làm:</span><span class="stat-value"
                                    id="statsTotalWorkDays">...</span></div>
                            <div class="stat-item"><span class="stat-label">Đã làm:</span><span class="stat-value"
                                    id="statsActualWorkDays">...</span></div>
                            <div class="stat-item"><span class="stat-label">Ngày nghỉ:</span><span class="stat-value"
                                    id="statsLeaveDays">...</span></div>
                            <div class="stat-item"><span class="stat-label">Giờ làm:</span><span class="stat-value"
                                    id="statsTotalHours">...</span></div>
                            <div class="stat-item"><span class="stat-label">Tăng ca:</span><span class="stat-value"
                                    id="statsOvertimeHours">...</span></div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">Bộ lọc</div>
                        <div class="filter-group">
                            <div class="form-group"><label for="logFilterType">Lọc theo:</label><select
                                    id="logFilterType">
                                    <option value="all">Tất cả</option>
                                    <option value="range">Khoảng ngày</option>
                                    <option value="month">Tháng cụ thể</option>
                                </select></div>
                            <div class="form-group" id="logDateRangePicker" style="display:none;"><label
                                    for="logStartDate">Từ ngày:</label><input type="date" id="logStartDate"><label
                                    for="logEndDate" style="margin-top: 10px;">Đến ngày:</label><input type="date"
                                    id="logEndDate"></div>
                            <div class="form-group" id="logMonthPicker" style="display:none;"><label for="logMonth">Chọn
                                    tháng:</label><input type="month" id="logMonth"></div>
                        </div>
                        <div class="button-group">
                            <button id="applyLogFilterBtn" class="btn btn-secondary"><i class="fas fa-filter"></i> Áp
                                dụng</button>
                            <button id="exportLogCsvBtn" class="btn btn-primary"><i class="fas fa-file-csv"></i> Tải
                                CSV</button>
                        </div>
                    </div>
                    <div class="card">
                        <table class="timesheet-log-table">
                            <tbody id="timesheetLogBody"></tbody>
                        </table>
                        <p id="noTimesheetDataMsg" class="no-timesheet-data" style="display:none;">Chưa có dữ liệu.</p>
                    </div>
                </div>

                <div id="tabMayTinh" class="tab-content">
                    <div class="card dashboard-header-controls">
                        <button id="prevMonthCalcBtn" class="btn-icon" aria-label="Tháng trước"><i
                                class="fas fa-chevron-left"></i></button>
                        <h2 id="currentMonthCalcYear">Tháng X, Năm Y</h2>
                        <button id="nextMonthCalcBtn" class="btn-icon" aria-label="Tháng sau"><i
                                class="fas fa-chevron-right"></i></button>
                    </div>

                    <div class="dashboard-grid">
                       

                        <div class="card card-summary">
                            <h3 class="card-header">Thống Kê Lương Thực Tế</h3>
                            <div class="stat-item"><span class="stat-label">Lương cơ bản:</span><span class="stat-value"
                                    id="luongCoBan">0</span></div>
                            <div class="stat-item"><span class="stat-label">Lương tăng ca:</span><span
                                    class="stat-value" id="luongTangCa">0</span></div>
                            <div class="stat-item"><span class="stat-label total-label">Tổng lương:</span><span
                                    class="stat-value total-value" id="tongLuong">0</span></div>
                        </div>

                        <div class="card card-prediction">
                            <h3 class="card-header">Dự Đoán Lương</h3>
                            <div class="form-group">
                                <label for="gioTangCaGiaDinh">Số giờ tăng ca dự kiến:</label>
                                <input type="number" id="gioTangCaGiaDinh" class="form-control" value="0">
                            </div>
                            <div class="stat-item"><span class="stat-label">Giờ làm cơ bản (dự kiến):</span><span
                                    class="stat-value" id="soGioLamCoBanGiaDinh">0</span></div>
                            <div class="stat-item"><span class="stat-label">Giờ tăng ca (dự kiến):</span><span
                                    class="stat-value" id="soGioLamTangCaGiaDinh">0</span></div>
                            <div class="stat-item"><span class="stat-label">Lương cơ bản (dự kiến):</span><span
                                    class="stat-value" id="duDoanLuongCoBan">0</span></div>
                            <div class="stat-item"><span class="stat-label">Lương tăng ca (dự kiến):</span><span
                                    class="stat-value" id="duDoanLuongTangCa">0</span></div>
                            <div class="stat-item"><span class="stat-label total-label">Tổng lương (dự
                                    kiến):</span><span class="stat-value total-value" id="tongLuongDuDoan">0</span>
                            </div>
                        </div>

                         <div class="card card-input">
                            <h3 class="card-header">Nhập Dữ Liệu Lương</h3>
                            <div class="form-group">
                                <label for="luongGio">Số tiền lương giờ:</label>
                                <input type="number" id="luongGio" class="form-control" value="0">
                            </div>
                            <div class="form-group">
                                <label for="luongTangCaGio">Số tiền lương tăng ca giờ:</label>
                                <input type="number" id="luongTangCaGio" class="form-control" value="0">
                            </div>
                            <div class="form-group">
                                <label for="troCapCoDinh">Trợ cấp cố định:</label>
                                <input type="number" id="troCapCoDinh" class="form-control" value="0">
                            </div>
                            <div class="form-group">
                                <label for="troCapLinhHoat">Trợ cấp linh hoạt:</label>
                                <input type="number" id="troCapLinhHoat" class="form-control" value="0">
                            </div>
                            <div class="form-group">
                                <label for="phiKhac">Phí khác:</label>
                                <input type="number" id="phiKhac" class="form-control" value="0">
                            </div>
                            <button id="luuDuLieuBtn" class="btn btn-primary btn-full-width">Lưu Dữ Liệu</button>
                        </div>
                    </div>
                </div>

                <div id="tabThongTin" class="tab-content">
                    <div class="card">
                        <h3 class="card-header">Chào mừng đến với Sổ Chấm Công!</h3>
                        <p>Ứng dụng này giúp bạn quản lý lịch làm việc và chấm công cá nhân một cách dễ dàng và trực
                            quan.</p>
                    </div>

                    <!-- <div class="card">
                        <h3 class="card-header">1. Tab Lịch Làm Việc (<i class="fas fa-calendar-alt"></i>)</h3>
                        <ul>
                            <li>**Xem Lịch:** Hiển thị lịch làm việc của tháng/chu kỳ công hiện tại.</li>
                            <li>**Chuyển tháng/chu kỳ:**
                                <ul>
                                    <li>Nhấn nút <i class="fas fa-chevron-left"></i> và <i
                                            class="fas fa-chevron-right"></i> để chuyển tháng/chu kỳ.</li>
                                    <li>**Vuốt (Swipe)** trái/phải trên header hoặc bảng lịch để chuyển tháng/chu kỳ
                                        nhanh chóng.</li>
                                    <li>**Nhấn vào tiêu đề tháng/năm:** Click vào "Tháng X, Năm Y" để mở bộ chọn
                                        tháng/năm nhanh chóng.</li>
                                    <li>**Nhấn giữ tiêu đề tháng/năm:** Nhấn giữ vào "Tháng X, Năm Y" để quay về tháng
                                        hiện tại của hệ thống.</li>
                                </ul>
                            </li>
                            <li>**Sửa Lịch (<i class="fas fa-edit"></i> Sửa Lịch):**
                                <ul>
                                    <li>Nhấn nút "Sửa Lịch" để vào chế độ chỉnh sửa.</li>
                                    <li>**Chỉnh sửa từng ngày:** Click vào một ngày để chuyển đổi giữa các ca: Rỗng <i
                                            class="fas fa-sun"></i> (Ca sáng) <i class="fas fa-moon"></i> (Ca tối) <i
                                            class="fas fa-home"></i> (Nghỉ) <i class="fas fa-star"></i> (Ngày lễ).</li>
                                    <li>**Sửa Lịch Nhanh (Khoảng ngày):** Chọn "Chọn khoảng ngày", nhập ngày bắt đầu và
                                        ngày kết thúc, chọn loại ca, rồi nhấn "Áp dụng cho khoảng ngày".</li>
                                    <li>**Sửa Lịch Nhanh (Kéo thả):** Chọn "Kéo thả trên lịch", nhấn và kéo trên lịch để
                                        chọn nhiều ngày. Sau đó, các ngày được chọn sẽ được áp dụng loại ca đã chọn.
                                    </li>
                                    <li>**Bỏ qua cuối tuần:** Nếu cài đặt "Cho phép sửa lịch cuối tuần" (trong tab Cài
                                        đặt) TẮT, bạn sẽ không thể sửa hoặc kéo chọn các ngày Thứ Bảy/Chủ Nhật.</li>
                                    <li>Nhấn "Lưu Lịch" (<i class="fas fa-check"></i> Lưu Lịch) để lưu thay đổi.</li>
                                </ul>
                            </li>
                            <li>**Chấm Công (Ngoài chế độ sửa lịch):**
                                <ul>
                                    <li>Click vào một ngày bất kỳ trên lịch (không ở chế độ sửa lịch) để mở hộp thoại
                                        chấm công.</li>
                                    <li>Chọn loại ngày công (Ngày làm, Nghỉ phép, v.v.). Nếu chọn "Ngày làm", bạn có thể
                                        nhập giờ/phút tăng ca.</li>
                                    <li>Nhập ghi chú và nhấn "Xác nhận".</li>
                                    <li>Nếu ngày đó đã có chấm công, bạn sẽ có tùy chọn "Sửa" hoặc "Xoá".</li>
                                </ul>
                            </li>
                        </ul>
                    </div> -->
                </div>

                <div id="tabCaiDat" class="tab-content">
                    <div class="card">
                        <h3 class="card-header">Giao diện</h3>
                        <div class="form-group"><label for="themeSelector">Chọn chủ đề:</label><select
                                id="themeSelector">
                                <option value="default">Sáng</option>
                                <option value="dark">Tối</option>
                                <option value="cute">Dễ Thương</option>
                                <option value="doraemon">Doraemon</option>

                            </select></div>
                    </div>
                    
                    <div class="card">
                        <h3 class="card-header">Ngày bắt đầu công</h3>
                        <div class="form-group">
                            <label for="startWorkDayInput">Ngày bắt đầu tính công hàng tháng:</label>
                            <input type="number" id="startWorkDayInput" min="1" max="31" value="1">
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-header">Chế độ hiển thị lịch</h3>
                        <div class="form-group">
                            <label for="displayModeSelect">Chọn chế độ:</label>
                            <select id="displayModeSelect">
                                <option value="fullMonth">Hiển thị toàn bộ tháng</option>
                                <option value="workPeriod">Hiển thị theo chu kỳ công</option>
                            </select>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-header">Tiền tệ</h3>
                        <div class="form-group">
                            <label for="currencySelector">Chọn loại tiền:</label>
                            <select id="currencySelector">
                                <option value="VND">VND đ</option>
                                <option value="JPY">JPY ¥</option>
                                <option value="USD">USD $</option>
                                <option value="EUR">EUR €</option>
                            </select>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-header">Dữ liệu cơ bản</h3>
                        <div class="form-group">
                            <label for="baseHoursInput">Số giờ làm cơ bản / ngày</label>
                            <input type="number" id="baseHoursInput" min="1" max="24" value="8">
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-header">Xuất dữ liệu</h3>
                        <div class="form-group"><label for="exportDataType">Loại dữ liệu xuất:</label><select
                                id="exportDataType">
                                <option value="all">Toàn bộ</option>
                                <option value="schedule">Chỉ Lịch</option>
                                <option value="timesheet">Chỉ Chấm Công</option>
                            </select></div>
                        <div class="button-group"><button id="exportDataBtn" class="btn btn-secondary"><i
                                    class="fas fa-file-export"></i> Xuất File JSON</button></div>
                    </div>
                    <div class="card">
                        <h3 class="card-header">Nhập dữ liệu</h3>
                        <div class="form-group"><label for="importFile">Nhập từ file JSON:</label><input type="file"
                                id="importFile" accept=".json"
                                style="padding: 10px; border: 1px solid var(--separator-color); border-radius: var(--radius-m); background: var(--input-bg);">
                        </div>
                        <div class="button-group"><button id="importDataBtn" class="btn btn-primary"><i
                                    class="fas fa-file-import"></i> Nhập Dữ Liệu</button></div>
                        <p style="font-size:13px; color:var(--text-secondary); margin-top:16px;">Lưu ý: Dữ liệu nhập
                            sẽ
                            ghi đè.</p>
                    </div>

                    <div class="">
                        <p>Design by HunqD with Love ❤️</p>
                        <p>Phiên bản: 1.2.0</p>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <div id="timesheetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Chấm công</h3>
            </div>
            <div class="modal-body">
                <form id="timesheetForm">
                    <input type="hidden" id="timesheetDate">
                    <div class="form-group">
                        <label for="entryType">Loại ngày công</label>
                        <select id="entryType">
                            <option value="work">Ngày làm</option>
                            <option value="paid_leave">Nghỉ phép</option>
                            <option value="unpaid_leave">Nghỉ không lương</option>
                            <option value="company_holiday">Công ty cho nghỉ</option>
                        </select>
                    </div>
                    <div id="overtimeFields" style="display: none;">
                        <div class="form-group"><label for="overtimeHours">Giờ tăng ca:</label><input type="number"
                                id="overtimeHours" min="0" max="23" placeholder="0"></div>
                        <div class="form-group"><label for="overtimeMinutes">Phút tăng ca:</label><input type="number"
                                id="overtimeMinutes" min="0" max="59" placeholder="0"></div>
                    </div>
                    <div class="form-group"><label for="notes">Ghi chú:</label><textarea id="notes" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-cancel">Hủy</button>
                <button type="button" class="btn btn-confirm btn-primary">Xác nhận</button>
            </div>
        </div>
    </div>
    <div id="actionConfirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="actionConfirmModalTitle">Hành động</h3>
            </div>
            <div class="modal-body">
                <p>Bạn muốn làm gì với mục chấm công này?</p>
                <input type="hidden" id="actionConfirmDate">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-edit-timesheet"><i class="fas fa-pencil-alt"></i> Sửa</button>
                <button type="button" class="btn btn-danger btn-delete-timesheet"><i class="fas fa-trash-alt"></i>
                    Xoá</button>
            </div>
        </div>
    </div>

</body>
<script src="./script.js"></script>
<script src="./calc.js"></script>

</html>