<!DOCTYPE html>
<html lang="vi" data-theme="auto">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
    <title>Hunq Blog</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;800&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/9392097706.js" crossorigin="anonymous"></script>

    <style>
        /* --- 1. THEME VARIABLES (Hệ thống màu) --- */
        :root {
            /* Light Mode Default */
            --bg-body: #ffffff;
            --bg-surface: #f9f9f9;
            --bg-input: #f0f0f0;
            --text-main: #111111;
            --text-sec: #666666;
            --border: #e5e5e5;
            --accent: #000000; /* Minimalist Accent là màu đen */
            --accent-text: #ffffff;
            --highlight: #fff3b0;
            --nav-blur: rgba(255, 255, 255, 0.85);
            --shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        /* Auto Mode: Nếu thiết bị đang để Dark Mode */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-body: #121212;
                --bg-surface: #1e1e1e;
                --bg-input: #2c2c2c;
                --text-main: #e0e0e0;
                --text-sec: #a0a0a0;
                --border: #333333;
                --accent: #ffffff;
                --accent-text: #000000;
                --highlight: #3a3a3a;
                --nav-blur: rgba(18, 18, 18, 0.85);
                --shadow: none;
            }
        }

        /* Manual Dark Mode Override */
        [data-theme="dark"] {
            --bg-body: #121212;
            --bg-surface: #1e1e1e;
            --bg-input: #2c2c2c;
            --text-main: #e0e0e0;
            --text-sec: #a0a0a0;
            --border: #333333;
            --accent: #ffffff;
            --accent-text: #000000;
            --highlight: #3a3a3a;
            --nav-blur: rgba(18, 18, 18, 0.85);
            --shadow: none;
        }

        /* Manual Light Mode Override */
        [data-theme="light"] {
            --bg-body: #ffffff;
            --bg-surface: #f9f9f9;
            --bg-input: #f0f0f0;
            --text-main: #111111;
            --text-sec: #666666;
            --border: #e5e5e5;
            --accent: #000000;
            --accent-text: #ffffff;
            --highlight: #fff3b0;
            --nav-blur: rgba(255, 255, 255, 0.85);
            --shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        /* --- 2. GLOBAL RESET --- */
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            line-height: 1.7;
            transition: background-color 0.3s ease, color 0.3s ease; /* Hiệu ứng chuyển màu mượt */
            padding-bottom: 100px;
        }

        a { text-decoration: none; color: inherit; }
        button { border: none; background: none; cursor: pointer; color: inherit; font-family: inherit; }
        img { max-width: 100%; height: auto; border-radius: 4px; display: block; }
        
        /* Container chung cho nội dung để căn giữa */
        .container {
            max-width: 680px; /* Minimal blog thường hẹp để dễ đọc */
            margin: 0 auto;
            padding: 0 20px;
        }

        /* --- 3. HEADER & NAV --- */
        header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: var(--nav-blur);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border);
            padding: 15px 0;
        }

        .nav-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo { font-weight: 800; font-size: 1.2rem; letter-spacing: -0.5px; }

        .toolbar { display: flex; gap: 15px; align-items: center; }
        
        .toolbar button {
            font-size: 1.1rem;
            padding: 5px;
            transition: opacity 0.2s;
            opacity: 0.7;
        }
        .toolbar button:hover { opacity: 1; }

        /* Search Bar Toggle Styles */
        #search-container {
            overflow: hidden;
            max-height: 0;
            transition: max-height 0.3s ease;
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border);
        }
        #search-container.open { max-height: 60px; }
        
        .search-input-wrap {
            max-width: 680px;
            margin: 0 auto;
            padding: 10px 20px;
            display: flex;
        }
        .search-input-wrap input {
            width: 100%;
            background: transparent;
            border: none;
            font-size: 16px;
            color: var(--text-main);
            outline: none;
            font-family: 'Inter', sans-serif;
        }

        /* --- 4. HERO SECTION --- */
        .hero {
            padding: 60px 0 40px;
            text-align: center;
        }
        .hero h1 {
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: -1.5px;
            margin-bottom: 15px;
        }
        .hero p { color: var(--text-sec); margin-bottom: 25px; }
        
        .btn-download {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--accent);
            color: var(--accent-text);
            padding: 10px 24px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: transform 0.2s;
        }
        .btn-download:active { transform: scale(0.95); }

        /* --- 5. CALCULATOR (Minimal Style) --- */
        .calc-wrapper {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 40px;
        }
        .calc-title { font-weight: 600; margin-bottom: 20px; font-size: 1.1rem; }
        
        .calc-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr auto;
            gap: 10px;
            margin-bottom: 15px;
        }
        .inp-group { display: flex; flex-direction: column; }
        .inp-group label { font-size: 0.75rem; color: var(--text-sec); margin-bottom: 5px; font-weight: 600; }
        .inp-group input {
            width: 100%;
            background: var(--bg-input);
            border: 1px solid transparent;
            color: var(--text-main);
            padding: 8px 12px;
            border-radius: 6px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
        }
        .inp-group input:focus { border-color: var(--text-sec); }
        .inp-group input[readonly] { color: var(--accent); font-weight: bold; }

        /* --- 6. BLOG FEED --- */
        .feed-item {
            padding: 40px 0;
            border-bottom: 1px solid var(--border);
        }
        .feed-item:last-child { border-bottom: none; }
        
        .feed-item.highlighted {
            background: var(--bg-surface);
            margin: 0 -20px;
            padding: 40px 20px;
            border-radius: 12px;
        }

        .meta {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.85rem;
            color: var(--text-sec);
            margin-bottom: 12px;
        }
        .meta img { width: 24px; height: 24px; border-radius: 50%; }
        
        .feed-title {
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: 15px;
            letter-spacing: -0.5px;
        }

        .feed-content {
            font-size: 1rem;
            color: var(--text-main);
            opacity: 0.9;
        }
        .feed-content p { margin-bottom: 15px; }
        .feed-content img, .feed-content video { margin: 20px 0; border-radius: 8px; width: 100%; }
        
        /* --- 7. UTILS & MODAL --- */
        .scroll-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 44px;
            height: 44px;
            background: var(--accent);
            color: var(--accent-text);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: 0.3s;
            z-index: 90;
        }
        .scroll-top.show { opacity: 1; pointer-events: auto; }

        /* Modal Image */
        .modal {
            display: none;
            position: fixed; z-index: 999;
            left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.9);
            backdrop-filter: blur(5px);
        }
        .modal-content {
            margin: auto; display: block;
            max-width: 95%; max-height: 90vh;
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        .modal-close {
            position: absolute; top: 20px; right: 30px;
            color: #fff; font-size: 30px; cursor: pointer;
        }
        
        /* Trạng thái Loading */
        .loading { text-align: center; padding: 40px; color: var(--text-sec); }

    </style>
</head>

<body>

    <header>
        <div class="container nav-inner">
            <div class="logo">Hunq.</div>
            <div class="toolbar">
                <button onclick="toggleSearch()" title="Tìm kiếm"><i class="fa-solid fa-magnifying-glass"></i></button>
                <button onclick="toggleImages()" id="btnImg" title="Ẩn/Hiện ảnh"><i class="fas fa-images"></i></button>
                <button onclick="cycleTheme()" id="themeBtn" title="Đổi giao diện">
                    <i class="fas fa-adjust"></i>
                </button>
            </div>
        </div>
    </header>

    <div id="search-container">
        <div class="search-input-wrap">
            <input type="text" id="searchInput" placeholder="Gõ từ khóa và nhấn Enter..." onkeydown="if(event.key === 'Enter') doSearch()">
            <button onclick="doSearch()"><i class="fas fa-arrow-right"></i></button>
        </div>
    </div>

    <div class="container">
        <div class="hero">
            <h1 id="welcomeText">PROJECT AP2</h1>
            <p>Blog cá nhân & Công cụ kỹ thuật</p>
            <a href="https://drive.google.com/file/d/1NAFtdd7Edr0Z-3CWmF_n9Ztid7t7EwNi/view?usp=drivesdk" target="_blank" class="btn-download">
                <i class="fas fa-download"></i> Tải về AP2
            </a>
        </div>

        <div style="text-align: right; margin-bottom: 10px;">
            <button onclick="document.getElementById('calcArea').style.display = document.getElementById('calcArea').style.display === 'none' ? 'block' : 'none'" style="font-size: 0.8rem; color: var(--text-sec); text-decoration: underline;">
                Công cụ tính toán
            </button>
        </div>

        <div id="calcArea" class="calc-wrapper" style="display: none;">
            <div class="calc-title">Chuyển đổi tín hiệu (4-20mA / 0-10V)</div>
            
            <div class="calc-grid">
                <div class="inp-group"><label>Min</label><input type="number" id="A-Min" value="0"></div>
                <div class="inp-group"><label>Input</label><input type="number" id="A-Need" value="75"></div>
                <div class="inp-group"><label>Max</label><input type="number" id="A-Max" value="150"></div>
                <div class="inp-group"><label>Đơn vị</label><input type="text" value="Bar" disabled style="width: 50px;"></div>
            </div>

            <div class="calc-grid">
                <div class="inp-group"><label>Min</label><input type="number" id="B-Min" value="4"></div>
                <div class="inp-group"><label>Kết quả</label><input type="number" id="B-Need" readonly></div>
                <div class="inp-group"><label>Max</label><input type="number" id="B-Max" value="20"></div>
                <div class="inp-group"><label>Đơn vị</label><input type="text" value="mA" disabled style="width: 50px;"></div>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button onclick="calculateSignal()" style="background: var(--text-main); color: var(--bg-body); padding: 8px 16px; border-radius: 4px; font-size: 0.9rem;">Tính toán</button>
                <button onclick="clearCalc()" style="color: var(--text-sec); font-size: 0.9rem;">Xóa</button>
            </div>
        </div>

        <div id="feed-area">
            <div class="loading"><i class="fas fa-circle-notch fa-spin"></i> Đang tải bài viết...</div>
        </div>
    </div>

    <button class="scroll-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
        <i class="fas fa-arrow-up"></i>
    </button>

    <div id="imgModal" class="modal">
        <span class="modal-close" onclick="document.getElementById('imgModal').style.display='none'">&times;</span>
        <img class="modal-content" id="modalImg">
    </div>

    <script>
        // --- 1. THEME LOGIC (CORE) ---
        // Các chế độ: 'auto', 'light', 'dark'
        const themeIcons = {
            'auto': '<i class="fas fa-adjust"></i>', // Biểu tượng bán nguyệt cho Auto
            'light': '<i class="fas fa-sun"></i>',    // Mặt trời
            'dark': '<i class="fas fa-moon"></i>'     // Mặt trăng
        };
        
        let currentTheme = localStorage.getItem('theme') || 'auto';

        function applyTheme(theme) {
            const html = document.documentElement;
            const btn = document.getElementById('themeBtn');
            
            // Xóa attribute cũ để reset về default (nếu là auto)
            html.removeAttribute('data-theme');

            if (theme === 'auto') {
                // Không set data-theme, để CSS @media prefers-color-scheme lo
                btn.innerHTML = themeIcons['auto'];
                btn.setAttribute('title', 'Chế độ: Thiết bị');
            } else {
                html.setAttribute('data-theme', theme);
                btn.innerHTML = themeIcons[theme];
                btn.setAttribute('title', 'Chế độ: ' + (theme === 'light' ? 'Sáng' : 'Tối'));
            }
            localStorage.setItem('theme', theme);
        }

        function cycleTheme() {
            if (currentTheme === 'auto') currentTheme = 'light';
            else if (currentTheme === 'light') currentTheme = 'dark';
            else currentTheme = 'auto';
            
            applyTheme(currentTheme);
        }

        // Init theme on load
        applyTheme(currentTheme);


        // --- 2. RSS FEED LOGIC ---
        const rssUrl = 'https://projectap2.wordpress.com/feed/';
        const proxyUrl = 'https://api.codetabs.com/v1/proxy?quest=';

        fetch(proxyUrl + encodeURIComponent(rssUrl))
            .then(res => res.text())
            .then(str => new DOMParser().parseFromString(str, "text/xml"))
            .then(data => {
                const items = data.querySelectorAll("item");
                let html = '';
                
                items.forEach((item, index) => {
                    const title = item.querySelector("title").textContent;
                    const content = item.querySelector("encoded").textContent;
                    const date = new Date(item.querySelector("pubDate").textContent);
                    const author = item.querySelector("creator").textContent;
                    
                    // Format Date Minimal
                    const dateStr = `${date.getDate()}/${date.getMonth()+1}/${date.getFullYear()}`;
                    const avatar = author === 'HunqD' 
                        ? 'https://graph.facebook.com/100045640179308/picture?type=large'
                        : `https://ui-avatars.com/api/?name=${author}&background=random`;

                    html += `
                        <article class="feed-item">
                            <div class="meta">
                                <img src="${avatar}" alt="${author}">
                                <span>${author} • ${dateStr}</span>
                            </div>
                            <h2 class="feed-title">${title}</h2>
                            <div class="feed-content">${content}</div>
                        </article>
                    `;
                });
                
                document.getElementById('feed-area').innerHTML = html;
                postProcessMedia();
            })
            .catch(err => {
                document.getElementById('feed-area').innerHTML = '<div class="loading">Lỗi tải dữ liệu.</div>';
                console.error(err);
            });

        // --- 3. MEDIA HANDLING & UTILS ---
        function postProcessMedia() {
            // Video click to play
            document.querySelectorAll('video').forEach(v => {
                v.removeAttribute('controls');
                v.onclick = () => v.paused ? v.play() : v.pause();
            });

            // Image Modal
            document.querySelectorAll('.feed-content img').forEach(img => {
                img.onclick = () => {
                    const modal = document.getElementById('imgModal');
                    const mImg = document.getElementById('modalImg');
                    mImg.src = img.src;
                    modal.style.display = 'block';
                }
            });
        }

        // Toggle Search
        function toggleSearch() {
            document.getElementById('search-container').classList.toggle('open');
            if(document.getElementById('search-container').classList.contains('open')){
                setTimeout(() => document.getElementById('searchInput').focus(), 300);
            }
        }

        // Toggle Images
        function toggleImages() {
            const btn = document.getElementById('btnImg');
            const media = document.querySelectorAll('img, video');
            const isHidden = btn.classList.contains('hidden-mode');
            
            if (!isHidden) {
                media.forEach(el => el.style.display = 'none');
                btn.classList.add('hidden-mode');
                btn.innerHTML = '<i class="fas fa-heading"></i>'; // Icon text only
            } else {
                media.forEach(el => el.style.display = 'block');
                btn.classList.remove('hidden-mode');
                btn.innerHTML = '<i class="fas fa-images"></i>';
            }
        }

        // Search Functionality
        function doSearch() {
            const term = document.getElementById('searchInput').value.toLowerCase();
            const items = document.querySelectorAll('.feed-item');
            let found = false;

            // Reset
            items.forEach(i => i.classList.remove('highlighted'));

            for(let item of items) {
                if(item.innerText.toLowerCase().includes(term)) {
                    item.classList.add('highlighted');
                    item.scrollIntoView({behavior: "smooth", block: "center"});
                    found = true;
                    break; // Jump to first result
                }
            }
            if(!found && term) alert('Không tìm thấy nội dung!');
        }

        // Scroll Top Button Visibility
        window.onscroll = () => {
            const btn = document.querySelector('.scroll-top');
            if (window.scrollY > 300) btn.classList.add('show');
            else btn.classList.remove('show');
        };

        // --- 4. CALCULATOR LOGIC ---
        function calculateSignal() {
            const aMin = parseFloat(document.getElementById('A-Min').value);
            const aMax = parseFloat(document.getElementById('A-Max').value);
            const aVal = parseFloat(document.getElementById('A-Need').value);
            const bMin = parseFloat(document.getElementById('B-Min').value);
            const bMax = parseFloat(document.getElementById('B-Max').value);

            if(isNaN(aVal)) return;

            // Công thức nội suy tuyến tính
            const result = ((aVal - aMin) * (bMax - bMin) / (aMax - aMin)) + bMin;
            document.getElementById('B-Need').value = result.toFixed(3); // Lấy 3 số thập phân
        }

        function clearCalc() {
            document.getElementById('A-Need').value = '';
            document.getElementById('B-Need').value = '';
        }

        // Welcome Text Animation
        const welcomeEl = document.getElementById('welcomeText');
        const titles = ["PROJECT AP2", "BY HUNQ", "HUNQ LOG"];
        let tIndex = 0;
        setInterval(() => {
            welcomeEl.style.opacity = 0;
            setTimeout(() => {
                tIndex = (tIndex + 1) % titles.length;
                welcomeEl.innerText = titles[tIndex];
                welcomeEl.style.opacity = 1;
            }, 300);
        }, 3000);

    </script>
</body>
</html>