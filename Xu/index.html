<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Máy Đếm Tiền Yên Nhật</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">

    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f4f9; /* A slightly warmer background */
            color: #1c1c1e;
        }
        .total-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        input[type='number'] {
            -moz-appearance: textfield;
            text-align: right;
            font-variant-numeric: tabular-nums;
        }
        input[type='number']::-webkit-inner-spin-button,
        input[type='number']::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .currency-row:not(:last-child) {
            border-bottom: 1px solid #e5e7eb;
        }
        .currency-icon {
            transition: transform 0.2s ease-in-out;
        }
        .currency-icon:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="antialiased">

    <div class="min-h-screen flex flex-col">
        <!-- Main Content -->
        <main class="flex-grow container mx-auto p-4 max-w-2xl">
            <header class="text-center my-6">
                <h1 class="text-4xl font-bold text-gray-800">Máy Đếm Tiền Yên</h1>
                <p class="text-gray-500 mt-1">Nhập số lượng tiền bạn có để xem tổng số.</p>
            </header>

            <!-- Money Counter Container -->
            <div id="money-counter" class="bg-white rounded-2xl shadow-lg overflow-hidden">
                <!-- Rows will be generated by JS -->
            </div>
            
             <div class="text-center mt-4">
                <button id="reset-btn" class="text-sm text-gray-500 hover:text-red-600 hover:underline transition-colors duration-200">
                    <i class="ph-bold ph-trash align-middle mr-1"></i>Xóa tất cả
                </button>
            </div>
        </main>

        <!-- Sticky Total Footer -->
        <footer class="sticky bottom-0 z-10">
            <div class="total-display p-4 shadow-2xl">
                <div class="container mx-auto max-w-2xl flex justify-between items-center">
                    <span class="text-lg font-semibold opacity-80">TỔNG CỘNG</span>
                    <span id="wallet-total-amount" class="text-4xl font-black tracking-tight">0 ¥</span>
                </div>
            </div>
        </footer>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DATA ---
        const currencyData = [
            { id: 'b10000', value: 10000, name: '10.000 Yên', type: 'banknote' },
            { id: 'b5000', value: 5000, name: '5.000 Yên', type: 'banknote' },
            { id: 'b2000', value: 2000, name: '2.000 Yên', type: 'banknote' },
            { id: 'b1000', value: 1000, name: '1.000 Yên', type: 'banknote' },
            { id: 'c500', value: 500, name: '500 Yên', type: 'coin' },
            { id: 'c100', value: 100, name: '100 Yên', type: 'coin' },
            { id: 'c50', value: 50, name: '50 Yên', type: 'coin' },
            { id: 'c10', value: 10, name: '10 Yên', type: 'coin' },
            { id: 'c5', value: 5, name: '5 Yên', type: 'coin' },
            { id: 'c1', value: 1, name: '1 Yên', type: 'coin' }
        ];

        // --- DOM Elements ---
        const moneyCounterContainer = document.getElementById('money-counter');
        const totalAmountEl = document.getElementById('wallet-total-amount');
        const resetButton = document.getElementById('reset-btn');

        // --- Functions ---
        
        /**
         * Calculates and displays the total amount.
         * Also saves the current state to localStorage.
         */
        const updateAndSave = () => {
            let total = 0;
            const walletState = {};

            currencyData.forEach(item => {
                const input = document.getElementById(`wallet-${item.id}`);
                const count = parseInt(input.value) || 0;
                
                if (count > 0) {
                    total += count * item.value;
                }
                walletState[item.id] = count;
            });
            
            // Format and display total
            totalAmountEl.textContent = `${total.toLocaleString('ja-JP')} ¥`;
            
            // Save state to localStorage
            localStorage.setItem('japaneseWallet', JSON.stringify(walletState));
        };
        
        /**
         * Renders a single currency row in the counter.
         * @param {object} item - The currency data object.
         */
        const createCurrencyRow = (item) => {
            const row = document.createElement('div');
            row.className = 'currency-row flex items-center p-4 gap-4';
            
            const icon = item.type === 'banknote' 
                ? '<i class="ph-bold ph-note text-3xl text-indigo-500"></i>' 
                : '<i class="ph-bold ph-coin text-3xl text-amber-500"></i>';

            row.innerHTML = `
                <div class="currency-icon">
                    ${icon}
                </div>
                <div class="flex-grow">
                    <p class="font-bold text-lg text-gray-800">${item.name}</p>
                </div>
                <div class="flex items-center gap-2">
                     <span class="text-gray-400 font-semibold">x</span>
                     <input type="number" id="wallet-${item.id}" data-value="${item.value}" min="0" placeholder="0" class="w-24 h-12 bg-gray-100 border-2 border-transparent rounded-lg text-lg font-bold focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                </div>
            `;
            
            // Add event listener to the input for real-time updates
            const inputElement = row.querySelector('input');
            inputElement.addEventListener('input', updateAndSave);

            return row;
        };

        /**
         * Renders the entire money counter interface.
         */
        const renderCounter = () => {
            moneyCounterContainer.innerHTML = '';
            currencyData.forEach(item => {
                const row = createCurrencyRow(item);
                moneyCounterContainer.appendChild(row);
            });
        };

        /**
         * Loads saved wallet state from localStorage.
         */
        const loadWalletState = () => {
            const savedState = localStorage.getItem('japaneseWallet');
            if (savedState) {
                const wallet = JSON.parse(savedState);
                currencyData.forEach(item => {
                    if (wallet[item.id]) {
                        const input = document.getElementById(`wallet-${item.id}`);
                        input.value = wallet[item.id];
                    }
                });
            }
            // Calculate total after loading state
            updateAndSave();
        };

        /**
         * Resets all counts and clears storage.
         */
        const resetWallet = () => {
            if (confirm('Bạn có chắc muốn xóa toàn bộ số tiền đã nhập không?')) {
                currencyData.forEach(item => {
                    const input = document.getElementById(`wallet-${item.id}`);
                    input.value = '';
                });
                updateAndSave(); // This will save the empty state
            }
        };

        // --- Event Listeners ---
        resetButton.addEventListener('click', resetWallet);

        // --- Initial Load ---
        renderCounter();
        loadWalletState();
    });
    </script>
</body>
</html>
