<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Love Story</title>

    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" href="/Asset/logo/logo.png" />
    <link rel="apple-touch-icon" href="/Asset/logo/logo.png" sizes="150x150" />

    <meta property="og:image" content="/Asset/Banner/Banner.png" />
    <meta property="og:title" content="Love Story" />
    <meta property="og:description" content="Thiết kế và lập trình Đinh Mạnh Hùng" />
    <script src="/Asset/Extend/IABD.js"></script>

    <script src="https://cdn.tailwindcss.com"></script>

    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Nunito:wght@400;600;700;800&family=Lora:ital,wght@0,400;0,700;1,400&family=Comfortaa:wght@400;700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        love: {
                            50: 'var(--love-50)',
                            100: 'var(--love-100)',
                            200: 'var(--love-200)',
                            300: 'var(--love-300)',
                            400: 'var(--love-400)',
                            500: 'var(--love-500)',
                            600: 'var(--love-600)',
                        }
                    },
                    fontFamily: {
                        script: ['Dancing Script', 'cursive'],
                        sans: ['var(--app-font)', 'sans-serif'],
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'spin-slow': 'spin 8s linear infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        }
                    },
                    borderRadius: {
                        '4xl': '2rem',
                    }
                }
            }
        }
    </script>

    <style>
        :root {
            /* Default Pink Theme */
            --love-50: #fff1f2;
            --love-100: #ffe4e6;
            --love-200: #fecdd3;
            --love-300: #fda4af;
            --love-400: #fb7185;
            --love-500: #f43f5e;
            --love-600: #e11d48;
            --app-font: 'Nunito';
            --app-bg: #fff1f2;
            --glass-opacity: 0.2;
            /* Giá trị mặc định */
        }

        /* 1. Khóa Body để không bị kéo lung tung */
        body {
            font-family: var(--app-font), sans-serif;
            background-color: var(--app-bg);
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            overflow-x: hidden;
            transition: background 0.3s, color 0.3s;
        }

        body,
        html {
            overflow: hidden;
            /* Quan trọng: Chặn cuộn của trình duyệt */
            height: 100%;
            width: 100%;
            position: fixed;
            /* Cố định khung nhìn */
        }

        /* 2. Container chính full màn hình */
        #app-container {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        /* --- CSS CẬP NHẬT --- */

        #swipe-wrapper {
            display: flex;
            width: 100%;
            height: 100%;

            overflow-x: auto;
            overflow-y: hidden;

            /* Bắt dính cực mạnh */
            scroll-snap-type: x mandatory;

            /* Quan trọng: Tắt scroll-behavior ở CSS để JS kiểm soát mượt hơn khi cần */
            scroll-behavior: auto;

            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .page-section {
            /* Đảm bảo mỗi trang rộng đúng bằng màn hình, không hơn không kém */
            flex: 0 0 100%;
            min-width: 100%;
            width: 100%;

            height: 100%;
            scroll-snap-align: start;
            scroll-snap-stop: always;

            overflow-y: auto;
            overflow-x: hidden;
            padding-bottom: 80px;

            /* Xóa margin để tránh lệch */
            margin: 0;
            box-sizing: border-box;
        }

        .heart-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .heart-particle {
            position: absolute;
            color: var(--love-500);
            opacity: 0.1;
            animation: float 10s infinite;
        }

        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .tab-content {
            display: none;
            padding-bottom: 120px;
            animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.98);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .avatar-frame {
            border: 4px solid white;
            box-shadow: 0 8px 20px -5px rgba(0, 0, 0, 0.15);
        }

        .rounded-input {
            border-radius: 1rem;
            border: 1px solid #f3f4f6;
            padding: 0.75rem 1rem;
            transition: all 0.2s;
        }

        .rounded-input:focus {
            border-color: var(--love-400);
            box-shadow: 0 0 0 4px var(--love-100);
            outline: none;
        }

        .loader {
            border: 2px solid #f3f3f3;
            border-radius: 50%;
            border-top: 2px solid var(--love-500);
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .overlay-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--love-50);
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            overflow-y: auto;
        }

        .hidden-screen {
            display: none !important;
        }

        .status-bubble::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 6px 6px 0;
            border-style: solid;
            border-color: white transparent transparent transparent;
        }

        /* Swipe Logic */
        .swipe-item {
            transition: transform 0.2s ease-out;
            touch-action: pan-y;
        }

        .swipe-actions {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            display: flex;
            z-index: 0;
        }

        .swipe-content {
            position: relative;
            z-index: 10;
            width: 100%;
        }

        #lightbox {
            background-color: rgba(0, 0, 0, 0.95);
        }

        .custom-video-controls {
            opacity: 0;
            transition: opacity 0.3s;
        }

        .video-container:hover .custom-video-controls {
            opacity: 1;
        }

        /* --- CHẾ ĐỘ KÍNH TRONG SUỐT (Crystal Clear Glass) --- */

        /* 1. Khung chính: Trong suốt để nhìn rõ hình nền */
        /* GLASS MODE - SỬ DỤNG BIẾN ĐỘNG --glass-opacity */


        #app-container.glass-mode {
            /* Chỉ có màu nền mờ (chỉnh bằng thanh trượt), KHÔNG CÓ BLUR */
            background-color: rgba(255, 255, 255, var(--glass-opacity));

            /* XÓA BỎ 2 DÒNG NÀY ĐỂ ẢNH NỀN NÉT CĂNG */
            backdrop-filter: none;
            -webkit-backdrop-filter: none;

            /* Vẫn giữ đổ bóng để tách biệt khung */
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.3);
            border-left: 1px solid rgba(255, 255, 255, 0.2);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            transition: background-color 0.1s;
        }

        /* 2. Các thẻ con (Card/Box): Vẫn cần mờ nhẹ để đọc được chữ */
        /* Đây là nơi duy nhất có Blur để làm nổi bật nội dung */
        #app-container.glass-mode .bg-white,
        #app-container.glass-mode .bg-gray-50,
        #app-container.glass-mode .bg-love-50,
        #app-container.glass-mode input,
        #app-container.glass-mode textarea,
        #app-container.glass-mode select,
        #app-container.glass-mode .glass-card-special {
            /* Nền trắng đục hơn */
            background-color: rgba(255, 255, 255, 0.85) !important;

            /* Blur cục bộ bên trong thẻ con -> Chữ rõ ràng */
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);

            border: 1px solid rgba(255, 255, 255, 0.5) !important;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        /* 3. Tinh chỉnh card Đồng hồ cho đẹp hơn */
        #app-container.glass-mode .glass-card-special {
            /* Cho phép đồng hồ trong hơn các thẻ khác một chút */
            background-color: rgba(255, 255, 255, 0.5) !important;
            backdrop-filter: blur(15px);
            /* Blur mạnh bên trong card đồng hồ */
        }

        /* 4. Tinh chỉnh màu chữ khi ở chế độ Glass */
        #app-container.glass-mode h1,
        #app-container.glass-mode h2,
        #app-container.glass-mode h3,
        #app-container.glass-mode p,
        #app-container.glass-mode span,
        #app-container.glass-mode i {
            /* Thêm bóng trắng nhẹ xung quanh chữ để nếu hình nền màu đen thì chữ đen vẫn đọc được */
            text-shadow: 0 1px 1px rgba(255, 255, 255, 0.5);
        }

        /* Các nút bấm (Button) giữ nguyên độ đậm để nổi bật */
        #app-container.glass-mode button.bg-love-500,
        #app-container.glass-mode button.bg-gray-800 {
            /* background-opacity: 1 !important; */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }


        .floating-nav {
            position: fixed;
            bottom: 1.5rem;
            left: 1.5rem;
            right: 1.5rem;
            height: 4rem;
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border-radius: 9999px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-around;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.5);
            max-width: 400px;
            margin: 0 auto;
            z-index: 9;
        }

        /* Music Player Disk Animation */
        .music-disk {
            animation: spin-slow 8s linear infinite;
        }

        .music-disk.paused {
            animation-play-state: paused;
        }

        /* Timeline Styles */
        .timeline-line {
            display: none;
            position: absolute;
            left: 1rem;
            top: 15px;
            bottom: -20px;
            width: 2px;
            background-color: #e5e7eb;
            z-index: 0;
        }

        .timeline-item:last-child .timeline-line {
            display: none;
        }

        /* Animation cho Toast Notification */
        @keyframes slideInDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeOutUp {
            from {
                transform: translateY(0);
                opacity: 1;
            }

            to {
                transform: translateY(-100%);
                opacity: 0;
            }
        }

        .toast-enter {
            animation: slideInDown 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .toast-exit {
            animation: fadeOutUp 0.4s ease-in forwards;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .animate-slide-down {
            animation: slideDown 0.3s ease-out forwards;
        }

        .gallery-item.selected .overlay {
            opacity: 1;
            background-color: rgba(244, 63, 94, 0.4);
        }

        .gallery-item.selected img,
        .gallery-item.selected video {
            transform: scale(0.95);
        }


        /* Animation Mưa Tim Bình Thường */
        @keyframes fall {
            0% {
                transform: translateY(-10vh) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(110vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Animation BÃO TIM (Nhanh hơn, Xoay điên cuồng hơn) */
        @keyframes superFall {
            0% {
                transform: translateY(-10vh) rotate(0deg) scale(1);
                opacity: 1;
            }

            50% {
                transform: translateY(50vh) rotate(720deg) scale(1.5);
                opacity: 1;
            }

            100% {
                transform: translateY(110vh) rotate(1440deg) scale(1);
                opacity: 0;
            }
        }

        .heart-rain {
            position: fixed;
            top: -10%;
            z-index: 9999;
            user-select: none;
            pointer-events: none;
            animation-name: fall;
            animation-timing-function: linear;
        }

        .heart-rain.super {
            animation-name: superFall;
            /* Dùng animation bão */
            filter: drop-shadow(0 0 10px rgba(244, 63, 94, 0.8));
            /* Phát sáng */
        }

        .page-content {
            padding: 20px;
        }

        /* Container của item sự kiện */
        .event-swipe-container {
            position: relative;
            overflow: hidden;
            /* Che đi phần nút bị đẩy ra ngoài */
        }

        /* Các nút hành động (Nằm chìm bên dưới) */
        .event-actions {
            position: absolute;
            top: 0;
            bottom: 0;
            right: 0;
            width: 120px;
            /* Chiều rộng khu vực nút */
            display: flex;
            z-index: 0;
        }

        /* Nội dung chính (Nằm đè lên trên) */
        .event-content {
            position: relative;
            z-index: 10;
            background-color: white;
            /* Cần màu nền để che nút bên dưới */
            transition: transform 0.2s ease-out;
            /* Hiệu ứng trượt mượt */
            width: 100%;
        }

        /* Class kích hoạt khi đã vuốt sang trái */
        .event-content.swiped {
            transform: translateX(-120px) !important;
            /* Trượt sang trái để lộ nút */
        }
    </style>
</head>

<body class="text-gray-800">

    <div class="heart-bg" id="heart-bg"></div>

    <audio id="bg-music" loop></audio>

    <div id="mini-player" class="fixed bottom-12 z-50 flex items-center justify-end  w-full justify-center  ">
        <div id="player-island" onclick="toggleExpandPlayer()"
            class="bg-[--love-300] text-love-500 shadow-xl cursor-pointer w-8 h-8 rounded-full relative transition-all duration-500 ease-[cubic-bezier(0.175,0.885,0.32,1.275)] flex items-center justify-center overflow-hidden border border-pink-100 flex gap-2 bg-white/80 backdrop-blur-xl px-1 py-1 rounded-full shadow-2xl border border-white/50 pointer-events-auto transition-all hover:scale-105 ">

            <div id="player-collapsed"
                class="absolute inset-0 flex items-center justify-center transition-opacity duration-300">
                <i class="fas fa-music text-xs text-[--love-500]"></i>
            </div>

            <div id="player-expanded"
                class="flex items-center justify-between w-full px-2 opacity-0 pointer-events-none transition-opacity duration-300 absolute">

                <div class="w-24 mr-1">
                    <p id="player-title" class="text-[10px] font-bold text-[--love-500] truncate">Chọn bài hát</p>
                </div>



                <div class="flex items-center gap-2">
                    <button onclick="event.stopPropagation(); prevSong()" class="text-gray-400 hover:text-white"><i
                            class="fas fa-step-backward text-[10px]"></i></button>
                    <button onclick="event.stopPropagation(); togglePlayMusic()"
                        class="text-[--love-500] w-5 h-5 flex items-center justify-center">
                        <i id="player-play-icon" class="fas fa-play text-[10px] ml-0.5"></i>
                    </button>
                    <button onclick="event.stopPropagation(); nextSong()" class="text-gray-400 hover:text-white"><i
                            class="fas fa-step-forward text-[10px]"></i></button>
                </div>
                <button id="btn-live-mode" onclick="event.stopPropagation(); toggleLiveMode()"
                    class="px-1.5 py-0.5 rounded-full flex items-center gap-1 bg-[--love-500] text-white transition ml-2 group">
                    <div id="live-dot"
                        class="w-1.5 h-1.5 rounded-full text-white  bg-black group-hover:bg-white transition-colors">
                    </div>
                    <span class="text-[8px] font-bold text-white group-hover:text-white">LIVE</span>
                </button>
            </div>
        </div>
    </div>

    <div id="auth-screen" class="overlay-screen">
        <div class="bg-white p-8 rounded-[2.5rem] shadow-xl w-full max-w-sm text-center border border-love-100">
            <h1 class="text-4xl font-script text-love-500 mb-2">Love Story</h1>
            <p class="text-gray-500 text-sm mb-6">Nơi lưu giữ những kỷ niệm ngọt ngào</p>
            <div id="auth-forms">
                <div id="login-form">
                    <input type="email" id="login-email" placeholder="Email" class="w-full rounded-input mb-3 text-sm">
                    <input type="password" id="login-password" placeholder="Mật khẩu"
                        class="w-full rounded-input mb-4 text-sm">
                    <button onclick="handleLogin()"
                        class="w-full bg-love-500 hover:bg-love-600 text-white py-3 rounded-full font-bold shadow-lg shadow-love-200 transition mb-3">Đăng
                        Nhập</button>
                    <p class="text-xs text-gray-400">Chưa có tài khoản? <button onclick="toggleAuthMode()"
                            class="text-love-500 font-bold underline">Đăng ký ngay</button></p>
                </div>
                <div id="register-form" class="hidden">
                    <input type="email" id="reg-email" placeholder="Email đăng ký"
                        class="w-full rounded-input mb-3 text-sm">
                    <input type="password" id="reg-password" placeholder="Mật khẩu (tối thiểu 6 ký tự)"
                        class="w-full rounded-input mb-4 text-sm">
                    <button onclick="handleRegister()"
                        class="w-full bg-white border border-love-500 text-love-500 hover:bg-love-50 py-3 rounded-full font-bold shadow-sm transition mb-3">Đăng
                        Ký</button>
                    <p class="text-xs text-gray-400">Đã có tài khoản? <button onclick="toggleAuthMode()"
                            class="text-love-500 font-bold underline">Đăng nhập</button></p>
                </div>
            </div>
            <div id="auth-msg" class="text-love-500 font-bold text-xs mt-3 min-h-[1rem]"></div>
            <button id="retry-btn" onclick="location.reload()" class="hidden mt-4 text-gray-400 text-xs underline">Tải
                lại trang</button>
        </div>
    </div>

    <div id="pairing-screen" class="overlay-screen hidden-screen">
        <div
            class="bg-white p-8 rounded-[2.5rem] shadow-xl w-full max-w-sm text-center border border-love-100 relative">
            <button onclick="logout()" class="absolute top-4 right-4 text-gray-400 hover:text-red-500 text-xs"><i
                    class="fas fa-sign-alt"></i></button>
            <i class="fas fa-heart text-4xl text-love-300 mb-4 animate-pulse"></i>
            <h2 class="text-2xl font-bold text-gray-800 mb-2">Kết nối đôi lứa</h2>
            <p class="text-xs text-gray-500 mb-6">Bạn chưa kết nối với ai. Hãy tạo mã mới hoặc nhập mã từ người ấy nhé!
            </p>
            <div class="space-y-4">
                <div class="bg-love-50 p-4 rounded-2xl border border-love-100">
                    <h3 class="font-bold text-love-600 text-sm mb-2">Cách 1: Tạo mã mới</h3>
                    <button onclick="createCoupleCode()"
                        class="w-full bg-love-500 text-white py-2 rounded-xl text-sm font-bold shadow-md">Tạo mã tình
                        yêu</button>
                </div>
                <div class="relative flex py-1 items-center">
                    <div class="flex-grow border-t border-gray-200"></div><span
                        class="flex-shrink-0 mx-4 text-gray-300 text-xs">HOẶC</span>
                    <div class="flex-grow border-t border-gray-200"></div>
                </div>
                <div class="bg-gray-50 p-4 rounded-2xl border border-gray-100">
                    <h3 class="font-bold text-gray-600 text-sm mb-2">Cách 2: Nhập mã</h3>
                    <input type="text" id="join-code-input" placeholder="Nhập mã (Ví dụ: LOVE-123)"
                        class="w-full rounded-input mb-2 text-center uppercase font-bold tracking-widest text-sm">
                    <button onclick="joinCouple()"
                        class="w-full bg-gray-800 text-white py-2 rounded-xl text-sm font-bold shadow-md">Kết
                        nối</button>
                </div>
            </div>
            <div id="pair-msg" class="text-red-500 text-xs mt-3 h-4"></div>
        </div>
    </div>

    <div id="app-container" class="max-w-md mx-auto bg-white h-screen shadow-2xl relative overflow-hidden">

        <div id="swipe-wrapper" class="flex h-full transition-transform duration-300 ease-out will-change-transform">
            <div id="page-0"
                class="page-section page-content w-full flex-shrink-0 h-full overflow-y-auto hide-scrollbar ">
                <div class="flex flex-col justify-around h-[calc(100vh-140px)]">

                    <div
                        class="glass-card-special bg-white/60 rounded-[2rem] p-6 text-center shadow-lg shadow-love-100/20 border border-white/40 mb-auto mt-4">
                        <p class="text-gray-500 text-sm font-semibold tracking-wide uppercase mb-2">Hành trình yêu
                            thương
                        </p>
                        <div class="relative inline-block flex justify-center">
                            <h2 id="total-days"
                                class="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-love-500 to-love-600 mb-0 leading-none">
                                0</h2>
                            <p class="text-love-400 font-bold text-lg mt-6">Ngày</p>

                        </div>

                        <div class="grid grid-cols-3 gap-3 mt-4 text-sm">
                            <div class="bg-white p-2 rounded-2xl shadow-md shadow-gray-100 border border-gray-50">
                                <span id="count-years" class="block font-black text-xl text-gray-700">0</span>
                                <span class="text-gray-400 text-xs font-bold uppercase">Năm</span>
                            </div>
                            <div class="bg-white p-2 rounded-2xl shadow-md shadow-gray-100 border border-gray-50">
                                <span id="count-months" class="block font-black text-xl text-gray-700">0</span>
                                <span class="text-gray-400 text-xs font-bold uppercase">Tháng</span>
                            </div>
                            <div class="bg-white p-2 rounded-2xl shadow-md shadow-gray-100 border border-gray-50">
                                <span id="count-days" class="block font-black text-xl text-gray-700">0</span>
                                <span class="text-gray-400 text-xs font-bold uppercase">Ngày</span>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center justify-between relative px-2">

                        <div class="flex flex-col items-center w-1/3 group relative">
                            <div id="status-bubble-1"
                                class="hidden absolute -top-12 bg-white px-3 py-2 rounded-2xl shadow-lg border border-love-100 text-xs text-gray-600 w-32 text-center status-bubble z-10 transition-all">
                                <span id="status-text-1" class="break-words"></span>
                            </div>
                            <div class="relative transition-transform transform group-hover:scale-105">
                                <img id="u1-avatar"
                                    src="https://graph.facebook.com/100045640179308/picture?type=large&amp;access_token=6628568379|c1e620fa708a1d5696fb991c1bde5662"
                                    class="w-24 h-24 rounded-full object-cover avatar-frame bg-blue-50 cursor-pointer"
                                    onclick="openStatusModal()">
                                <div class="absolute -bottom-2 -right-1 bg-white rounded-full p-1 shadow-md">
                                    <i
                                        class="fas fa-mars text-blue-400 text-sm w-5 h-5 flex items-center justify-center"></i>
                                </div>
                            </div>
                            <span id="u1-name" class="font-bold mt-3 text-love-600 text-lg text-shadow-lg/30 ">Anh yêu
                                ❤️</span>
                        </div>

                        <div class="flex flex-col items-center justify-center w-1/3 cursor-pointer group pb-8"
                            onclick="handleHeartClick()">
                            <div
                                class="relative transition-transform duration-300 transform group-hover:scale-125 active:scale-90">
                                <div
                                    class="absolute inset-0 bg-love-500 blur-xl opacity-20 group-hover:opacity-40 transition-opacity rounded-full">
                                </div>

                                <i id="main-heart-icon"
                                    class="fas fa-heart text-5xl text-love-500 animate-pulse-slow drop-shadow-lg relative z-10 transition-colors duration-500"></i>
                                <i
                                    class="fas fa-heart text-2xl text-white absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-30 z-10"></i>
                            </div>
                        </div>

                        <div class="flex flex-col items-center w-1/3 group relative">
                            <div id="status-bubble-2"
                                class="hidden absolute -top-12 bg-white px-3 py-2 rounded-2xl shadow-lg border border-love-100 text-xs text-gray-600 w-32 text-center status-bubble z-10 transition-all">
                                <span id="status-text-2" class="break-words"></span>

                            </div>
                            <div class="relative transition-transform transform group-hover:scale-105">
                                <img id="u2-avatar"
                                    src="https://graph.facebook.com/100074217488487/picture?type=large&amp;access_token=6628568379|c1e620fa708a1d5696fb991c1bde5662"
                                    class="w-24 h-24 rounded-full object-cover avatar-frame bg-pink-50 cursor-pointer"
                                    onclick="openStatusModal()">
                                <div class="absolute -bottom-2 -right-1 bg-white rounded-full p-1 shadow-md">
                                    <i
                                        class="fas fa-venus text-pink-400 text-sm w-5 h-5 flex items-center justify-center"></i>
                                </div>
                            </div>
                            <span id="u2-name" class="font-bold mt-3 text-love-600 text-lg">Em yêu ❤️</span>
                        </div>
                    </div>

                </div>
            </div>

            <div id="page-1"
                class="page-section page-content w-full flex-shrink-0 h-full overflow-y-auto hide-scrollbar pb-20">
                <div
                    class="flex justify-between items-center mb-2 px-2 glass-card-special bg-white/60 rounded-[2rem] p-2 pl-4 text-center shadow-lg shadow-love-100/20 border border-white/40  rounded-2xl ">
                    <h2 class="text-2xl font-bold text-gray-800">Mục tiêu chung</h2>
                    <div class="bg-love-100 text-love-500 px-3 py-1 rounded-full text-xs font-bold">
                        <span id="todo-count">0</span> mục tiêu
                    </div>
                </div>

                <div
                    class="glass-card-special bg-white/60 rounded-[2rem] p-2 pl-4 text-center shadow-lg shadow-love-100/20 border border-white/40  rounded-2xl  p-5 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-gray-700 flex items-center gap-2"><i
                                class="fas fa-tasks text-love-500"></i> Danh sách</h3>
                        <button onclick="toggleTodoForm()"
                            class="bg-gray-100 w-8 h-8 rounded-full text-gray-500 hover:bg-love-50 hover:text-love-500"><i
                                class="fas fa-plus"></i></button>
                    </div>

                    <div id="todo-form" class="hidden mb-4 bg-gray-50 p-3 rounded-xl">
                        <input type="text" id="todo-input" placeholder="Việc cần làm..."
                            class="w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm mb-2 focus:outline-none focus:border-love-300">
                        <div class="flex gap-2">
                            <input type="date" id="todo-deadline"
                                class="w-2/3 bg-white border border-gray-200 rounded-lg px-3 py-2 text-xs">
                            <button onclick="addTodo()"
                                class="w-1/3 bg-love-500 text-white rounded-lg font-bold text-xs">Thêm</button>
                        </div>
                    </div>

                    <div id="todo-list" class="space-y-2">
                    </div>
                </div>
            </div>

            <div id="status-modal" class="fixed inset-0 bg-black/50 z-[60] hidden flex items-center justify-center p-4">
                <div class="bg-white rounded-3xl p-6 w-full max-w-sm relative">
                    <button onclick="document.getElementById('status-modal').classList.add('hidden')"
                        class="absolute top-4 right-4 text-gray-400"><i class="fas fa-times"></i></button>
                    <h3 class="font-bold text-lg mb-4 text-center">Bạn đang nghĩ gì?</h3>
                    <textarea id="status-input" class="w-full rounded-xl border border-gray-200 p-3 mb-4 text-sm h-24"
                        placeholder="Nhập cảm nhận của bạn..."></textarea>
                    <div class="mb-4">
                        <label class="block text-xs font-bold text-gray-500 mb-2">Tự động xóa sau:</label>
                        <select id="status-duration"
                            class="w-full rounded-xl border border-gray-200 p-2 text-sm bg-white"
                            onchange="toggleCustomTime()">
                            <option value="60">1 Giờ</option>
                            <option value="1440" selected>24 Giờ</option>
                            <option value="-1">Vĩnh viễn (Không xóa)</option>
                            <option value="custom">Tùy chỉnh...</option>
                        </select>
                        <div id="custom-time-input" class="hidden mt-2 flex gap-2 items-center">
                            <input type="number" id="custom-hours" placeholder="Giờ"
                                class="w-1/2 p-2 border rounded-xl text-sm">
                            <input type="number" id="custom-minutes" placeholder="Phút"
                                class="w-1/2 p-2 border rounded-xl text-sm">
                        </div>
                    </div>
                    <button onclick="saveStatus()"
                        class="w-full bg-love-500 text-white py-3 rounded-xl font-bold shadow-md">Cập nhật trạng
                        thái</button>
                </div>
            </div>

            <div id="page-2"
                class="page-section page-content w-full flex-shrink-0 h-full overflow-y-auto hide-scrollbar  text-center h-[calc(100vh-100px)] flex flex-col justify-center items-center p-5 ">
                <div
                    class="w-full glass-card-special bg-white/60 rounded-[2.5rem] p-6 text-center shadow-lg shadow-love-100/20 border border-white/40 mb-auto mt-4">
                    <div class="mb-2">
                        <div class="relative w-40 h-40 mx-auto flex items-center justify-center">
                            <div class="absolute inset-0 bg-orange-50 rounded-full animate-pulse opacity-70"></div>
                            <div id="fire-glow"
                                class="absolute inset-4 rounded-full animate-pulse opacity-50 animation-delay-500 bg-orange-100 transition-colors duration-500">
                            </div>
                            <i id="fire-icon"
                                class="fas fa-fire text-8xl drop-shadow-2xl relative z-10 animate-float text-orange-500 transition-colors duration-500"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mt-2">Lửa Tình Yêu</h2>
                        <div class="text-7xl font-black text-transparent bg-clip-text bg-gradient-to-b from-orange-400 to-love-600 my-1"
                            id="streak-count">0</div>
                        <p class="text-black-400 font-bold uppercase tracking-wider text-xs">Ngày liên tiếp giữ lửa</p>
                        <div id="streak-milestone" class="text-xs font-bold mt-2 text-love-500 h-4"></div>
                    </div>

                    <div
                        class="bg-white rounded-[2.5rem] shadow-xl shadow-orange-100/50 p-4 border border-orange-50 w-full max-w-sm mx-auto">
                        <div class="flex justify-between items-center gap-4">
                            <div class="flex-1 flex flex-col items-center group">
                                <img id="spark-u1-img" src=""
                                    class="w-16 h-16 rounded-full mb-3 object-cover border-4 border-transparent">
                                <button id="btn-checkin-1" onclick="checkIn(1)"
                                    class="w-full py-2.5 rounded-2xl text-xs font-bold transition-all transform active:scale-95 shadow-sm">Điểm
                                    danh</button>
                            </div>
                            <div class="h-20 w-px bg-gray-200"></div>
                            <div class="flex-1 flex flex-col items-center group">
                                <img id="spark-u2-img" src=""
                                    class="w-16 h-16 rounded-full mb-3 object-cover border-4 border-transparent">
                                <button id="btn-checkin-2" onclick="checkIn(2)"
                                    class="w-full py-2.5 rounded-2xl text-xs font-bold transition-all transform active:scale-95 shadow-sm">Điểm
                                    danh</button>
                            </div>
                        </div>
                        <div id="streak-message"
                            class="mt-6 py-3 px-4 bg-orange-50 rounded-4xl text-sm font-bold text-orange-600 hidden border border-orange-100">
                            <i class="fas fa-fire-alt mr-2"></i>Tuyệt vời! Lửa đã được giữ!
                        </div>
                    </div>
                </div>
            </div>

            <div id="page-3"
                class="page-section page-content w-full flex-shrink-0 h-full overflow-y-auto hide-scrollbar pb-20">
                <div
                    class="flex justify-between items-end mb-2 px-1 glass-card-special bg-white/60 rounded-[2rem] p-2 px-3 text-center shadow-lg shadow-love-100/20 border border-white/40  rounded-2xl ">
                    <h3 class="font-bold text-gray-800 text-2xl">Sự kiện sắp tới</h3>
                    <button onclick="toggleEventForm()"
                        class="text-white bg-love-500 hover:bg-love-600 px-4 py-2 rounded-full text-xs font-bold shadow-md flex items-center gap-2">
                        <i class="fas fa-plus"></i> Thêm
                    </button>
                </div>

                <div id="event-form"
                    class="hidden bg-white p-6 rounded-[2rem] shadow-xl shadow-gray-100 mb-6 border border-gray-100 transition-all relative z-20 glass-card-special bg-white/60 rounded-[2rem] p-2 pl-4 text-center shadow-lg shadow-love-100/20 border border-white/40  rounded-2xl ">
                    <h4 class="font-bold text-gray-700 mb-4" id="event-form-title">Sự kiện mới</h4>
                    <input type="hidden" id="event-id">
                    <input type="text" id="event-title" placeholder="Tên sự kiện"
                        class="w-full rounded-input mb-3 bg-gray-50 text-sm">
                    <input type="date" id="event-date" class="w-full rounded-input mb-3 bg-gray-50 text-sm">

                    <div class="mb-3">
                        <div class="flex gap-2">
                            <input type="text" id="event-bg" placeholder="Link ảnh nền..."
                                class="flex-grow rounded-input bg-gray-50 text-xs">
                            <button
                                onclick="openFilePicker((url) => { document.getElementById('event-bg').value = url; })"
                                class="w-10 h-10 rounded-xl bg-gray-200 text-gray-600 flex items-center justify-center">
                                <i class="fas fa-image"></i>
                            </button>
                        </div>
                    </div>

                    <div class="relative mb-4">
                        <select id="event-recur"
                            class="w-full rounded-input bg-gray-50 text-sm appearance-none cursor-pointer">
                            <option value="none">Chỉ một lần</option>
                            <option value="year">Lặp lại hàng năm</option>
                            <option value="month">Lặp lại hàng tháng</option>
                        </select>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="toggleEventForm()"
                            class="flex-1 bg-gray-200 text-gray-600 py-3 rounded-full text-sm font-bold">Hủy</button>
                        <button id="btn-save-event" onclick="saveEvent(this)"
                            class="flex-1 bg-gray-800 text-white py-3 rounded-full text-sm font-bold">Lưu</button>
                    </div>
                </div>

                <div id="events-list"
                    class="space-y-2 glass-card-special bg-white/60 rounded-[2rem] p-2  text-center shadow-lg shadow-love-100/20 border border-white/40  rounded-2xl">
                </div>
            </div>

            <div id="page-4"
                class="page-section page-content w-full flex-shrink-0 h-full overflow-y-auto hide-scrollbar pb-20">
                <div
                    class="flex justify-between items-center mb-6 px-2 glass-card-special bg-white/60 rounded-[2rem] p-2 pl-4 text-center shadow-lg shadow-love-100/20 border border-white/40  rounded-2xl">
                    <h2 class="text-xl font-bold text-gray-800">Dòng thời gian</h2>
                    <div class="flex gap-2">
                        <select id="filter-author" onchange="updateDiaryPage()"
                            class="bg-white border border-gray-200 text-xs rounded-full px-3 py-1.5 focus:outline-none">
                            <option value="all">Tất cả</option>
                            <option value="me">Của tôi</option>
                            <option value="partner">Của người ấy</option>
                        </select>
                    </div>
                </div>

                <div class="bg-white p-4 rounded-3xl shadow-sm border border-gray-100 mb-6">
                    <textarea id="diary-content" rows="3"
                        class="w-full bg-gray-50 rounded-2xl p-4 text-sm focus:outline-none focus:ring-2 ring-love-100 transition resize-none"
                        placeholder="Hôm nay bạn thế nào?"></textarea>

                    <div id="diary-media-preview" class="flex gap-2 flex-wrap mt-3 empty:hidden"></div>

                    <div class="flex justify-between items-center mt-2">
                        <label
                            class="cursor-pointer text-gray-400 hover:text-love-500 transition flex items-center gap-2 text-xs bg-gray-50 px-3 py-1.5 rounded-full hover:bg-gray-100">
                            <i class="fas fa-images"></i>
                            <span id="file-count">Thêm ảnh/video</span>

                            <input type="file" id="diary-files" multiple class="hidden"
                                onchange="handleFileSelect(this)">
                        </label>

                        <div class="flex gap-2">
                            <button id="btn-cancel-edit" onclick="cancelEdit()"
                                class="hidden text-gray-400 text-xs hover:text-gray-600 font-bold px-2">Hủy</button>
                            <button id="btn-post-diary" onclick="postDiary()"
                                class="bg-love-500 hover:bg-love-600 text-white px-5 py-1.5 rounded-full text-xs font-bold shadow-sm shadow-love-200 transition-all transform active:scale-95">
                                Đăng
                            </button>
                        </div>
                    </div>
                </div>


                <div id="diary-feed" class="relative  pb-24">

                </div>
            </div>

            <div id="page-5"
                class="page-section page-content w-full flex-shrink-0 h-full overflow-y-auto hide-scrollbar pb-20">
                <div
                    class="flex justify-between items-center mb-2 px-2 glass-card-special bg-white/60 rounded-[2rem] p-2 pl-4 text-center shadow-lg shadow-love-100/20 border border-white/40  rounded-2xl ">
                    <h2 class="text-2xl font-bold text-gray-800">Kho lưu trữ</h2>
                    <div class="flex gap-2">
                        <button id="btn-toggle-select" onclick="toggleGallerySelectMode()"
                            class="px-3 py-1 rounded-full bg-gray-100 text-gray-600 text-xs font-bold hover:bg-gray-200 transition">
                            Chọn
                        </button>

                        <button onclick="toggleGalleryUpload()"
                            class="bg-love-500 text-white w-8 h-8 rounded-full shadow-lg shadow-love-200 flex items-center justify-center hover:bg-love-600 transition">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button onclick="loadGallery()"
                            class="text-gray-400 hover:text-love-500 w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>

                <div id="gallery-upload-form"
                    class="hidden bg-white p-4 rounded-[2rem] shadow-xl border border-love-100 mb-6 animate-slide-down relative z-20">
                    <h3 class="font-bold text-gray-700 mb-3 text-sm">Tải lên tập tin mới</h3>

                    <div class="mb-3">
                        <label class="block text-xs font-bold text-gray-400 uppercase mb-1">Lưu vào thư mục</label>
                        <select id="upload-target-folder"
                            class="w-full rounded-xl border border-gray-200 p-2 text-sm bg-gray-50 focus:border-love-300 outline-none">
                            <option value="files">Chung</option>
                            <option value="posts">Nhật ký (Posts)</option>
                            <option value="events">Sự kiện (Events)</option>
                            <option value="backgrounds">Hình nền (Backgrounds)</option>
                            <option value="avatars">Ảnh đại diện (Avatars)</option>
                        </select>
                    </div>

                    <div class="mb-4">
                        <label
                            class="block w-full text-center bg-gray-50 border-2 border-dashed border-gray-300 rounded-2xl p-6 cursor-pointer hover:bg-love-50 hover:border-love-300 transition group">
                            <i
                                class="fas fa-cloud-upload-alt text-2xl text-gray-400 group-hover:text-love-500 mb-2"></i>
                            <p class="text-xs text-gray-500 group-hover:text-love-500 font-bold">Chạm để chọn ảnh/video
                            </p>
                            <input type="file" id="gallery-upload-input" multiple accept="image/*,video/*"
                                class="hidden" onchange="updateUploadLabel()">
                        </label>
                        <p id="upload-file-label" class="text-center text-[10px] text-gray-400 mt-2 h-4 truncate"></p>
                    </div>

                    <div class="flex gap-2">
                        <button onclick="toggleGalleryUpload()"
                            class="flex-1 bg-gray-100 text-gray-600 py-2.5 rounded-xl text-sm font-bold">Hủy</button>
                        <button onclick="executeGalleryUpload(this)"
                            class="flex-1 bg-love-500 text-white py-2.5 rounded-xl text-sm font-bold shadow-md shadow-love-200">Tải
                            lên ngay</button>
                    </div>
                </div>

                <div id="gallery-toolbar"
                    class="hidden sticky top-0 z-10 bg-white/90 backdrop-blur-md p-3 rounded-2xl shadow-lg mb-4 flex justify-between items-center border border-love-100 animate-slide-down">
                    <div class="flex items-center gap-2">
                        <input type="checkbox" id="select-all-files" onchange="toggleSelectAllFiles()"
                            class="w-4 h-4 rounded text-love-500 focus:ring-love-500 cursor-pointer">
                        <span class="text-xs font-bold text-gray-600" id="selected-count">0 đã chọn</span>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="downloadSelectedFiles()"
                            class="w-8 h-8 rounded-full bg-blue-50 text-blue-500 flex items-center justify-center hover:bg-blue-100"><i
                                class="fas fa-download text-xs"></i></button>
                        <button onclick="deleteSelectedFiles()"
                            class="w-8 h-8 rounded-full bg-red-50 text-red-500 flex items-center justify-center hover:bg-red-100"><i
                                class="fas fa-trash text-xs"></i></button>
                    </div>
                </div>

                <div id="gallery-grid"
                    class="glass-card-special bg-white/60 rounded-[2rem] p-2 text-center shadow-lg shadow-love-100/20 border border-white/40 mb-auto mt-2 grid grid-cols-3 gap-1 rounded-2xl overflow-hidden">
                    <div class="col-span-3 text-center py-10 text-gray-400 text-xs italic">Đang tải dữ liệu...</div>
                </div>
            </div>

            <div id="page-6"
                class="page-section page-content w-full flex-shrink-0 h-full overflow-y-auto hide-scrollbar pb-24">
                <h2
                    class="text-2xl font-bold mb-5 text-gray-800 px-4 pt-2 glass-card-special bg-white/60 rounded-[2rem] p-2 pl-4 text-center shadow-lg shadow-love-100/20 border border-white/40  rounded-2xl">
                    Cài đặt</h2>

                <div class="bg-white rounded-[2rem] shadow-xl shadow-gray-100/50 p-5 mb-5 border border-white/60 ">
                    <div class="flex items-center gap-3 mb-5 pb-3 border-b border-gray-50">
                        <div
                            class="w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center text-blue-500 shadow-sm">
                            <i class="fas fa-user-edit"></i>
                        </div>
                        <h3 class="font-bold text-gray-700">Thông tin Love Profile</h3>
                    </div>

                    <div class="mb-5 relative">
                        <label
                            class="z-10 rounded-full absolute -top-2 left-3 bg-white px-2 text-[10px] font-bold text-love-500 uppercase">Ngày
                            bắt đầu yêu</label>
                        <input type="date" id="set-start-date"
                            class="w-full rounded-2xl border-2 border-love-50 p-3 text-sm font-bold text-gray-700 text-center bg-white focus:border-love-300 outline-none">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="flex flex-col gap-2">
                            <div class="text-center">
                                <span
                                    class="text-[10px] font-black text-blue-400 uppercase tracking-widest bg-blue-50 px-2 py-0.5 rounded-md">Bạn
                                    Nam</span>
                            </div>
                            <div class="relative w-20 h-20 mx-auto group cursor-pointer" onclick="openFilePicker((url) => { 
                                    document.getElementById('preview-ava-1').src = url; 
                                    document.getElementById('set-ava-1').value = url; 
                                })">
                                <img id="preview-ava-1" src="/Asset/logo/iconApps.png"
                                    class="w-full h-full rounded-full object-cover border-2 border-gray-100 shadow-sm">
                                <label
                                    class="absolute inset-0 bg-black/30 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                    <i class="fas fa-camera text-white"></i>
                                </label>
                            </div>
                            <input type="hidden" id="set-ava-1">

                            <input type="text" id="set-name-1" placeholder="Biệt danh"
                                class="w-full text-center rounded-lg text-xs font-bold border-b border-gray-200 p-1 focus:border-blue-400 outline-none bg-transparent">
                            <input type="date" id="set-dob-1"
                                class="w-full text-[10px] text-gray-500 bg-gray-50 rounded-lg p-1 text-center border-none">
                        </div>

                        <div class="flex flex-col gap-2 border-l border-gray-50 pl-4">
                            <div class="text-center">
                                <span
                                    class="text-[10px] font-black text-pink-400 uppercase tracking-widest bg-pink-50 px-2 py-0.5 rounded-md">Bạn
                                    Nữ</span>
                            </div>
                            <div class="relative w-20 h-20 mx-auto group cursor-pointer" onclick="openFilePicker((url) => { 
                                    document.getElementById('preview-ava-2').src = url; 
                                    document.getElementById('set-ava-2').value = url; 
                                })">
                                <img id="preview-ava-2" src="/Asset/logo/iconApps.png"
                                    class="w-full h-full rounded-full object-cover border-2 border-gray-100 shadow-sm">
                                <label
                                    class="absolute inset-0 bg-black/30 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                    <i class="fas fa-camera text-white"></i>
                                </label>
                            </div>
                            <input type="hidden" id="set-ava-2">

                            <input type="text" id="set-name-2" placeholder="Biệt danh"
                                class="w-full text-center rounded-lg text-xs font-bold border-b border-gray-200 p-1 focus:border-pink-400 outline-none bg-transparent">
                            <input type="date" id="set-dob-2"
                                class="w-full text-[10px] text-gray-500 bg-gray-50 rounded-lg p-1 text-center border-none">
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-[2rem] shadow-xl shadow-gray-100/50 p-5 mb-5 border border-white/60 mx-2">


                    <div class="flex items-center gap-3 mb-4">
                        <div
                            class="w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-500 shadow-sm">
                            <i class="fas fa-paint-brush text-xs"></i>
                        </div>
                        <h3 class="font-bold text-gray-700 text-sm uppercase tracking-wide">Giao diện</h3>
                    </div>

                    <div class="space-y-4">
                        <div
                            class="flex justify-between items-center bg-gray-50 p-3 rounded-2xl border border-gray-100">
                            <span class="text-xs font-bold text-gray-500">Màu chủ đạo</span>
                            <div class="flex gap-2">
                                <button onclick="setThemeColor('pink')"
                                    class="w-6 h-6 rounded-full bg-[#f43f5e] ring-2 ring-transparent focus:ring-gray-300 shadow-sm transition-transform active:scale-90"></button>
                                <button onclick="setThemeColor('blue')"
                                    class="w-6 h-6 rounded-full bg-[#3b82f6] ring-2 ring-transparent focus:ring-gray-300 shadow-sm transition-transform active:scale-90"></button>
                                <button onclick="setThemeColor('green')"
                                    class="w-6 h-6 rounded-full bg-[#10b981] ring-2 ring-transparent focus:ring-gray-300 shadow-sm transition-transform active:scale-90"></button>
                                <button onclick="setThemeColor('purple')"
                                    class="w-6 h-6 rounded-full bg-[#8b5cf6] ring-2 ring-transparent focus:ring-gray-300 shadow-sm transition-transform active:scale-90"></button>
                                <button onclick="setThemeColor('yellow')"
                                    class="w-6 h-6 rounded-full bg-[#f59e0b] ring-2 ring-transparent focus:ring-gray-300 shadow-sm transition-transform active:scale-90"></button>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-[10px] font-bold text-gray-400 uppercase mb-1 ml-1">Phông
                                    chữ</label>
                                <select id="set-font"
                                    class="w-full rounded-xl bg-gray-50 border border-gray-100 text-xs p-2.5 focus:border-love-300 outline-none">
                                    <option value="Nunito">Nunito (Tròn)</option>
                                    <option value="Lora">Lora (Sang)</option>
                                    <option value="Comfortaa">Comfortaa (Phá cách)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-[10px] font-bold text-gray-400 uppercase mb-1 ml-1">Độ trong
                                    suốt: <span id="opacity-value" class="text-love-500">20%</span></label>
                                <input type="range" id="set-opacity" min="0" max="0.95" step="0.05" value="0.2"
                                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-love-500 mt-2"
                                    oninput="updateGlassPreview(this.value)">
                            </div>
                        </div>

                        <div>
                            <label class="block text-[10px] font-bold text-gray-400 uppercase mb-1 ml-1">Hình nền
                                App</label>
                            <div class="flex gap-2">
                                <div class="relative flex-grow">
                                    <input type="text" id="set-bg-url" placeholder="Link ảnh..."
                                        class="w-full rounded-xl bg-gray-50 border border-gray-100 text-xs p-2.5 pl-8 focus:border-love-300 outline-none"
                                        onchange="previewBackground(this.value)">
                                    <i class="fas fa-image absolute left-3 top-3 text-gray-400 text-xs"></i>
                                </div>

                                <button onclick="openFilePicker((url) => { 
                    document.getElementById('set-bg-url').value = url; 
                    previewBackground(url); 
                })" class="flex-shrink-0 w-10 h-10 bg-love-50 text-love-500 rounded-xl flex items-center justify-center cursor-pointer hover:bg-love-100 transition shadow-sm border border-love-100">
                                    <i class="fas fa-cloud-upload-alt text-sm"></i>
                                </button>
                            </div>

                            <div class="text-right mt-1">
                                <button onclick="clearBackground()"
                                    class="text-[10px] text-red-400 hover:text-red-600 font-bold px-2">Xóa nền</button>
                            </div>
                        </div>
                    </div>

                    <div class="h-px bg-gray-100 my-2 mx-2"></div>

                    <div class="flex items-center gap-3 mb-4">
                        <div
                            class="w-8 h-8 rounded-full bg-orange-100 flex items-center justify-center text-orange-500 shadow-sm">
                            <i class="fas fa-music text-xs"></i>
                        </div>
                        <h3 class="font-bold text-gray-700 text-sm uppercase tracking-wide">Nhạc nền</h3>
                    </div>

                    <div class="space-y-2 mb-3 max-h-40 overflow-y-auto pr-1 hide-scrollbar" id="playlist-container">
                    </div>

                    <div class="bg-gray-50 p-2 rounded-xl border border-gray-100 flex flex-col gap-2">
                        <div class="flex gap-2">
                            <input type="text" id="new-song-name" placeholder="Tên bài"
                                class="w-1/3 bg-white p-2 text-xs border border-gray-200 rounded-lg focus:outline-none">
                            <input type="text" id="new-song-url" placeholder="Link MP3..."
                                class="w-2/3 bg-white p-2 text-xs border border-gray-200 rounded-lg focus:outline-none">
                        </div>
                        <button onclick="addSongToPlaylist()"
                            class="w-full bg-orange-500 text-white py-1.5 rounded-lg text-xs font-bold hover:bg-orange-600 transition">Thêm
                            vào List</button>
                    </div>
                </div>



                <div class="mx-2 mb-5">
                    <button id="btn-save-settings" onclick="saveSettings(this)"
                        class="w-full bg-gray-800 text-white py-3.5 rounded-2xl font-bold text-sm hover:bg-black transition shadow-lg shadow-gray-300 flex items-center justify-center gap-2">
                        <i class="fas fa-save"></i> Lưu Thay Đổi
                    </button>
                </div>

                <div class="bg-white rounded-[2rem] shadow-lg p-5 mb-2 border border-gray-50 mx-2">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-[10px] text-gray-400 uppercase font-bold mb-1">Mã cặp đôi</p>
                            <div onclick="copyCoupleCode()"
                                class="text-love-500 font-black text-lg tracking-widest cursor-pointer hover:underline flex items-center gap-2">
                                <span id="display-couple-code">...</span> <i
                                    class="far fa-copy text-xs text-gray-300"></i>
                            </div>
                        </div>
                        <button onclick="changeCoupleCode()"
                            class="bg-gray-50 text-gray-500 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-love-50 hover:text-love-500 transition">
                            Đổi mã
                        </button>
                    </div>

                    <div class="h-px bg-gray-100 my-4"></div>

                    <button onclick="logout()"
                        class="w-full text-red-500 text-xs font-bold flex items-center justify-center gap-2 py-2 hover:bg-red-50 rounded-xl transition">
                        <i class="fas fa-sign-out-alt"></i> Đăng xuất khỏi thiết bị
                    </button>
                </div>

                <p class="text-center text-gray-300 text-[10px] mt-4 font-mono">Love App v2.0 - Built with ❤️</p>
            </div>
        </div>

        <div id="lightbox"
            class="fixed inset-0 z-[100] hidden bg-black/95 flex items-center justify-center backdrop-blur-sm transition-opacity duration-300 opacity-0 pointer-events-none">

            <button onclick="closeLightbox()"
                class="absolute top-4 right-4 text-white/70 hover:text-white z-[102] p-3 bg-black/20 rounded-full active:scale-90 transition">
                <i class="fas fa-times text-2xl"></i>
            </button>

            <button onclick="event.stopPropagation(); changeLightboxImage(-1)"
                class="absolute left-2 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white z-[102] p-3 rounded-full bg-black/10 hover:bg-black/40 active:scale-90 transition backdrop-blur-[2px]">
                <i class="fas fa-chevron-left text-2xl sm:text-3xl"></i>
            </button>

            <button onclick="event.stopPropagation(); changeLightboxImage(1)"
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white z-[102] p-3 rounded-full bg-black/10 hover:bg-black/40 active:scale-90 transition backdrop-blur-[2px]">
                <i class="fas fa-chevron-right text-2xl sm:text-3xl"></i>
            </button>

            <div id="lightbox-wrapper" class="w-full h-full flex items-center justify-center relative touch-none">
                <div id="lightbox-content" class="max-w-full max-h-full transition-transform duration-200 ease-out p-2">
                </div>
            </div>

            <div
                class="absolute bottom-6 left-1/2 transform -translate-x-1/2 text-white/80 text-xs font-bold bg-black/30 px-3 py-1 rounded-full backdrop-blur">
                <span id="lightbox-current">1</span> / <span id="lightbox-total">1</span>
            </div>
        </div>
    </div>

    <div class="fixed bottom-4 left-0 w-full z-40 flex justify-center pointer-events-none">
        <div id="pagination-dots"
            class="flex gap-2 bg-white/80 backdrop-blur-xl px-1 py-1 rounded-full shadow-2xl border border-white/50 pointer-events-auto transition-all hover:scale-105">
        </div>
    </div>

    <style>
        /* Style cho Nút tròn có Icon */
        .nav-dot {
            padding: 4px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.05);
            /* Nền xám nhạt khi chưa chọn */
            color: #9ca3af;
            /* Màu icon xám */
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            /* Hiệu ứng nảy */
            cursor: pointer;
            position: relative;
        }

        /* Trạng thái đang chọn */
        .nav-dot.active {
            background-color: var(--love-500);
            width: 30px;
            border-radius: 20px;
            /* Nền màu chủ đạo */
            color: white;
            /* Icon màu trắng */
            /* Nổi lên trên và to ra */
            box-shadow: 0 8px 10px var(--love-200);
            /* Đổ bóng màu hồng */
        }

        /* Icon bên trong */
        .nav-dot i {
            font-size: 10px;
            transition: transform 0.3s;
        }
    </style>

    <div id="sys-modal" class="fixed inset-0 z-[200] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="Modal.close()"></div>

        <div
            class="bg-white w-full max-w-sm rounded-[2rem] shadow-2xl relative z-10 overflow-hidden transform transition-all scale-100 p-6 border border-gray-100">
            <div
                class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-love-100 mb-4 animate-bounce">
                <i id="sys-modal-icon" class="fas fa-bell text-love-500 text-xl"></i>
            </div>

            <div class="text-center">
                <h3 class="text-lg font-bold text-gray-900" id="sys-modal-title">Thông báo</h3>
                <p class="text-sm text-gray-500 mt-2" id="sys-modal-msg">Nội dung thông báo...</p>

                <div id="sys-modal-input-container" class="hidden mt-4">
                    <input type="text" id="sys-modal-input"
                        class="w-full rounded-xl border border-gray-300 p-3 text-sm focus:border-love-500 focus:ring-2 focus:ring-love-200 outline-none"
                        placeholder="Nhập nội dung...">
                </div>
            </div>

            <div class="mt-6 flex gap-3 justify-center">
                <button id="sys-modal-cancel"
                    class="hidden flex-1 bg-gray-100 text-gray-700 px-4 py-2.5 rounded-xl text-sm font-bold hover:bg-gray-200 transition">
                    Hủy
                </button>
                <button id="sys-modal-ok"
                    class="flex-1 bg-love-500 text-white px-4 py-2.5 rounded-xl text-sm font-bold shadow-lg shadow-love-200 hover:bg-love-600 transition transform active:scale-95">
                    Đồng ý
                </button>
            </div>
        </div>
    </div>

    <div id="toast-container"
        class="fixed top-6 left-1/2 transform -translate-x-1/2 z-[300] flex flex-col items-center gap-3 w-full max-w-xs pointer-events-none">
    </div>

    <div id="file-picker-modal"
        class="fixed inset-0 z-[100] hidden flex items-end sm:items-center justify-center sm:p-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="closeFilePicker()"></div>

        <div
            class="bg-white w-full max-w-md rounded-t-[2rem] sm:rounded-[2rem] shadow-2xl relative z-10 overflow-hidden flex flex-col max-h-[85vh] animate-slide-up sm:animate-zoom-in">

            <div class="p-4 border-b border-gray-100 flex justify-between items-center bg-white sticky top-0 z-20">
                <h3 class="font-bold text-gray-800 text-lg">Chọn tệp tin</h3>
                <button onclick="closeFilePicker()"
                    class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200"><i
                        class="fas fa-times"></i></button>
            </div>

            <div class="flex p-2 gap-2 bg-gray-50 mx-4 mt-2 rounded-xl">
                <button onclick="switchPickerTab('cloud')"
                    class="picker-tab active flex-1 py-2 text-xs font-bold rounded-lg transition text-love-500 bg-white shadow-sm">Kho
                    lưu trữ</button>
                <button onclick="switchPickerTab('upload')"
                    class="picker-tab flex-1 py-2 text-xs font-bold rounded-lg transition text-gray-500 hover:bg-white/50">Tải
                    lên</button>
                <button onclick="switchPickerTab('url')"
                    class="picker-tab flex-1 py-2 text-xs font-bold rounded-lg transition text-gray-500 hover:bg-white/50">Link
                    URL</button>
            </div>

            <div class="p-4 overflow-y-auto hide-scrollbar flex-grow min-h-[300px]">

                <div id="picker-tab-cloud" class="picker-content">
                    <div class="flex gap-2 mb-3 overflow-x-auto pb-2 hide-scrollbar">
                        <button onclick="loadMiniGallery('all')"
                            class="px-3 py-1 rounded-full bg-gray-800 text-white text-[10px] font-bold whitespace-nowrap">Tất
                            cả</button>
                        <button onclick="loadMiniGallery('posts')"
                            class="px-3 py-1 rounded-full bg-gray-100 text-gray-600 text-[10px] font-bold whitespace-nowrap">Nhật
                            ký</button>
                        <button onclick="loadMiniGallery('events')"
                            class="px-3 py-1 rounded-full bg-gray-100 text-gray-600 text-[10px] font-bold whitespace-nowrap">Sự
                            kiện</button>
                        <button onclick="loadMiniGallery('backgrounds')"
                            class="px-3 py-1 rounded-full bg-gray-100 text-gray-600 text-[10px] font-bold whitespace-nowrap">Hình
                            nền</button>
                    </div>
                    <div id="mini-gallery-grid" class="grid grid-cols-3 gap-1">
                        <div class="col-span-3 text-center py-10 text-gray-400 text-xs">Đang tải...</div>
                    </div>
                </div>

                <div id="picker-tab-upload" class="picker-content hidden h-full flex flex-col justify-center">
                    <label
                        class="block w-full text-center bg-gray-50 border-2 border-dashed border-gray-300 rounded-2xl p-10 cursor-pointer hover:bg-love-50 hover:border-love-300 transition group">
                        <div id="picker-upload-ui">
                            <i
                                class="fas fa-cloud-upload-alt text-4xl text-gray-300 group-hover:text-love-500 mb-3 transition"></i>
                            <p class="text-xs text-gray-500 group-hover:text-love-500 font-bold">Chạm để chọn ảnh/video
                            </p>
                        </div>
                        <div id="picker-uploading-ui" class="hidden">
                            <div class="loader mx-auto mb-2"></div>
                            <p class="text-xs text-love-500 font-bold">Đang tải lên...</p>
                        </div>
                        <input type="file" id="picker-file-input" class="hidden" accept="image/*,video/*"
                            onchange="handlePickerUpload(this)">
                    </label>
                </div>

                <div id="picker-tab-url" class="picker-content hidden pt-10">
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Dán liên kết ảnh/video</label>
                    <div class="flex gap-2">
                        <input type="text" id="picker-url-input" placeholder="https://..."
                            class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:border-love-300 outline-none">
                        <button onclick="handlePickerUrl()"
                            class="bg-gray-800 text-white px-4 rounded-xl font-bold text-xs">Xong</button>
                    </div>
                    <p class="text-[10px] text-gray-400 mt-2 italic">* Hỗ trợ link trực tiếp (đuôi .jpg, .png, .mp4...)
                    </p>
                </div>
            </div>
        </div>
    </div>

    <style>
        @keyframes slideUp {
            from {
                transform: translateY(100%);
            }

            to {
                transform: translateY(0);
            }
        }

        @keyframes zoomIn {
            from {
                transform: scale(0.9);
                opacity: 0;
            }

            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .animate-slide-up {
            animation: slideUp 0.3s ease-out;
        }

        .animate-zoom-in {
            animation: zoomIn 0.2s ease-out;
        }
    </style>

    <div id="comment-options-modal" class="fixed inset-0 z-[110] hidden flex items-end justify-center sm:items-center">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="closeCommentOptions()">
        </div>

        <div
            class="bg-white w-full max-w-md rounded-t-[2rem] sm:rounded-[2rem] shadow-2xl relative z-10 p-5 animate-slide-up mx-2 mb-2 sm:mb-0">
            <h3 class="text-center font-bold text-gray-400 text-xs uppercase mb-4 tracking-widest">Tùy chọn bình luận
            </h3>

            <div class="space-y-2">
                <button onclick="triggerEditComment()"
                    class="w-full py-3.5 rounded-2xl bg-gray-50 text-blue-600 font-bold text-sm hover:bg-blue-50 transition flex items-center justify-center gap-2">
                    <i class="fas fa-pen"></i> Chỉnh sửa
                </button>
                <button onclick="triggerDeleteComment()"
                    class="w-full py-3.5 rounded-2xl bg-gray-50 text-red-500 font-bold text-sm hover:bg-red-50 transition flex items-center justify-center gap-2">
                    <i class="fas fa-trash"></i> Xóa bình luận
                </button>
            </div>

            <button onclick="closeCommentOptions()"
                class="w-full mt-4 py-3 rounded-xl bg-white border border-gray-100 text-gray-600 font-bold text-sm shadow-sm">
                Hủy bỏ
            </button>
        </div>
    </div>

    <div id="edit-comment-modal" class="fixed inset-0 z-[120] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" onclick="closeEditCommentModal()"></div>
        <div class="bg-white w-full max-w-sm rounded-3xl p-5 relative z-10 shadow-2xl animate-zoom-in">
            <h3 class="font-bold text-gray-800 mb-3">Sửa nội dung</h3>
            <textarea id="edit-comment-input" rows="3"
                class="w-full bg-gray-50 rounded-xl p-3 text-sm focus:outline-none focus:ring-2 ring-love-300 border border-gray-100"></textarea>
            <div class="flex gap-2 mt-4">
                <button onclick="closeEditCommentModal()"
                    class="flex-1 py-2 rounded-xl bg-gray-100 text-gray-500 font-bold text-xs">Hủy</button>
                <button onclick="saveEditedComment()"
                    class="flex-1 py-2 rounded-xl bg-love-500 text-white font-bold text-xs shadow-lg shadow-love-200">Lưu</button>
            </div>
        </div>
    </div>

    <script src="./main.js"></script>
</body>

</html>